;/* module-key = 'com.googlecode.jira-suite-utilities:common', location = 'com/googlecode/jsu/maps/LocationField.js' */
(function(i){var d=window,j="onJSUGMapsLoad",n=[],g=false,a=false;function k(){var p;while(p=n.shift()){p()}}function e(q){var p=d.google.maps&&d.google.maps.LatLng;if(p){n.push(q);k()}else{if(a){n.push(q)}else{a=true;n.push(q);google.load("maps","3",{other_params:"sensor=false",callback:k})}}}function f(q){if(d.google&&d.google.load){e(q)}else{if(g){n.push(q)}else{g=true;d[j]=function(){e(q)};var p=document.createElement("script");p.src="https://www.google.com/jsapi?callback="+j;p.type="text/javascript";i("body").append(p)}}}function b(p,q){f(function(){new google.maps.Geocoder().geocode({address:p},q)})}function c(p){if(p.hasClass("open")||p.hasClass("notFound")){l(p)}else{m(p)}}function l(p){p.removeClass("open");p.removeClass("notFound")}function o(p){return !isNaN(parseFloat(p))&&isFinite(p)}function h(p){return(!p||0===p.length)}function m(t){var q=t.find("a.location").text(),p="",r=t.find(".jsuMap");var s=q.split("=>");if(s.length==2){q=s[0].trim();p=s[1].trim()}b(q,function(w,u){if(u==google.maps.GeocoderStatus.OK){t.addClass("open");var A=new google.maps.Map(r.get(0),{zoom:8,center:w[0].geometry.location,mapTypeId:google.maps.MapTypeId.ROADMAP});var z=q.split(",");if(z.length==2&&o(z[0])&&o(z[1])){var B=new google.maps.LatLng(z[0],z[1]);new google.maps.Marker({position:B,map:A,title:q})}else{new google.maps.Marker({map:A,position:w[0].geometry.location,title:q})}if(!h(p)){var v=new google.maps.DirectionsRenderer();var y=new google.maps.DirectionsService();v.setMap(A);var x={origin:q,destination:p,travelMode:google.maps.TravelMode.DRIVING};y.route(x,function(D,C){if(C==google.maps.DirectionsStatus.OK){v.setDirections(D)}})}}else{t.addClass("notFound")}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(s,p,r){if(r===JIRA.CONTENT_ADDED_REASON.panelRefreshed||r===JIRA.CONTENT_ADDED_REASON.pageLoad){var q=i(".jsuLocation.ready",p);q.removeClass("ready");q.each(function(t,u){u=i(u);u.find("> a").click(function(v){v.preventDefault();c(u)})})}});JIRA.bind(JIRA.Events.INLINE_EDIT_STARTED,function(){JIRA.Issues.InlineEdit.BlurTriggerMapping.custom.locationselect=JIRA.Issues.InlineEdit.BlurTriggers.Default;JIRA.Issues.InlineEdit.BlurTriggerMapping.custom.locationtextfield=JIRA.Issues.InlineEdit.BlurTriggers.Default;JIRA.Issues.InlineEdit.BlurTriggerMapping.custom.directionsfield=JIRA.Issues.InlineEdit.BlurTriggers.Default})})(AJS.$);;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-public', location = 'js/applinks.public.js' */
var ApplinksUtils=ApplinksUtils||(function(f){var c={},b={};var p="com_atlassian_applinks_authentication";function o(r){var q=f('<span class="aui-icon icon-close"></span>').click(function(){r.trigger("messageClose",[this]).remove()});r.append(q)}function g(){if(window===parent.window){return null}var r=null,q=window;f("iframe",parent.document.body).each(function(s){if(this.contentWindow.window===q){r=this}});return r}function d(r,w,v,q,s){if(w in c){var t=c[w];if(v){t.authAdminUri=q;delete c[w]}j(t,v)}if(!s&&parent&&(parent!==window)){var u=window;f("iframe",parent.document.body).each(function(x,z){var y=z.contentWindow;if(y!==u){if(y.AJS&&y.AJS.$){y.AJS.$(y.document).trigger("applinks.auth.completion",[w,v,q,true])}}})}}function j(q,t){var s=f(document);if(t){var r=function(u){if(u.isDefaultPrevented()){m(q)}else{h(q);document.location.reload(true)}};s.bind("applinks.auth.approved",r);s.trigger("applinks.auth.approved",q);s.unbind("applinks.auth.approved",r)}else{s.trigger("applinks.auth.denied",q)}}function k(r,q){var s=r.find("a.applink-authenticate");if(r.hasClass("aui-message")){o(r)}s.click(function(t){window.open(q.authUri,p);t.preventDefault()});c[q.id]=q;return r}function n(){f(".applinks-auth-request").each(function(t){var s=f(this),v=s.find(".applinkId").val(),q=s.find(".appName").val(),r=s.find(".appUri").val(),u=s.find(".authUri").val();if(v&&u){k(s,{id:v,appName:q,appUri:r,authUri:u})}})}function i(q){var r=f('<div class="aui-message warning closeable applinks-auth-request"><p><span class="aui-icon icon-applinks-key"></span></p></div>');r.append(AJS.format("Additional information may be available, please \u003ca class=\"applink-authenticate\" href=\"{0}\"\u003eauthenticate\u003c/a\u003e with \u003ca href=\"{1}\"\u003e{2}\u003c/a\u003e.",AJS.escapeHtml(q.authUri),AJS.escapeHtml(q.appUri),AJS.escapeHtml(q.appName)));k(r,q);return r}function e(u,r){var q=f('<span class="applinks-auth-request"></span>'),s=f('<span class="applinks-request-description"></span>'),t=AJS.format("\u003ca class=\"applink-authenticate\" href=\"{0}\"\u003eAuthenticate\u003c/a\u003e to see additional information.",AJS.escapeHtml(r.authUri));if(u){s.append(u);s.append(" - ")}s.append(t);q.append(s);k(q,r);return q}function h(q){var r=g();if((!r)||(!r.id)){return}if(!parent.ApplinksUtils.pendingConfirmations){parent.ApplinksUtils.pendingConfirmations={}}if(!(r.id in parent.ApplinksUtils.pendingConfirmations)){parent.ApplinksUtils.pendingConfirmations[r.id]=[]}parent.ApplinksUtils.pendingConfirmations[r.id].push(q);return}function l(){if(parent&&parent.ApplinksUtils&&parent.ApplinksUtils.pendingConfirmations){var r=g();if(r){if(r.id in parent.ApplinksUtils.pendingConfirmations){var s=parent.ApplinksUtils.pendingConfirmations[r.id];delete parent.ApplinksUtils.pendingConfirmations[r.id];for(var q=0,t=s.length;q<t;q++){m(s[q])}}}}}function m(s){var t=f(document),r=f('<div class="aui-message success closeable applinks-auth-confirmation"><p><span class="aui-icon icon-applinks-key-success"></span></p></div>'),q=t.find("div.applinks-auth-confirmation-container");if(!q.length){q=t.find("body")}r.append(AJS.format("This application is now using \u003ca href=\"{0}\"\u003e{1}\u003c/a\u003e\'\'s credentials. Revoke access at any time by going to \u003ca href=\"{2}\"\u003eOAuth access tokens\u003c/a\u003e.",AJS.escapeHtml(s.appUri),AJS.escapeHtml(s.appName),AJS.escapeHtml(s.authAdminUri)));o(r);q.prepend(r);setTimeout(function(){r.fadeOut(1000,function(){f(this).remove()})},5000)}function a(){if(parent&&!(parent===window)){if(!parent.ApplinksUtils){parent.ApplinksUtils={}}}f(document).bind("applinks.auth.completion",d);n();l()}f(document).ready(a);return{createAuthRequestBanner:i,createAuthRequestInline:e}})(AJS.$);;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/fecru-compatibility.js' */
if(jQuery!=undefined&&AJS!=undefined){jQuery=AJS.$};;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/rest-service.js' */
AppLinks=AJS.$.extend(window.AppLinks||{},{Event:{NAMESPACE:"applinks",}});AppLinks.Event=AJS.$.extend(window.AppLinks.Event,{PREREADY:AppLinks.Event.NAMESPACE+".preready",READY:AppLinks.Event.NAMESPACE+".ready"});if(AJS.AppLinksInitialisationBinder){AppLinks.initialisationBinder=AJS.AppLinksInitialisationBinder}else{AppLinks.initialisationBinder=function(a){AJS.toInit(a)}}AppLinks.initialisationBinder(function(){var b=AJS.$;AppLinks=b.extend(window.AppLinks||{},{failure:function(e){if(e.status==401){window.location.reload()}else{var c=AppLinks.parseError(e);var d=b(".page-error");if(d.length>0){d.html(c).fadeIn("slow")}else{alert("REST request failed: "+c)}}},jsonRequest:function(d,e,f,g,c){if(f){f=JSON.stringify(f)}b(".page-error").fadeOut("fast");if(!c){c=AppLinks.failure}return jQuery.ajax({url:d,type:e,data:f,dataType:"json",contentType:"application/json; charset=utf-8",cache:false,success:g,error:c})},xmlRequest:function(d,e,f,g,c){if(f){f=JSON.stringify(f)}b(".page-error").fadeOut("fast");if(!c){c=AppLinks.failure}return jQuery.ajax({url:d,type:e,data:f,dataType:"xml",contentType:"application/xml; charset=utf-8",cache:false,success:g,error:c})},parseError:function(f){var c;try{c=JSON.parse(f.responseText)}catch(d){if(f.statusText){return c=f.statusText}else{return f}}if(c.message){if(b.isArray(c.message)){return c.message.join(" ")}return c.message}else{return f.statusText}},put:function(d,e,f,c){return AppLinks.jsonRequest(d,"PUT",e,f,c)},post:function(d,e,f,c){return AppLinks.jsonRequest(d,"POST",e,f,c)},update:function(d,e,c){AppLinks.put(AppLinks.self_link(d),d,e,c)},get:function(d,e,c){return AppLinks.jsonRequest(d,"GET",null,e,c)},getXml:function(d,e,c){return AppLinks.xmlRequest(d,"GET",null,e,c)},self_link:function(e){for(var c=0,f=e.link.length;c<f;c++){var d=e.link[c];if(d.rel=="self"){return d.href}}throw"No self-link found"},del:function(f,e,d){var c;if(typeof(f)=="string"){c=f}else{c=AppLinks.self_link(f)}return AppLinks.jsonRequest(c,"DELETE",null,e,d)},SPI:b.extend({},{API_VERSION:"1.0",REST_RESOURCE_URL:AJS.contextPath()+"/rest/applinks/",BASE_URL:AJS.contextPath()+"/rest/applinks/1.0",setApiVersion:function(c){AppLinks.SPI.API_VERSION=c;AppLinks.SPI.setBaseUrl(AppLinks.SPI.REST_RESOURCE_URL+AppLinks.SPI.API_VERSION)},setBaseUrl:function(c){AppLinks.SPI.BASE_URL=c},getRemoteRestBaseUrl:function(c){return c+"/rest/applinks/"+AppLinks.SPI.API_VERSION},getRemotePluginServletBaseUrl:function(c){return c+"/plugins/servlet"},getAllLinks:function(e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink";return AppLinks.get(c,e,d)},getAllLinksWithAuthInfo:function(e,d){var c=AppLinks.SPI.BASE_URL+"/listApplicationlinks";return AppLinks.get(c,e,d)},getLinksOfType:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/type/"+e;return AppLinks.get(c,f,d)},tryToFetchManifest:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/manifest.json?url="+encodeURIComponent(e);return AppLinks.get(c,f,d)},getManifestFor:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/manifest/"+f+".json";return AppLinks.get(c,e,d)},getLocalManifest:function(e,d){var c=AppLinks.SPI.BASE_URL+"/manifest.json";return AppLinks.get(c,e,d)},getRemoteManifest:function(e,f,d){var c=AppLinks.SPI.getRemoteRestBaseUrl(e)+"/manifest.json";return AppLinks.get(c,f,d)},getRemoteOAuthConsumerInfo:function(e,f,d){var c=AppLinks.SPI.getRemotePluginServletBaseUrl(e)+"/oauth/consumer-info";return AppLinks.getXml(c,f,d)},createStaticUrlAppLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createStaticUrlAppLink?typeId="+f;return AppLinks.post(c,null,e,d)},createLink:function(j,h,l,d,i,k,f,m,e){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var g={applicationLink:j,username:h,password:l,createTwoWayLink:d,customRpcURL:i,rpcUrl:k,configFormValues:f};return AppLinks.post(c,g,m,e)},createLinkWithOrphanedTrust:function(j,h,m,d,i,k,f,l,n,e){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var g={applicationLink:j,username:h,password:m,createTwoWayLink:d,customRpcURL:i,rpcUrl:k,configFormValues:f,orphanedTrust:l};return AppLinks.post(c,g,n,e)},verifyTwoWayLinkDetails:function(c,i,j,f,h,e){var d=AppLinks.SPI.BASE_URL+"/applicationlinkForm/details";var g={username:j,password:f,remoteUrl:c,rpcUrl:i};return AppLinks.post(d,g,h,e)},getApplicationLinkInfo:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkInfo/id/"+e;return AppLinks.get(c,f,d)},deleteLink:function(g,c,f,e){var d=AppLinks.SPI.BASE_URL+"/applicationlink/"+g.id;if(c){d+="?reciprocate=true"}return AppLinks.del(d,f,e)},makePrimary:function(e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/primary/"+e.id;return AppLinks.post(c,null,d)},relocate:function(h,f,c,g,e){var d=AppLinks.SPI.BASE_URL+"/relocateApplicationlink/"+h.id+"?newUrl="+encodeURIComponent(f)+"&nowarning="+(c?"true":"false");return AppLinks.post(d,null,g,e)},legacyUpgrade:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/upgrade/legacy/"+f.id;return AppLinks.post(c,null,e,d)},ualUpgrade:function(g,c,f,e){var d=AppLinks.SPI.BASE_URL+"/upgrade/ual/"+g.id;return AppLinks.post(d,c,f,e)},getEntityTypesForApplicationType:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/type/entity/"+f;return AppLinks.get(c,e,d)},getLocalEntitiesWithLinksToApplication:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entitylink/localEntitiesWithLinksTo/"+c+".json";return AppLinks.get(d,f,e)},getEntityLinksForApplication:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entities/"+c+".json";AppLinks.get(d,f,e)},getEntityLinksForApplicationUsingAnonymousAccess:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entities/anonymous/"+c+".json";return AppLinks.get(d,f,e)},createNonUalEntityLink:function(l,g,d,f,j,e,k,i){var c=AppLinks.SPI.BASE_URL+"/entitylink/"+l+"/"+g+"?reciprocate=false";var h={applicationId:d,typeId:f,key:j,name:e,isPrimary:false};return AppLinks.put(c,h,k,i)},createEntityLink:function(h,g,d,c,i,f){var e=AppLinks.SPI.BASE_URL+"/entitylink/"+h+"/"+g+"?reciprocate=";e+=(c?"true":"false");return AppLinks.put(e,d,i,f)},getConfiguredEntityLinks:function(f,e,g,d){var c=AppLinks.SPI.BASE_URL+"/entitylink/primaryLinks/"+f+"/"+e+".json";return AppLinks.get(c,g,d)},deleteEntityLink:function(h,g,d,c,i,f){var e=AppLinks.SPI.BASE_URL+"/entitylink/"+h+"/"+g+"?typeId="+d.typeId+"&key="+d.key+"&applicationId="+d.applicationId+"&reciprocate="+c;return AppLinks.del(e,i,f)},makePrimaryEntityLink:function(g,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/entitylink/primary/"+g+"/"+f+"?typeId="+c.typeId+"&key="+c.key+"&applicationId="+c.applicationId;return AppLinks.post(d,null,h,e)},canDeleteAppLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/permission/reciprocate-application-delete/"+f;return AppLinks.get(c,e,d)},canDeleteEntityLink:function(g,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-delete/"+c.applicationId+"/"+g+"/"+f+"/"+c.typeId+"/"+c.key;return AppLinks.get(d,h,e)},canCreateReciprocateEntityLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-create/"+f;return AppLinks.get(c,e,d)},processPermissionCode:function(d){var c={noPermission:function(){},missing:function(){},credentialsRequired:function(e){},authenticationFailed:function(e){},noAuthentication:function(e){},noAuthenticationConfigured:function(){},noConnection:function(){},allowed:function(){},unrecognisedCode:function(e){},updateView:function(g,f,e){}};if(!d){d={}}d=b.extend(c,d);return function(f){var e=f.code;if(e=="NO_PERMISSION"){d.noPermission()}else{if(e=="MISSING"){d.missing()}else{if(e=="CREDENTIALS_REQUIRED"){d.credentialsRequired(f.url)}else{if(e=="AUTHENTICATION_FAILED"){d.authenticationFailed(f.url)}else{if(e=="NO_AUTHENTICATION"){d.noAuthentication(f.url)}else{if(e=="NO_AUTHENTICATION_CONFIGURED"){d.noAuthenticationConfigured()}else{if(e=="NO_CONNECTION"){d.noConnection()}else{if(e=="ALLOWED"){d.allowed()}else{d.unrecognisedCode(f.code)}}}}}}}}}},addAuthenticationTrigger:function(e,c,d){if(!d){d={}}if(typeof d.onSuccess=="undefined"){d.onSuccess=function(){location.reload()}}if(typeof d.onFailure=="undefined"){d.onFailure=function(){return true}}b(e).unbind("click");b(e).click(function(){if(d.before){d.before()}AppLinks.authenticateRemoteCredentials(c,d.onSuccess,d.onFailure)})},deleteOrphanedTrust:function(g,e,f,d){var c=AppLinks.SPI.BASE_URL+"/orphaned-trust/"+e+"/"+g;return AppLinks.del(c,f,d)},getOrphanedTrust:function(e,d){var c=AppLinks.SPI.BASE_URL+"/orphaned-trust/";return AppLinks.get(c,e,d)},showCreateEntityLinkSuggestion:function(){return true},getApplicationLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+f;return AppLinks.get(c,e,d)},createApplicationLink:function(f,d,i,j,c,k,g){var e=AppLinks.SPI.BASE_URL+"/applicationlink";var h={id:f,name:d,rpcUrl:i,displayUrl:j,typeId:c};return AppLinks.put(e,h,k,g)},createConsumer:function(e,n,d,m,i,l,g,p,h,k,o,f){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+e+"/authentication/consumer";var j={key:n,name:d,description:m,sharedSecret:i,publicKey:l,outgoing:k,twoLOAllowed:g,executingTwoLOUser:p,twoLOImpersonationAllowed:h};return AppLinks.put(c,j,o,f)},createConsumerAutoConfigure:function(j,i,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/applicationlink/"+j+"/authentication/consumer?autoConfigure=true";var g={twoLOAllowed:i,executingTwoLOUser:f,twoLOImpersonationAllowed:c};return AppLinks.put(d,g,h,e)},registerProvider:function(i,h,e,g,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+i+"/authentication/provider";var f={config:e,provider:h};return AppLinks.put(c,f,g,d)}},(window.AppLinks&&window.AppLinks.SPI)||{})});var a="applinks";AppLinks.UI={showInfoBox:function(c){b(".aui-message.success").remove();AppLinks.UI.createMessage("success",c,"page-info")},hideInfoBox:function(){b(".aui-message.success").remove()},showErrorBox:function(c){AppLinks.UI.createMessage("error",c,"page-error")},hideErrorBox:function(){b(".aui-message.error").remove()},showWarningBox:function(d){if(b.isArray(d)&&d.length>0){var c=b("<ul></ul>");b(d).each(function(f){c.append(b("<li/>",{text:d[f]}))});var e=b('<div class="page-warning"></div>').append(c);AppLinks.UI.createMessage("warning",e.html(),"page-warning")}else{AppLinks.UI.createMessage("warning",d,"page-warning")}},hideWarningBox:function(){b(".aui-message.warning").remove()},shortenString:function(d,c){if(d.length>c){d=d.substring(0,c)+"..."}return d},createMessage:function(d,e,c){var f=b('<div class="'+c+'">');f.html(e);AJS.messages[d](".applinks-message-bar",{title:"",body:f.wrap("<div></div>").parent().html(),closeable:true})},displayValidationErrorMessages:function(c,f,e){if(b.isArray(e)){b(e).each(function(j,h){var k=b('<div class="error applinks-error">');k.text(h);b(f).find("."+c).append(k)})}else{if(typeof e!="undefined"){var g=b('<div class="error applinks-error">');g.text(e.toString());b(f).find("."+c).append(g)}}},displayValidationError:function(c,d,e){return function(j){if(j.status==401){window.location.reload();return}b(".applinks-error").remove();b(".loading").remove();var h=j.responseText;var i=b.parseJSON(h);var g=i.message;if(typeof i.fields=="undefined"){AppLinks.UI.displayValidationErrorMessages(c,d,g)}else{var f=i.fields;b(f).each(function(k){var l=b('<div class="error applinks-error" id="'+f[k]+'-error">');l.text(g[k]);if(b(d).find("."+f[k]).length>0){l.insertAfter(b(d).find("."+f[k]))}else{l.insertAfter(b(d).find("."+c).append(l))}})}b(d).find("."+c).addClass("fully-populated-errors");if(e){e()}}},addProtocolToURL:function(c){var f=b.trim(c);var e=f.toLowerCase();var d=false;if(e.length>=7){if(e.substring(0,7).indexOf("http")!=-1){d=true}}if(!d){f="http://"+f}return f},prettyJoin:function(d,g,f){if(!f){f=AppLinks.I18n.getText("applinks.and")}var c=d.length;var e="";b.each(d,function(h,i){if(h==(c-1)&&c>1){e+=" "+f+"  "+g(i)}else{e+=g(i);if(h+2<c){e+=", "}}});return e},showLoadingIcon:function(c){b('<span class="loading">&nbsp;</span>').insertAfter(c)},hideLoadingIcon:function(c){b(c).next(".loading").remove()},findUrl:function(f){var e=undefined;var g=f.toLowerCase();var d=g.indexOf("http:");if(d==-1){d=g.indexOf("https:")}if(d>-1){var c=g.indexOf(" ",d);if(c==-1){c=g.length}e=f.substring(d,c)}return e},findApplicationType:function(c){c=c.toLowerCase();if(c.indexOf("jira")!=-1){return"jira"}else{if(c.indexOf("fisheye")!=-1){return"fecru"}else{if(c.indexOf("confluence")!=-1){return"confluence"}else{if(c.indexOf("refapp")!=-1){return"refapp"}else{return undefined}}}}},escapeSelector:function(c){return c.replace(/([#;&,\.\+\*\~':"\!\^$\[\]\(\)=>\|])/g,"\\$1")},sanitiseHTML:function(c){var d={"<":"&lt;",'"':"&quot;","&":"&amp;"};return c.replace(/[<"&]/g,function(e){return d[e]})},refreshOrphanedTrust:function(){var c=function(d){b("tr.orphaned-trust-row").each(function(){var j=b(this);var k=j.attr("data-id");var g=j.attr("data-type");var f=false;for(var e=0;e<d.orphanedTrust.length;e++){var h=d.orphanedTrust[e];if(k==h.id&&g==h.type){f=true;break}}if(!f){j.remove();if(d.orphanedTrust.length==0){b(".orphaned-trust-warning").hide()}}})};AppLinks.SPI.getOrphanedTrust(c)},removeCssClass:function(c,d){b(c).removeClass(function(f,h){var g=h.split(" ");var e="";b.each(g,function(i,j){if(j.indexOf(d)!=-1){e=j}});return e})}};(function(){var c=b({});b.each(["bind","unbind","trigger"],function(d,e){AppLinks.UI[e]=function(){return c[e].apply(c,arguments)}})})();AppLinks.I18n={interpolate:function(d,c){if(c){if(!b.isArray(c)){c=[new String(c)]}c.unshift(d);d=AJS.format.apply(AJS,c)}return d},getTextWithPrefix:function(c,d){return AppLinks.I18n.interpolate(appLinksI18n.entries[a+"."+c],d)},getText:function(c,d){return AppLinks.I18n.interpolate(AppLinks.I18n.resolveValue(c),d)},getApplicationTypeName:function(c){return appLinksI18n.entries["applinks.application.type."+c]},getEntityTypeName:function(c){return appLinksI18n.entries["applinks.entity.type."+c]},getPluralizedEntityTypeName:function(c){return appLinksI18n.entries["applinks.entity.type.plural."+c]},getAuthenticationTypeName:function(c){return appLinksI18n.entries["applinks.auth.provider."+c]},resolveValue:function(c){var d=appLinksI18n.entries[c];return typeof d=="undefined"?c:d}};AppLinks.Docs={createDocLink:function(d,e,c){if(!c){c=""}else{c=" "+c}return b("<a/>",{"class":"ual-help-link"+c,href:AppLinks.Docs.getDocHref(d,e),target:"_blank",text:AppLinks.I18n.getText("applinks.help"),title:AppLinks.I18n.getText("applinks.help")})},getDocHref:function(d,e){var c=AppLinks.Docs.resolveValue("applinks.docs.root")+"/"+AppLinks.Docs.resolveValue(d);if(e){c+="#"+AppLinks.Docs.resolveValue(e)}return c},resolveValue:function(c){var d=applinksDocs.entries[c];return typeof d=="undefined"?c:d}};b(document).trigger(AppLinks.Event.PREREADY);b(document).trigger(AppLinks.Event.READY)});;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/json2.js' */
if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/autocomplete.js' */
AJS.$(document).bind(AppLinks.Event.READY,function(){AppLinks.autoComplete={cacheManager:function(c){var a={},b=[],c=c||30;return{get:function(d){return a[d]},put:function(d,e){a[d]=e;b.push(d);if(b.length>c){delete a[b.shift()]}},clear:function(){a={};b=[]}}}};(function(d){var c=function(f){AJS.log("InputDrivenDropDown: truncating text");var h=f.$.closest(".aui-dropdown").width(),g=20;d("a span:not(.icon)",f.$).each(function(){var j=d(this),i=AJS("var","&#8230;"),l=i.width(),k=false;j.wrapInner(d("<em>"));d("em",j).each(function(){var m=d(this);m.show();if(this.offsetLeft+this.offsetWidth>h){var t=this.childNodes,s=false;for(var o=t.length-1;o>=0;o--){var p=t[o],n=1,r=(p.nodeType==3)?"nodeValue":"innerHTML",q=p[r];do{if(n<=q.length){p[r]=q.substr(0,q.length-n++)}else{break}}while(this.offsetLeft+this.offsetWidth+l>h-g);if(n<=q.length){s=true;break}}if(s){k=true}else{m.hide()}}});if(k){j.append(i);this.elpss=i}})};var b=function(f,l){if(!l.length||!l[0]){return}AJS.log("InputDrivenDropDown: highlighting tokens");for(var h=0,j=l.length;h<j;h++){var g=l[h];l[h]=g?g.replace(/[\.\*\+\?\|\(\)\[\]{}\\]/g,"\\$"):""}var k=new RegExp("("+l.join("|")+")","gi");d("li a:not(.dropdown-prevent-highlight) span",f.$).each(function(){var m=d(this),i=m.html().replace(k,"<strong>$1</strong>");m.html(i)})};var e=function(j,g){var i=j.options,h=j.dd;if(h){h.hide();h.$.remove()}i.ajsDropDownOptions=i.ajsDropDownOptions||{};if(i.ajsDropDownOptions&&!i.ajsDropDownOptions.alignment){i.ajsDropDownOptions.alignment="left"}i.ajsDropDownOptions.selectionHandler=i.ajsDropDownOptions.selectionHandler||function(l,k){if(l.type!="click"){l.preventDefault();d("a",k).click();document.location=d("a",k).attr("href")}};i.ajsDropDownOptions.displayHandler=function(k){return AJS.escapeHtml(k.name)};var f=j.dd=new AJS.dropDown(g.matrix,i.ajsDropDownOptions)[0];if(i.ajsDropDownOptions&&i.ajsDropDownOptions.className){f.$.addClass(i.ajsDropDownOptions.className)}if(i.dropdownPlacement){i.dropdownPlacement(f.$)}else{AJS.log("No dropdownPlacement function specified. Appending dropdown to the body.");d("body").append(f.$)}b(f,g.queryTokens||[g.query]);c(f);if(i.dropdownPostprocess){i.dropdownPostprocess(f.$)}f.show(j._effect);if(typeof i.onShow=="function"){i.onShow.call(f,f.$)}return f};function a(g,f){this._effect="appear";this._timer=null;this.id=g;this.options=f;this.inactive=false;this.busy=false;this.cacheManager=AppLinks.autoComplete.cacheManager()}a.prototype.clearCache=function(){this.cacheManager.clear()};a.prototype.change=function(h,g){var f=this;if(h!=f._value||g){f._value=h;f.busy=false;clearTimeout(f._timer);if(g||(/\S{0,}/).test(h)){var i=f.cacheManager.get(h);if(i){e(f,i)}else{f.busy=true;f._timer=setTimeout(function(){f.options.getDataAndRunCallback.call(f,h,f.show)},200)}}else{f.dd&&f.dd.hide()}}};a.prototype.dropDownLength=function(){return this.dd.links?this.dd.links.length:0};a.prototype.dropDownItem=function(f){return this.dropDownLength()>f?this.dd.links[f]:null};a.prototype.hide=function(){this.dd&&this.dd.hide()};a.prototype.remove=function(){var f=this.dd;if(f){this.hide();f.$.remove()}this.inactive=true;this.options.onDeath&&this.options.onDeath()};a.prototype.show=function(g,i,h){if(this.inactive){AJS.log("Quick search abandoned before server response received, ignoring. "+this);return}var f={matrix:g,query:i,queryTokens:h};this.cacheManager.put(i,f);e(this,f);this.busy=false};AppLinks.inputDrivenDropdown=function(f){return new a("inputdriven-dropdown",f)}})(jQuery)});;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/wizard.js' */
AJS.$(document).bind(AppLinks.Event.PREREADY,function(){(function(d){d.fn.wizard=function(v){var u={width:500,height:350,onshow:function(w,x){return true},aftershow:function(){return true},oncancel:function(){return true},onsubmit:function(){return true},aftersubmit:function(){return true},onnext:function(){return true},onprevious:function(){return true},cancelLabel:AppLinks.I18n.getText("applinks.cancel"),submitLabel:AppLinks.I18n.getText("applinks.create"),nextLabel:AppLinks.I18n.getText("applinks.next"),previousLabel:AppLinks.I18n.getText("applinks.previous"),id:""};if(!v){v={}}v=d.extend(u,v);var t=this;this.each(function(){var D=d(this);var w=new AJS.Dialog(v.width,v.height,v.id);var L=q(w,v.onshow,v.aftershow);var K=c(w,v.oncancel);var z=h(w,v.onsubmit,v.aftersubmit);var M=a(w,v.onprevious);var I=m(w,v.onnext);var G=k(w);var B=o(w);var C=g(w);var H=l(w);var J=s(w);var E=n(w);if(v.showButtonId){d("#"+v.showButtonId).click(L)}var y=f(D);for(var A=0;A<y.length;A++){var F=y[A];j(w,F);if(F.className){w.addHeader(F.title,F.className+"-header")}else{w.addHeader(F.title)}if(A!=0&&d(F.div).attr("previous")!="false"){w.addButton(v.previousLabel,M,"applinks-previous-button")}if(A<y.length-1&&d(F.div).attr("submit")!="true"&&d(F.div).attr("next")!="false"){w.addButton(v.nextLabel,I,"applinks-next-button")}if(d(F.div).attr("submit")=="true"){w.addButton(v.submitLabel,z,"wizard-submit")}if(!w.getPage(A).buttonpanel){w.addButton("",null);d(w.getPage(A).buttonpanel).empty();var x=d('<a class="button-panel-button applinks-cancel-link">'+v.cancelLabel+"</a>");w.getPage(A).buttonpanel.append(x);x.click(K)}else{var x=d('<a class="button-panel-link button-panel-cancel-link applinks-cancel-link">'+v.cancelLabel+"</a>");d(w.getPage(A).buttonpanel).append(x);x.click(K)}if(A<y.length-1){w.addPage()}}t={dialog:w,nextPage:I,prevPage:M,submit:z,cancel:K,show:L,disableNextBtn:G,enableNextBtn:B,disableSubmitBtn:C,enableSubmitBtn:H,disablePreviousBtn:J,enablePreviousBtn:E};w.gotoPage(0);w.gotoPanel(0)});return t};function s(t){return function(){b(r(t,"applinks-previous-button"))}}function n(t){return function(){i(r(t,"applinks-previous-button"))}}function k(t){return function(){b(r(t,"applinks-next-button"))}}function o(t){return function(){i(r(t,"applinks-next-button"))}}function g(t){return function(v){var u=r(t,"wizard-submit");b(u);if(typeof(v)=="undefined"||v){d('<span class="loading">&nbsp;</span>').insertBefore(u)}else{u.parent().find(".loading").remove()}}}function l(t){return function(){var u=r(t,"wizard-submit");i(u);u.parent().find(".loading").remove()}}function r(u,t){return d(u.getPage(u.curpage).buttonpanel).find("."+t)}function p(t){d(t.popup.element).find("form").each(function(){this.reset()})}function i(t){t.attr("disabled",false)}function b(t){t.attr("disabled",true)}function q(t,u,v){return function(w){if(u(t,w)!==false){t.gotoPage(0);t.gotoPanel(0);d(document).unbind("keydown.ual.dialog");d(document).bind("keydown.ual.dialog",e(t));t.show();v()}}}function c(t,u){return function(){if(u(t)!==false){t.hide();p(t)}}}function a(t,u){return function(){if(u(t)!==false){t.prevPage()}}}function m(t,u){return function(){if(u(t)!==false){t.nextPage()}}}function e(t){return function(u){if(u.keyCode===27){p(t);d(document).unbind("keydown.ual.dialog")}}}function h(u,v,t){return function(){if(v(u)!==false){t(u);p(u)}}}function j(v,w){var u=d("> div[panel]",w.div);if(u.length>0){u.each(function(y,z){var x=v.addPanel(z.title,null,z.className,"menu-"+z.id);x.getCurrentPanel().body.append(u[y])})}else{var t=v.addPanel(w.title);t.getCurrentPanel().body.append(w.div)}}function f(v){var u=d(" > div",v);var t=[];u.each(function(x){var w=d(this);t[x]={title:w.attr("title")||null,className:w.attr("class"),div:w}});return t}})(jQuery)});;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/applinkwizard.js' */
(function(a){AppLinks.Wizard={getWizard:function(){return a("#create-application-link-container").data("wizard")},initAuthenticationUI:function(d){var h=a(d);var f=h.find(".create-reciprocal-link");var c=h.find(".ual-arrow");var l=h.find(".two-way-link-details");var j=h.find(".reciprocal-link-description");var b=h.find(".no-reciprocal-link-description");f.click(function(){if(f.is(":checked")){c.removeClass("no-background");l.show();j.show();b.hide()}else{c.addClass("no-background");l.hide();j.hide();b.show()}});var i=h.find(".same-user-radio-btn");var k=h.find(".different-user-radio-btn");var e=h.find(".different-userbase-image");var g=h.find(".same-userbase-image");i.click(function(){e.addClass("different-userbase-image-grey");g.removeClass("same-userbase-image-grey")});k.click(function(){g.addClass("same-userbase-image-grey");e.removeClass("different-userbase-image-grey")})},initNonUALUI:function(e){var c=a(e);var b=c.find(".application-types");for(var d=0;d<nonAppLinksApplicationTypes.length;d++){a('<option value="'+nonAppLinksApplicationTypes[d].typeId+'">'+nonAppLinksApplicationTypes[d].label+"</option>").appendTo(b)}},fetchManifest:function(e,h,d,b){var i=h.find("#application-url");if(i.val()==""){var c=h.find("#application-types");if(c.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(i);return false}var g=function(j){e.enableSubmitBtn();e.enablePreviousBtn();e.cancel();AppLinks.UI.listApplicationLinks(j.applicationLink.id,"new",j)};AppLinks.SPI.createStaticUrlAppLink(c.val(),g,null);return true}var f=AppLinks.UI.addProtocolToURL(i.val());AppLinks.UI.showLoadingIcon(i);var g=function(l){var k=l;e.enableNextBtn();h.find(".loading").remove();h.find(".reciprocal-rpc-url").val(a("#baseUrl").val());if(typeof l.typeId!="undefined"){AppLinks.Wizard.handleUALManifest(k,h);e.dialog.gotoPage(2);h.find(".reciprocal-link-username").focus();if(d){d(k)}}else{if(l.code=="applinks.warning.redirected.host"&&!i.data("hasWarnedAboutRedirection")){AppLinks.UI.displayValidationErrorMessages("manifest-validation-errors",h,l.warning);i.data("hasWarnedAboutRedirection","true");var m=function(){a(i).removeData("hasWarnedAboutRedirection");a(i).unbind("change",m)};i.bind("change",m)}else{if(l.code=="applinks.warning.unknown.host"&&!i.data("forceWhenHostIsOffline")){AppLinks.UI.displayValidationErrorMessages("manifest-validation-errors",h,l.warning);i.data("forceWhenHostIsOffline","true");var j=function(){a(i).removeData("forceWhenHostIsOffline");a(i).unbind("change",j)};i.bind("change",j)}else{if(k.code=="applinks.warning.unknown.host"||k.code=="applinks.warning.redirected.host"){delete k.warning;delete k.code}AppLinks.Wizard.handleNonUALManifest(k,f,h);e.dialog.gotoPage(1);h.find(".application-name").focus();if(b){b(k)}}}}};e.disableNextBtn();AppLinks.SPI.tryToFetchManifest(f,g,AppLinks.UI.displayValidationError("manifest-validation-errors",h,function(){e.enableNextBtn()}));return f},handleUALManifest:function(f,e){var c=a(e);c.find(".remote-app-image").removeClass(function(j,l){var k=l.split(" ");var i="";a.each(k,function(m,n){if(n.indexOf("application-type-image-")!=-1){i=n}});return i});c.find(".remote-app-image").addClass("application-type-image-"+f.typeId);c.find(".link-to-app-type").html(AppLinks.I18n.getText("applinks.create.title.link.to",AppLinks.I18n.getApplicationTypeName(f.typeId)));c.find(".remote-app-name").text(AppLinks.UI.shortenString(f.name,20));c.find(".create-reciprocal-link").attr("checked",true);c.find("#reciprocal-link-back-to-server").html(AppLinks.I18n.getText("applinks.create.link.back.to.server",AJS.escapeHtml(f.name)));var d=["administrator",AJS.escapeHtml(f.name),'<a target="_blank" href="'+AppLinks.Docs.getDocHref("applinks.docs.adding.application.link")+'">',"</a>"];var h=f.applinksVersion.split(".");var b=parseInt(h[0]);var g=parseInt(h[1]);if((f.typeId=="jira"||f.typeId=="confluence")&&(b==3&&g<10)){d[0]="system administrator"}c.find(".reciprocal-link-description").html(AppLinks.I18n.getText("applinks.create.two.way.link",d));c.find(".no-reciprocal-link-description").hide();c.find(".no-reciprocal-link-description").html(AppLinks.I18n.getText("applinks.create.two.way.no.link",AJS.escapeHtml(f.name)));c.find(".reciprocal-link-username").val("");c.find(".reciprocal-link-password").val("");c.find(".ual-arrow").removeClass("no-background");c.find(".two-way-link-details").show();c.find(".reciprocal-link-description").show();c.find(".no-reciprocal-link-description").hide()},handleNonUALManifest:function(d,e,c){var b=a(c);b.find(".application-name").val("");b.find(".application-types option:first-child").attr("selected","selected");b.find(".non-ual-application-url").text(e);if(d.warning){b.find(".create-non-ual-warning").show();b.find(".create-non-ual-warning").html(d.warning)}else{b.find(".create-non-ual-warning").hide()}},checkReciprocalLinkFormThreeStepMode:function(c,d,g,j,f){var h=a(c);if(h.find(".create-reciprocal-link").is(":checked")){var k=a.trim(h.find(".reciprocal-rpc-url").val());if(k==""){a("<div class='error applinks-error'>"+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(h.find(".reciprocal-rpc-url"));if(f){f()}return}var e=h.find(".reciprocal-link-username");var b=h.find(".reciprocal-link-password");if(e.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.username.empty")+"</div>").insertAfter(e);if(f){f()}return false}var i=function(l){h.find(".same-user-description").find("input").attr("checked",true);h.find(".trust-radio-btn").attr("checked",true);h.find(".same-user-radio-btn").click();g(l)};k=AppLinks.UI.addProtocolToURL(k);AppLinks.SPI.verifyTwoWayLinkDetails(j,k,e.val(),b.val(),i,AppLinks.UI.displayValidationError("two-way-link-errors",c,f));return false}else{d();return false}},checkReciprocalLinkFormTwoStepMode:function(f,h,b,i){var c=a(f);var g=a.trim(c.find(".reciprocal-rpc-url").val());if(g==""){a("<div class='error applinks-error'>"+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(c.find(".reciprocal-rpc-url"));if(i){i()}return}var d=c.find(".reciprocal-link-username");var e=c.find(".reciprocal-link-password");if(d.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.username.empty")+"</div>").insertAfter(d);if(i){i()}return false}g=AppLinks.UI.addProtocolToURL(g);AppLinks.SPI.verifyTwoWayLinkDetails(h,g,d.val(),e.val(),b,AppLinks.UI.displayValidationError("two-way-link-errors",f,i));return false}}})(AJS.$);;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/urls.js' */
(function(){AppLinks.Urls={generateUrl:function(b,a){var c=b;if(typeof a=="undefined"){return c}else{AJS.$.each(a,function(d,e){if(c.indexOf("?")<0){c=c+"?"}else{c=c+"&"}c=c+d+"="+encodeURIComponent(JSON.stringify(e))});return c}},generateApplinksAdminUrl:function(d,c,a){var b=d+"/plugins/servlet/applinks/listApplicationLinks";if(c==="confluence"){b=d+"/admin/listapplicationlinks.action"}return AppLinks.Urls.generateUrl(b,a)}}})();;
;/* module-key = 'com.atlassian.jira.jira-issue-link-applinks-common-plugin:issue-link-applinks', location = 'js/issuelink-applinks.js' */
var IssueLinkAppLinks=IssueLinkAppLinks||(function($){function createHelper(servers,context,settings){var helper={};var selectedServer=null;function selectServer(appId){selectedServer=getServer(servers,appId);var authenticationRequired=selectedServer&&selectedServer.requireCredentials;doAuthenticationRequired(authenticationRequired,context);return{authenticationRequired:authenticationRequired}}function setAuthenticationRequired(appId,authenticationRequired){var server=getServer(servers,appId);if(server){server.requireCredentials=authenticationRequired;if(selectedServer&&selectedServer.id===appId){doAuthenticationRequired(authenticationRequired,context)}}}function doAuthenticationRequired(required,context){$(".issue-link-applinks-authentication-message",context).empty();if(required){createAuthRequiredBanner($(".issue-link-applinks-authentication-message",context),context);$(".issue-link-oauth-toggle").hide();$(".buttons-container input[type=submit]",context).attr("disabled","disabled")}else{$(".issue-link-oauth-toggle").show();$(".buttons-container input[type=submit]",context).removeAttr("disabled")}}function createAuthRequiredBanner($container,context){var oauthCallbacks={onSuccess:function(){selectedServer.requireCredentials=false;doAuthenticationRequired(false,context);if(settings.onAuthenticationSuccessCallback){settings.onAuthenticationSuccessCallback(context,selectedServer.id,helper)}},onFailure:function(){if(settings.onAuthenticationFailedCallback){settings.onAuthenticationFailedCallback(context,selectedServer.id,helper)}}};var encodedServerName=AJS.escapeHtml(selectedServer.name);if(selectedServer.authUrl){var $banner=$('<div class="aui-message warning closeable shadowed applinks-auth-request"><p><span class="aui-icon icon-applinks-key"></span></p></div>');$banner.append(AJS.format("Authorization required to create issue link. Please \u003ca href=\"{0}\" class=\"applink-authenticate\"\u003eauthenticate\u003c/a\u003e with \u003ca href=\"{1}\"\u003e{2}\u003c/a\u003e.",selectedServer.authUrl,selectedServer.url,encodedServerName));$("a",$banner).addClass("applink-authenticate");$(".applink-authenticate",$banner).click(function(e){authenticateRemoteCredentials(selectedServer.authUrl,oauthCallbacks.onSuccess,oauthCallbacks.onFailure);e.preventDefault()});$container.append($banner)}else{var warningMessage=AJS.format("Unable to create a link to \u003ca href=\"{0}\"\u003e{1}\u003c/a\u003e as the application does not have any authentication configured.",selectedServer.url,encodedServerName);AJS.messages.warning($container,{body:warningMessage})}}function createOAuthCallback(){if(!AppLinks.OAuthCallback&&typeof (oauthCallback)==="undefined"){AppLinks.OAuthCallback=function(){};AppLinks.OAuthCallback.prototype.success=function(){this.aouthWindow.close();this.onSuccess();delete oauthCallback;delete AppLinks.OAuthCallback};AppLinks.OAuthCallback.prototype.failure=function(){this.aouthWindow.close();this.onFailure();delete oauthCallback;delete AppLinks.OAuthCallback};AppLinks.OAuthCallback.prototype.show=function(url,onSuccess,onFailure){this.onSuccess=onSuccess;this.onFailure=onFailure;this.aouthWindow=window.open(url,"com_atlassian_applinks_authentication")};oauthCallback=new AppLinks.OAuthCallback()}}function authenticateRemoteCredentials(url,onSuccess,onFailure){createOAuthCallback();$(".applinks-error").remove();oauthCallback.show(url,onSuccess,onFailure)}return $.extend(helper,{selectServer:selectServer,setAuthenticationRequired:setAuthenticationRequired})}function getServer(servers,appId){var i;if(servers.length){for(i=0;i<servers.length;i++){if(servers[i].id===appId){return servers[i]}}}return null}function initApplinkServers(settings,context,deferred){var currentAppId=settings.getCurrentAppId(context);var applicationType=$(".issue-link-applinks-application-type",context).val();var issueId=settings.getIssueId(context);$.get(AJS.contextPath()+"/rest/issueLinkAppLink/1/appLink/info",{type:applicationType,issueIdOrKey:issueId},function(servers){var helper=createHelper(servers,context,settings);var currentRequiresCredentials;if(servers&&servers.length){var currentServer=getServer(servers,currentAppId);if(currentServer){currentRequiresCredentials=$(".issue-link-applinks-authentication-message",context).hasClass("required");if(currentRequiresCredentials){currentServer.requireCredentials=true}helper.selectServer(currentAppId)}deferred.resolve(context,helper)}else{deferred.reject(context)}})}function init(settings,context){var deferred=$.Deferred();var isIssueLinkAppLinkContent=$(".issue-link-applinks-authentication-message",context).length!==0;if(isIssueLinkAppLinkContent&&settings.shouldExecute(context)){initApplinkServers(settings,context,deferred)}return deferred.promise()}return{init:init}})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-remote-jira-js', location = 'js/issuelink-jira.js' */
(function($){var settings={getCurrentAppId:function(context){return $("#jira-app-link",context).val()},shouldExecute:function(context){return $("#jira-app-link",context).length!==0},getIssueId:function(context){return $("input[name=id]",context).val()}};var updateIssuePicker=function($select,appId){if($select.length){$select.attr("data-ajax-options.data.app-id",appId);if(appId&&appId!==""){$select.attr("data-ajax-options.url",contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/picker")}else{$select.attr("data-ajax-options.url",contextPath+"/rest/api/2/issue/picker")}$select.trigger("updateOptions");$select.trigger("clearSelection")}};var updateCreateReciprocalCheckbox=function(appId,context){var $reciprocalCheckbox=$("#create-reciprocal",context);if($reciprocalCheckbox.length){if(appId&&appId!==""){var defaultChoice=($("#create-reciprocal-default",context).val()=="true");if(defaultChoice){$reciprocalCheckbox.attr("checked","checked")}else{$reciprocalCheckbox.removeAttr("checked")}$reciprocalCheckbox.removeAttr("disabled");$("#create-reciprocal-fieldset",context).removeClass("disabled")}else{$reciprocalCheckbox.attr("checked","checked");$reciprocalCheckbox.attr("disabled","disabled");$("#create-reciprocal-fieldset",context).addClass("disabled")}}};JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(e,context){var $select=$("#jira-issue-keys",context);if($select.length){var appId=$("#jira-app-link",context).val();updateIssuePicker($select,appId);updateCreateReciprocalCheckbox(appId,context)}IssueLinkAppLinks.init(settings,context).done(function(context,helper){$("#jira-app-link",context).change(function(){var appId=$(this).val();helper.selectServer(appId);updateIssuePicker($select,appId);updateCreateReciprocalCheckbox(appId,context)})})})})(AJS.$);;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/dropdown/Dropdown.js' */
JIRA.Dropdown=function(){var instances=[];return{addInstance:function(){instances.push(this)},hideInstances:function(){var that=this;jQuery(instances).each(function(){if(that!==this){this.hideDropdown()}})},getHash:function(){if(!this.hash){this.hash={container:this.dropdown,hide:this.hideDropdown,show:this.displayDropdown}}return this.hash},displayDropdown:function(){if(JIRA.Dropdown.current===this){return }this.hideInstances();JIRA.Dropdown.current=this;this.dropdown.css({display:"block"});this.displayed=true;var dd=this.dropdown;if(window.top.JIRA&&!window.top.JIRA.Dialog.current){setTimeout(function(){var win=jQuery(window);var minScrollTop=dd.offset().top+dd.prop("offsetHeight")-win.height()+10;if(win.scrollTop()<minScrollTop){jQuery("html,body").animate({scrollTop:minScrollTop},300,"linear")}},100)}},hideDropdown:function(){if(this.displayed===false){return }JIRA.Dropdown.current=null;this.dropdown.css({display:"none"});this.displayed=false},init:function(trigger,dropdown){var that=this;this.addInstance(this);this.dropdown=jQuery(dropdown);this.dropdown.css({display:"none"});jQuery(document).keydown(function(e){if(e.keyCode===9){that.hideDropdown()}});if(trigger.target){jQuery.aop.before(trigger,function(){if(!that.displayed){that.displayDropdown()}})}else{that.dropdown.css("top",jQuery(trigger).outerHeight()+"px");trigger.click(function(e){if(!that.displayed){that.displayDropdown();e.stopPropagation()}else{that.hideDropdown()}e.preventDefault()})}jQuery(document.body).click(function(){if(that.displayed){that.hideDropdown()}})}}}();JIRA.Dropdown.Standard=function(trigger,dropdown){var that=begetObject(JIRA.Dropdown);that.init(trigger,dropdown);return that};JIRA.Dropdown.AutoComplete=function(trigger,dropdown){var that=begetObject(JIRA.Dropdown);that.init=function(trigger,dropdown){this.addInstance(this);this.dropdown=jQuery(dropdown).click(function(e){e.stopPropagation()});this.dropdown.css({display:"none"});if(trigger.target){jQuery.aop.before(trigger,function(){if(!that.displayed){that.displayDropdown()}})}else{trigger.click(function(e){if(!that.displayed){that.displayDropdown();e.stopPropagation()}})}jQuery(document.body).click(function(){if(that.displayed){that.hideDropdown()}})};that.init(trigger,dropdown);return that};AJS.namespace("jira.widget.dropdown",null,JIRA.Dropdown);;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/AutoComplete.js' */
define("jira/autocomplete/autocomplete",["jira/ajs/ajax/smart-ajax","jira/util/objects","jquery"],function(SmartAjax,Objects,jQuery){return function(){var inFocus;var delay=function(callback,l){if(delay.t){clearTimeout(delay.t);delay.t=undefined}delay.t=setTimeout(callback,l*1000)};var INVALID_KEYS={9:true,13:true,14:true,25:true,27:true,38:true,40:true,224:true};return{dispatcher:function(){},getSavedResponse:function(){},saveResponse:function(){},renderSuggestions:function(){},disable:function(){this.disabled=true},enable:function(){this.disabled=false},set:function(options){for(var name in options){if(options.hasOwnProperty(name)){this[name]=options[name]}}},completeField:function(value){if(value){this.field.val(value).focus();this.field.trigger("change")}},textToSuggestionCursorPosition:function(){return this.field.val()},_makeRequest:function(options){var that=this,requestParams=Objects.copyObject(options);if(this.pendingRequest){this.pendingRequest.abort()}requestParams.complete=function(){that.pendingRequest=null};requestParams.error=function(xhr){if(!xhr.aborted&&xhr.status!==0&&options.error){options.error.apply(this,arguments)}};return this.pendingRequest=SmartAjax.makeRequest(requestParams)},addSuggestionControls:function(suggestionNodes){var that=this;var evaluateIndex=function(idx,max){var minBoundary=(that.autoSelectFirst===false)?-1:0;if(that.allowArrowCarousel){if(idx>max){return minBoundary}else{if(idx<minBoundary){return max}else{return idx}}}else{if(idx>max){return max}else{if(idx<minBoundary){that.responseContainer.scrollTop(0);return minBoundary}else{return idx}}}};var setActive=function(idx){if(that.selectedIndex!==undefined&&that.selectedIndex>-1){that.suggestionNodes[that.selectedIndex][0].removeClass("active")}that.selectedIndex=evaluateIndex(idx,that.suggestionNodes.length-1);if(that.selectedIndex>-1){that.suggestionNodes[that.selectedIndex][0].addClass("active")}};var evaluateIfActive=function(){return that.suggestionNodes&&that.suggestionNodes[that.selectedIndex]&&that.suggestionNodes[that.selectedIndex][0].hasClass("active")};var keyPressHandler=function(e){if(that.responseContainer.is(":visible")){if(e.keyCode===13){if(evaluateIfActive()&&!that.pendingRequest){that.completeField(that.suggestionNodes[that.selectedIndex][1])}e.preventDefault();e.stopPropagation()}}};var keyboardNavigateHandler=function(e){if(that.responseContainer.is(":visible")){if(that.field[0]!==document.activeElement){that.field.focus()}if(e.keyCode===40){setActive(that.selectedIndex+1);if(that.selectedIndex>=0){var containerHeight=that.responseContainer.height();var bottom=that.suggestionNodes[that.selectedIndex][0].position().top+that.suggestionNodes[that.selectedIndex][0].outerHeight();if(bottom-containerHeight>0){that.responseContainer.scrollTop(that.responseContainer.scrollTop()+bottom-containerHeight+2)}}else{that.responseContainer.scrollTop(0)}e.preventDefault()}else{if(e.keyCode===38){setActive(that.selectedIndex-1);if(that.selectedIndex>=0){var top=that.suggestionNodes[that.selectedIndex][0].position().top;if(top<0){that.responseContainer.scrollTop(that.responseContainer.scrollTop()+top-2)}}e.preventDefault()}else{if(e.keyCode===9){if(evaluateIfActive()){that.completeField(that.suggestionNodes[that.selectedIndex][1]);e.preventDefault()}else{that.dropdownController.hideDropdown()}}}}}};if(suggestionNodes.length){this.selectedIndex=0;this.suggestionNodes=suggestionNodes;for(var i=0;i<that.suggestionNodes.length;i++){var eventData={instance:this,index:i};this.suggestionNodes[i][0].bind("mouseover",eventData,activate).bind("mouseout",eventData,deactivate).bind("click",eventData,complete)}if(!this.keyboardHandlerBinded){jQuery(this.field).keypress(keyPressHandler);jQuery(this.field).keydown(keyboardNavigateHandler);this.keyboardHandlerBinded=true}if(that.autoSelectFirst===false){setActive(-1)}else{setActive(0)}inFocus=this}function activate(event){if(that.dropdownController.displayed){setActive(event.data.index)}}function deactivate(event){if(event.data.index===0){that.selectedIndex=-1}jQuery(this).removeClass("active")}function complete(event){that.completeField(that.suggestionNodes[event.data.index][1])}},clearResponseContainer:function(){this.responseContainer.empty();this.suggestionNodes=undefined},delay:delay,buildResponseContainer:function(){var inputParent=this.field.parent().addClass("atlassian-autocomplete");this.responseContainer=jQuery(document.createElement("div"));this.responseContainer.addClass("suggestions");this.positionResponseContainer();this.responseContainer.appendTo(inputParent)},positionResponseContainer:function(){this.responseContainer.css({top:this.field.outerHeight()})},keyUpHandler:(function(){function callback(){if(!this.responseContainer){this.buildResponseContainer()}this.dispatcher(this.field.val())}return function(e){if(this.field.val().length>=this.minQueryLength){if(!(e.keyCode in INVALID_KEYS)||(this.responseContainer&&!this.responseContainer.is(":visible")&&(e.keyCode==38||e.keyCode==40))){callback.call(this)}}return e}})(),addMultiSelectAdvice:function(delim){var that=this;var alertUserValueAlreadyExists=function(val){if(!alertUserValueAlreadyExists.isAlerting){alertUserValueAlreadyExists.isAlerting=true;var userAlert=jQuery(document.createElement("div")).css({"float":"left",display:"none"}).addClass("warningBox").html("Oops! You have already entered the value <em>"+val+"</em>").appendTo(that.field.parent()).show("fast",function(){that.delay(function(){userAlert.hide("fast",function(){userAlert.remove();alertUserValueAlreadyExists.isAlerting=false})},4)})}};jQuery.aop.before({target:this,method:"dispatcher"},function(innvocation){var val=this.field.val();innvocation[0]=jQuery.trim(val.slice(val.lastIndexOf(delim)+1));return innvocation});jQuery.aop.before({target:this,method:"completeField"},function(args){var valueToAdd=args[0],untrimmedVals=this.field.val().split(delim);var trimmedVals=jQuery(untrimmedVals).map(function(){return jQuery.trim(this)}).get();if(!this.allowDuplicates&&new RegExp("(?:^|[\\s"+delim+"])"+valueToAdd+"\\s*"+delim).test(this.field.val())){alertUserValueAlreadyExists(valueToAdd);trimmedVals[trimmedVals.length-1]=""}else{trimmedVals[trimmedVals.length-1]=valueToAdd;trimmedVals[trimmedVals.length]=""}args[0]=trimmedVals.join(delim.replace(/([^\s]$)/,"$1 "));return args})},addDropdownAdvice:function(){var that=this;jQuery.aop.after({target:this,method:"buildResponseContainer"},function(args){this.dropdownController=JIRA.Dropdown.AutoComplete({target:this,method:"renderSuggestions"},this.responseContainer);jQuery.aop.after({target:this.dropdownController,method:"hideDropdown"},function(){this.dropdown.removeClass("dropdown-ready")});return args});jQuery.aop.after({target:this,method:"renderSuggestions"},function(args){if(args&&args.length>0){this.dropdownController.displayDropdown();if(this.maxHeight&&this.dropdownController.dropdown.prop("scrollHeight")>this.maxHeight){this.dropdownController.dropdown.css({height:this.maxHeight,overflowX:"visible",overflowY:"scroll"})}else{if(this.maxHeight){this.dropdownController.dropdown.css({height:"",overflowX:"",overflowY:""})}}this.dropdownController.dropdown.addClass("dropdown-ready")}else{this.dropdownController.hideDropdown()}return args});jQuery.aop.after({target:this,method:"completeField"},function(args){this.dropdownController.hideDropdown();return args});jQuery.aop.after({target:this,method:"keyUpHandler"},function(e){if((!(this.field.val().length>=this.minQueryLength)||e.keyCode===27)&&this.dropdownController&&this.dropdownController.displayed){this.dropdownController.hideDropdown();if(e.keyCode===27){e.stopPropagation()}}return e})},init:function(options){var that=this;this.set(options);this.field=this.field||jQuery("#"+this.fieldID);this.field.attr("autocomplete","off").keyup(function(e){if(!that.disabled){that.keyUpHandler(e)}}).keydown(function(e){var ESC_KEY=27;if(e.keyCode===ESC_KEY&&that.responseContainer&&that.responseContainer.is(":visible")){e.preventDefault()}}).click(function(e){if(inFocus===that){e.stopPropagation()}}).blur(function(){if(that.pendingRequest){that.pendingRequest.abort()}});this.addDropdownAdvice();if(options.delimChar){this.addMultiSelectAdvice(options.delimChar)}}}}()});AJS.namespace("jira.widget.autocomplete",null,require("jira/autocomplete/autocomplete"));AJS.namespace("JIRA.AutoComplete",null,require("jira/autocomplete/autocomplete"));;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/RESTAutoComplete.js' */
define("jira/autocomplete/rest-autocomplete",["jira/autocomplete/autocomplete","jira/util/objects"],function(AutoComplete,Objects){return function(){var that=Objects.begetObject(AutoComplete);that.dispatcher=function(reqFieldVal){var that=this;if(reqFieldVal.length<this.minQueryLength){return }if(!this.getSavedResponse(reqFieldVal)){this.delay(function(){var params=that.getAjaxParams();params.data.query=reqFieldVal;params.success=function(data){that.saveResponse(reqFieldVal,data);that.responseContainer.scrollTop(0);that.renderSuggestions(data)};that._makeRequest(params)},that.queryDelay)}else{that.renderSuggestions(that.getSavedResponse(reqFieldVal));that.responseContainer.scrollTop(0)}};that.getAjaxParams=function(){};that.getSavedResponse=function(val){if(!this.requested){this.requested={}}return this.requested[val]};that.saveResponse=function(val,response){if(typeof val==="string"&&typeof response==="object"){if(!this.requested){this.requested={}}this.requested[val]=response}};return that}()});AJS.namespace("jira.widget.autocomplete.REST",null,require("jira/autocomplete/rest-autocomplete"));AJS.namespace("JIRA.RESTAutoComplete",null,require("jira/autocomplete/rest-autocomplete"));;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/IssueAutoComplete.js' */
define("jira/autocomplete/issue-autocomplete",["jira/autocomplete/rest-autocomplete","jira/util/objects","jquery"],function(RESTAutoComplete,Objects,jQuery){var IssueAutoComplete=function(options){var that=Objects.begetObject(RESTAutoComplete);that.getAjaxParams=function(){return{url:contextPath+"/rest/api/2/issue/picker",data:options.ajaxData,dataType:"json",type:"GET"}};that.renderSuggestions=function(response){var resultsContainer,suggestionNodes=[];this.clearResponseContainer();if(response&&response.sections&&response.sections.length>0){resultsContainer=jQuery("<ul/>").appendTo(this.responseContainer);jQuery(response.sections).each(function(){var section=this;var subSection=jQuery("<div/>").attr("id",options.fieldID+"_s_"+section.id).addClass("yag").text(section.label);if(section.sub){subSection.append(jQuery("<span/>").addClass("yagt").text("("+section.sub+")"))}resultsContainer.append(jQuery("<li/>").append(subSection).mouseover(function(){jQuery(this).addClass("active")}).mouseout(function(){jQuery(this).removeClass("active")}));if(section.msg){var msg=jQuery("<div/>").attr("id",options.fieldID+"_i_"+section.id+"_n").addClass("yad").text(section.msg);resultsContainer.append(jQuery("<li/>").append(msg).mouseover(function(){jQuery(this).addClass("active")}).mouseout(function(){jQuery(this).removeClass("active")}))}if(section.issues&&section.issues.length>0){jQuery(section.issues).each(function(){var imgUrl;if(/^http/.test(this.img)){imgUrl=this.img}else{imgUrl=contextPath+this.img}var issueNode=jQuery("<li/>").append(jQuery("<div/>").attr("id",options.fieldID+"_i_"+section.id+"_"+this.key).addClass("yad").append(jQuery("<table/>").addClass("yat").attr({cellpadding:"0",cellspacing:"0"}).append(jQuery("<tr/>").append(jQuery("<td/>").append(jQuery("<img/>").attr("src",imgUrl))).append(jQuery("<td/>").append(jQuery("<div/>").addClass("yak").html(this.keyHtml))).append(jQuery("<td/>").css("width","100%").html(this.summary)))));resultsContainer.append(issueNode);suggestionNodes.push([issueNode,this.key])})}});that.addSuggestionControls(suggestionNodes);return suggestionNodes}};options.minQueryLength=1;options.queryDelay=0.25;that.init(options);return that};IssueAutoComplete.init=function(){jQuery("fieldset.issue-picker-params").each(function(){var params=JIRA.parseOptionsFromFieldset(jQuery(this)),$container=jQuery("#"+params.fieldId+"-container").add("#"+params.fieldName+"_container");$container.find("a.popup-trigger").click(function(e){var url=contextPath+"/secure/popups/IssuePicker.jspa?";url+="currentIssue="+params.currentIssueKey+"&";url+="singleSelectOnly="+params.singleSelectOnly+"&";url+="showSubTasks="+params.showSubTasks+"&";url+="showSubTasksParent="+params.showSubTaskParent;if(params.currentProjectId&&params.currentProjectId!=""){url+="&selectedProjectId="+params.currentProjectId}JIRA.IssuePicker.callback=function(keysMap){var $formElement,keys=[];keysMap=JSON.parse(keysMap);if(params.fieldId&&keys){$formElement=jQuery("#"+params.fieldId);if($formElement){jQuery.each(keysMap,function(){keys.push(this.value)});$formElement.val(keys.join(", "))}}};var vWinUsers=window.open(url,"IssueSelectorPopup","status=no,resizable=yes,top=100,left=200,width=620,height=500,scrollbars=yes,resizable");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()});if(!params.fieldId){params.fieldId=params.fieldName}if(params.issuePickerEnabled===true){IssueAutoComplete({fieldID:params.fieldId,delimChar:params.singleSelectOnly===true?undefined:",",ajaxData:params})}})};return IssueAutoComplete});AJS.namespace("jira.widget.autocomplete.Issues",null,require("jira/autocomplete/issue-autocomplete"));AJS.namespace("JIRA.IssueAutoComplete",null,require("jira/autocomplete/issue-autocomplete"));;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/UserAutoComplete.js' */
define("jira/autocomplete/user-autocomplete",["jira/autocomplete/rest-autocomplete","jira/data/parse-options-from-fieldset","jira/util/browser","jira/util/elements","jira/util/objects","jquery"],function(RESTAutoComplete,parseOptionsFromFieldset,Browser,Elements,Objects,jQuery){var UserAutoComplete=function(options){var that=Objects.begetObject(RESTAutoComplete);that.getAjaxParams=function(){return{url:contextPath+"/rest/api/1.0/users/picker",data:{fieldName:options.fieldID,fieldConfigId:options.fieldConfigID,projectId:options.projectId},dataType:"json",type:"GET"}};function fieldsFormHasBeenSubmitted(field){var submitting=false,form=field.closest("form");if(form.length&&form.hasClass("submitting")){submitting=true}return submitting}that.renderSuggestions=function(response){if(fieldsFormHasBeenSubmitted(this.field)||!Browser.isSelenium()&&!Elements.elementIsFocused(this.field)){return false}var resultsContainer,suggestionNodes=[];this.clearResponseContainer();if(response&&response.users&&response.users.length>0){resultsContainer=jQuery("<ul/>").appendTo(this.responseContainer);jQuery(response.users).each(function(){suggestionNodes.push([jQuery("<li/>").html(this.html).appendTo(resultsContainer),this.name])})}if(response.footer){this.responseContainer.append(jQuery("<div/>").addClass("yui-ac-ft").html(response.footer).css("display","block"))}if(suggestionNodes.length>0){that.addSuggestionControls(suggestionNodes);jQuery(".atlassian-autocomplete div.yad, .atlassian-autocomplete .labels li").textOverflow({autoUpdate:true})}return suggestionNodes};options.minQueryLength=2;options.queryDelay=0.25;that.init(options);return that};UserAutoComplete.init=function(parent){jQuery("fieldset.user-picker-params",parent).each(function(){var params=parseOptionsFromFieldset(jQuery(this)),field=(params.fieldId||params.fieldName),$container=jQuery("#"+field+"_container");$container.find("a.popup-trigger").click(function(e){var url=contextPath,vWinUsers;e.preventDefault();if(!params.formName){params.formName=$container.find("#"+field).parents("form").attr("name")}if(params.actionToOpen){url=url+params.actionToOpen}else{url=url+"/secure/popups/UserPickerBrowser.jspa"}url+="?formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+field;if(params.fieldConfigId){url+="&fieldConfigId="+params.fieldConfigId}if(params.projectId){if(jQuery.isArray(params.projectId)){for(var projectId in params.projectId){url+="&projectId="+projectId}}else{url+="&projectId="+params.projectId}}vWinUsers=window.open(url,"UserPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus()});if(params.userPickerEnabled===true){UserAutoComplete({field:parent?parent.find("#"+field):null,fieldID:field,fieldConfigID:params.fieldConfigId,projectId:params.projectId,delimChar:params.multiSelect===false?undefined:",",ajaxData:{fieldName:params.fieldName}})}})};return UserAutoComplete});AJS.namespace("jira.widget.autocomplete.Users",null,require("jira/autocomplete/user-autocomplete"));AJS.namespace("JIRA.UserAutoComplete",null,require("jira/autocomplete/user-autocomplete"));;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/initAutoCompleteFields.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){JIRA.UserAutoComplete.init(context);JIRA.IssueAutoComplete.init(context)}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){AJS.$("fieldset.user-searcher-params",context).each(function(){var params=JIRA.parseOptionsFromFieldset(AJS.$(this)),$container=AJS.$("#"+params.fieldId+"_container",context);if(params.userPickerEnabled===true){var autocompleter=JIRA.UserAutoComplete({fieldID:params.fieldId,delimChar:params.multiSelect===true?",":undefined,ajaxData:{fieldName:params.fieldName}})}var setupFields=function(related){var field=AJS.$("#"+params.fieldId,context);var userImage=AJS.$("#"+params.fieldId+"Image",context);var groupImage=AJS.$("#"+params.fieldId+"GroupImage",context);var fieldDesc=AJS.$("#"+params.fieldId+"_desc",context);if(related==="select.list.none"){field.val("").attr("disabled","true");userImage.hide();groupImage.hide();fieldDesc.hide()}else{field.removeAttr("disabled");if(related==="select.list.group"){userImage.hide();groupImage.show();if(params.userPickerEnabled===true){autocompleter.disable();fieldDesc.hide()}}else{userImage.show();groupImage.hide();if(params.userPickerEnabled===true){autocompleter.enable();fieldDesc.show()}}}};AJS.$("#"+params.userSelect,context).change(function(){var related=AJS.$(this).find("option:selected").attr("rel");setupFields(related)}).find("option:selected").each(function(){setupFields(AJS.$(this).attr("rel"))});$container.find("a.user-popup-trigger").click(function(e){var url=contextPath+"/secure/popups/UserPickerBrowser.jspa?";url+="formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+params.fieldId;var vWinUsers=window.open(url,"UserPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()});$container.find("a.group-popup-trigger").click(function(e){var url=contextPath+"/secure/popups/GroupPickerBrowser.jspa?";url+="formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+params.fieldId;var vWinUsers=window.open(url,"GroupPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()})})}});;
;/* module-key = 'jira.webresources:jqlautocomplete', location = '/includes/jira/autocomplete/JQLAutoComplete.js' */
define("jira/jql/jql-grammar",function(){var grammar={};grammar.jql_order_by=[{value:"ORDER BY",displayName:"ORDER BY"}];grammar.jql_operators=[{value:"=",displayName:"="},{value:"!=",displayName:"!="},{value:"~",displayName:"~"},{value:"<=",displayName:"&lt;="},{value:">=",displayName:"&gt;="},{value:">",displayName:"&gt;"},{value:"<",displayName:"&lt;"},{value:"!~",displayName:"!~"},{value:"is not",displayName:"is not"},{value:"is",displayName:"is"},{value:"not in",displayName:"not in"},{value:"in",displayName:"in"},{value:"was",displayName:"was"},{value:"was not",displayName:"was not"},{value:"was in",displayName:"was in"},{value:"was not in",displayName:"was not in"},{value:"changed",displayName:"changed"}];grammar.jql_logical_operators=[{value:"AND",displayName:"AND"},{value:"OR",displayName:"OR"}];grammar.jql_logical_operators_and_order_by=grammar.jql_logical_operators.concat(grammar.jql_order_by);grammar.jql_order_by_direction=[{value:"ASC",displayName:"ASC"},{value:"DESC",displayName:"DESC"}];grammar.empty_operand=[{value:"EMPTY",displayName:"EMPTY",types:["java.lang.Object"]}];grammar.jql_not_logical_operator=[{value:"NOT",displayName:"NOT"}];grammar.jql_was_predicates=[{value:"AFTER",displayName:"AFTER",type:"java.util.Date",supportsList:"false"},{value:"BEFORE",displayName:"BEFORE",type:"java.util.Date",supportsList:"false"},{value:"BY",displayName:"BY",type:"com.atlassian.crowd.embedded.api.User",supportsList:"false",auto:"true"},{value:"DURING",displayName:"DURING",type:"java.util.Date",supportsList:"true"},{value:"ON",displayName:"ON",type:"java.util.Date",supportsList:"false"}];grammar.jql_changed_predicates=grammar.jql_was_predicates.concat([{value:"FROM",displayName:"FROM",type:"java.lang.String",supportsList:"true",auto:"true"},{value:"TO",displayName:"TO",type:"java.lang.String",supportsList:"true",auto:"true"}]);grammar.jql_was_predicates_and_order_by=grammar.jql_was_predicates.concat(grammar.jql_logical_operators_and_order_by);grammar.jql_was_predicates_and_logical_operators=grammar.jql_was_predicates.concat(grammar.jql_logical_operators);grammar.jql_changed_predicates_and_order_by=grammar.jql_changed_predicates.concat(grammar.jql_logical_operators_and_order_by);grammar.jql_changed_predicates_and_logical_operators=grammar.jql_changed_predicates.concat(grammar.jql_logical_operators);grammar.REGEXP_ANDS=/^AND\s/i;grammar.REGEXP_ORS=/^OR\s/i;grammar.REGEXP_NOTS=/^NOT\s/i;grammar.REGEXP_SNOT=/^\s+not/i;grammar.REGEXP_SIN=/^\s+in/i;grammar.REGEXP_SNOT_IN=/^\s+(not\s+in|not|in)/i;grammar.REGEXP_COMMA_DELIMITER=/^\s*,/;grammar.REGEXP_ASCENDING=/^\s+asc/i;grammar.REGEXP_DESCENDING=/^\s+desc/i;grammar.REGEXP_ORDER_BY=/^order\s+by/i;grammar.REGEXP_WHITESPACE=/^\s/;grammar.REGEXP_UNICODE=/^u[a-fA-F0-9]{4}/;grammar.REGEXP_FIELD_NAME=/^\s-\scf\[\d\d\d\d\d\]/;grammar.REGEXP_NEW_LINE=/[\r\n]/;grammar.REGEXP_NUMBER=/\d/;grammar.REGEXP_TOKEN_CHAR=/[^=!~<>(),\s&|\]]/;grammar.REGEXP_SPECIAL_CHAR=/[{}*\/%+$#@?;\][]/;grammar.REGEXP_SPACE_OR_ELSE=/[\s(]/;grammar.REGEXP_CHARS_TO_ESCAPE=/[^trn"'\\\s]/;grammar.REGEXP_NOTSTART=/^NO?$/i;grammar.REGEXP_INSTART=/^IN?$/i;grammar.REGEXP_PREDICATE=/^(after|before|by|during|from|on|to)/i;return grammar});define("jira/autocomplete/jql-autocomplete",["jira/autocomplete/autocomplete","jira/jql/jql-grammar","jira/jql/util","jira/jql/operator-util","jira/util/data/meta","jira/util/objects","jquery"],function(AutoComplete,grammar,Util,OperatorUtil,Meta,Objects,jQuery){var JQLAutoComplete=function(options){var that=Objects.begetObject(AutoComplete);var parser=options.parser;var result;var jql_field_names=jQuery.grep(options.jqlFieldNames,function(arrValue){return arrValue.searchable});var jql_order_by_field_names=jQuery.grep(options.jqlFieldNames,function(arrValue){return arrValue.orderable});var jql_function_names=options.jqlFunctionNames;var PARSE_INDICATOR=jQuery("#"+options.errorID);var suggestionCount=0;var jqlcolumnnum=jQuery("#jqlcolumnnum");var jqlrownum=jQuery("#jqlrownum");var autoCompleteUrl=options.autoCompleteUrl||contextPath+"/rest/api/2/jql/autocompletedata/suggestions";that.textToSuggestionCursorPosition=function(){return that.field.selectionRange().textBefore};that.pushSuggestionsOnHtmlStack=function(suggestions,suggestionNodes,htmlParts,listItemIdentifier,mayNeedParenthesis){var length=Math.min(15,suggestions.length);for(var i=0;i<length;i++){var actualValueSug;var displayNameSug;if(suggestions[i].value){var resultSug=suggestions[i];if(result&&mayNeedParenthesis){actualValueSug=((result.getNeedsOpenParen())?"(":"")+resultSug.value}else{actualValueSug=resultSug.value}displayNameSug=resultSug.displayName}else{displayNameSug=suggestions[i];actualValueSug=displayNameSug}suggestionNodes.push(actualValueSug);htmlParts.push('<li id="',listItemIdentifier,i,'">',displayNameSug,"</li>")}};that.renderSuggestions=function(suggestions,moreSuggestions,operatorSuggestions){var suggestionNodes=[];if(suggestions instanceof Array){if(suggestions.length<1&&(moreSuggestions&&moreSuggestions.length<1)&&(operatorSuggestions&&operatorSuggestions.length<1)){return suggestionNodes}var htmlParts=["<ul>"];if(operatorSuggestions&&operatorSuggestions.length>0){that.pushSuggestionsOnHtmlStack(operatorSuggestions,suggestionNodes,htmlParts,"jql_operator_suggest_",false)}that.pushSuggestionsOnHtmlStack(suggestions,suggestionNodes,htmlParts,"jql_value_suggest_",true);if(moreSuggestions&&moreSuggestions.length>0){that.pushSuggestionsOnHtmlStack(moreSuggestions,suggestionNodes,htmlParts,"jql_function_suggest_",false)}htmlParts.push("</ul>");var syntaxHelpLink=jQuery('<a class="syntax-help" target="_jiraHelp"></a>').attr("title",Meta.get("advanced-search-help-title")).attr("href",Meta.get("advanced-search-help-url")).text("Syntax Help");var syntaxHelpContainer=jQuery('<div class="syntax-help-container">').append(syntaxHelpLink);that.responseContainer.html(htmlParts.join("")).append(syntaxHelpContainer).find("li").each(function(i){suggestionNodes[i]=[jQuery(this),suggestionNodes[i]]});that.addSuggestionControls(suggestionNodes)}return suggestionNodes};that.completeField=function(value){var start=that.getReplacementStartIndex(result,value);var end=that.getReplacementEndIndex(result,start);that.replaceValue(start,end,value);var newToken=parser.parse(that.field.val());that.updateParseIndicator(newToken)};that.prepareOperandSuggestions=function(canAutoComplete,fieldName,functionSuggestions,operatorSuggestions,suggestedValue){if(canAutoComplete){var currentSuggestionCount=suggestionCount;var fieldValue=(suggestedValue==null)?((result.getLastOperand()===null)?"":Util.stripEscapeCharacters(result.getLastOperand())):suggestedValue;var fieldNameValueKey=fieldName+":"+fieldValue;var data={fieldName:Util.stripEscapeCharacters(fieldName)};if(result.getLastOperand()!==null||suggestedValue!==null){data.fieldValue=fieldValue}var includeEmpty=OperatorUtil.isWasOperator(result.getLastOperator());if(!that.getSavedResponse(fieldNameValueKey)){that.dropdownController.dropdown.removeClass("dropdown-ready");that.delay(function(){that._makeRequest({url:autoCompleteUrl,dataType:"json",data:data,success:function(response){var results;if(response!==null&&response.results!==null){results=response.results}else{results=[]}if(includeEmpty){var suggestion=data.fieldValue;results=that.appendEmpty(suggestion,results)}that.saveResponse(fieldNameValueKey,results);that.renderSuggestionsForOperands(fieldValue,results,functionSuggestions,operatorSuggestions,currentSuggestionCount)},error:function(){that.renderSuggestionsForOperands(fieldValue,[],functionSuggestions,operatorSuggestions,currentSuggestionCount)}})},that.queryDelay)}else{that.renderSuggestionsForOperands(fieldValue,that.getSavedResponse(fieldNameValueKey),functionSuggestions,operatorSuggestions,currentSuggestionCount)}}else{that.renderSuggestionsForOperands(Util.stripEscapeCharacters(result.getLastOperand()),[],functionSuggestions,operatorSuggestions,suggestionCount)}};that.preparePredicateSuggestions=function(predicateName,suggestedValue){var currentSuggestionCount=suggestionCount;if(typeof suggestedValue=="undefined"){suggestedValue=null}var functionSuggestions=that.slimListForPredicates(suggestedValue,jql_function_names,predicateName);that.boldMatchingString(suggestedValue,functionSuggestions);var predicateValue=(suggestedValue==null)?((result.getLastOperand()===null)?"":Util.stripEscapeCharacters(result.getLastOperand())):suggestedValue;var predicateNameValueKey=predicateName+":"+predicateValue;var data={predicateName:Util.stripEscapeCharacters(predicateName)};if(result.getLastOperand()!==null||suggestedValue!==null){data.predicateValue=predicateValue}if(result.getLastFieldName()!==null){data.fieldName=result.getLastFieldName();predicateNameValueKey=result.getLastFieldName()+":"+predicateNameValueKey}if(that.predicateSupportsAutoComplete(predicateName)){if(!that.getSavedResponse(predicateNameValueKey)){that.dropdownController.dropdown.removeClass("dropdown-ready");that.delay(function(){that._makeRequest({url:autoCompleteUrl,dataType:"json",data:data,success:function(response){var results;if(response!==null&&response.results!==null){results=response.results}else{results=[]}var suggestion=data.predicateValue;results=that.appendEmpty(suggestion,results);that.saveResponse(predicateNameValueKey,results);that.renderSuggestions(results,functionSuggestions)},error:function(){that.renderSuggestionsForOperands(predicateValue,[])}})},that.queryDelay)}else{that.renderSuggestions(that.getSavedResponse(predicateNameValueKey),functionSuggestions)}}else{that.renderSuggestions([],functionSuggestions)}};that.incompleteOperator=function(){var tokens=result.getTokens();if(tokens==null||tokens.length<2){return""}else{tokens=that.textToSuggestionCursorPosition().split(" ");if(tokens.length>2){return tokens[tokens.length-1]}}return""};that.incompletePredicateValue=function(){var tokens=result.getTokens();if(tokens==null||tokens.length<3){return""}else{tokens=that.textToSuggestionCursorPosition().split(/[\s(,]+/);if(tokens.length>3){return tokens[tokens.length-1]}}return""};that.appendEmpty=function(suggestion,results){var empty_list=that.slimListForMapResults(suggestion,grammar.empty_operand,true);if(suggestion!=null){that.boldMatchingString(suggestion,empty_list)}if(results.length<15){results=results.concat(empty_list)}else{results[14]=empty_list[0]}return results};that.dispatcher=function(val){var selectionRange=jQuery(that.field).selectionRange();var parseValue=val.substring(0,selectionRange.start);var value;var functionSuggestions;var token=parser.parse(parseValue);result=token.getResult();suggestionCount++;if(result.getNeedsField()){that.renderSuggestionsFromMap(Util.stripEscapeCharacters(result.getLastFieldName()),jql_field_names,grammar.jql_not_logical_operator,true)}else{if(result.getNeedsOperatorOrOperand()){functionSuggestions=(OperatorUtil.isEmptyOnlyOperator(result.getLastOperator()))?grammar.empty_operand:jql_function_names;token.calcLastOperandStartIndex();var parsedOperator=token.getParsedOperator();var operatorSuggestions=that.getSuggestionsForOperators(parsedOperator,grammar.jql_operators);if(operatorSuggestions&&operatorSuggestions.length>0){var operandSuggestion=that.incompleteOperator();that.prepareOperandSuggestions(true,result.getLastFieldName(),functionSuggestions,operatorSuggestions,operandSuggestion)}}else{if(result.getNeedsOperator()){that.renderSuggestionsForOperators(result.getLastOperator(),grammar.jql_operators)}else{if(result.getNeedsPredicateOperand()){var predicate=result.getLastWasPredicate();that.preparePredicateSuggestions(predicate,Util.stripEscapeCharacters(result.getLastOperand()))}else{if(result.getNeedsLogicalOperator()){if(result.getNeedsWasPredicate()){if(result.getNeedsOrderBy()){value=(result.getLastOrderBy()===null)?result.getLastWasPredicate():result.getLastOrderBy();if(result.getLastOperator()=="was"){that.renderSuggestionsFromMap(value,grammar.jql_was_predicates_and_order_by,false)}else{that.renderSuggestionsFromMap(value,grammar.jql_changed_predicates_and_order_by,false)}}else{if(result.getLastOperator()=="was"){that.renderSuggestionsFromMap(result.getLastWasPredicate(),grammar.jql_was_predicates_and_logical_operators,false)}else{that.renderSuggestionsFromMap(result.getLastWasPredicate(),grammar.jql_changed_predicates_and_logical_operators,false)}}}else{if(result.getNeedsOrderBy()){value=(result.getLastOrderBy()===null)?result.getLastLogicalOperator():result.getLastOrderBy();that.renderSuggestionsFromMap(value,grammar.jql_logical_operators_and_order_by,false)}else{that.renderSuggestionsFromMap(result.getLastLogicalOperator(),grammar.jql_logical_operators,false)}}}else{if(result.getNeedsOrderByField()){that.renderSuggestionsFromMap(Util.stripEscapeCharacters(result.getLastOrderByFieldName()),jql_order_by_field_names,true)}else{if(result.getNeedsOrderByDirection()){that.renderSuggestionsFromMap(result.getLastOrderByDirection(),grammar.jql_order_by_direction,false)}else{if(result.getNeedsOperand()){var fieldName=result.getLastFieldName();var canAutoComplete=false;if(!OperatorUtil.isEmptyOnlyOperator(result.getLastOperator())){for(var i=0;i<jql_field_names.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&Util.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){canAutoComplete=jql_field_names[i].auto;break}}}functionSuggestions=(OperatorUtil.isEmptyOnlyOperator(result.getLastOperator()))?grammar.empty_operand:jql_function_names;that.prepareOperandSuggestions(canAutoComplete,fieldName,functionSuggestions,{})}else{if(result.getNeedsOrderBy()){that.renderSuggestionsFromMap(result.getLastOrderBy(),grammar.jql_logical_operators_and_order_by,false)}else{that.dropdownController.hideDropdown()}}}}}}}}}that.parse(val)};that.parse=function(val){var newToken=parser.parse(val);that.updateParseIndicator(newToken);that.updateColumnLineCount();return newToken.getResult()};that.renderSuggestionsFromMap=function(stringVal,list,otherSuggestions,showFull){if(!otherSuggestions){otherSuggestions={}}var suggestions=that.slimListForMapResults(stringVal,list,showFull);var relevantOtherSuggestions=that.slimListForMapResults(stringVal,otherSuggestions,showFull);that.boldMatchingString(stringVal,relevantOtherSuggestions);that.boldMatchingString(stringVal,suggestions);that.renderSuggestions(suggestions,relevantOtherSuggestions);if(suggestions.length===0&&relevantOtherSuggestions.length===0){that.dropdownController.hideDropdown()}};that.getSuggestionsForOperators=function(stringVal,list){var suggestions=that.slimListForMapResults(stringVal,list,false);var fieldName=result.getLastFieldName();var supportedOperators;for(var i=0;i<jql_field_names.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&Util.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){supportedOperators=jql_field_names[i].operators;break}}if(supportedOperators){suggestions=jQuery.grep(suggestions,function(arrValue){return jQuery.inArray(arrValue.value,supportedOperators)>-1})}that.boldMatchingString(stringVal,suggestions);return suggestions};that.renderSuggestionsForOperators=function(stringVal,list){var suggestions=that.getSuggestionsForOperators(stringVal,list);that.renderSuggestions(suggestions);if(suggestions.length===0){that.dropdownController.hideDropdown()}};that.renderSuggestionsForOperands=function(stringVal,ajaxSuggestions,functions,operatorSuggestions,providedSuggestionCount){if(providedSuggestionCount===suggestionCount){var functionsSuggestions=that.slimListForFunctionResults(stringVal,functions,result.getLastOperator());that.boldMatchingString(stringVal,functionsSuggestions);that.renderSuggestions(ajaxSuggestions,functionsSuggestions,operatorSuggestions);if(ajaxSuggestions.length===0&&functionsSuggestions.length===0&&operatorSuggestions.length==0){that.dropdownController.hideDropdown()}}};that.boldMatchingString=function(stringVal,list){if(stringVal==null||list.length===0){return }var boldLength=stringVal.length;for(var j=0,n=boldLength;j<n;j++){switch(stringVal.charAt(j)){case"<":case">":boldLength+=3;break;case"&":boldLength+=4;break;case'"':boldLength+=5;break}}for(var i=0;i<list.length;i++){if(list[i].displayName){var origVal=list[i].displayName;list[i]={value:list[i].value,displayName:"<b>"+origVal.substring(0,boldLength)+"</b>"+origVal.substring(boldLength)}}else{list[i]={value:list[i],displayName:"<b>"+list[i].substring(0,boldLength)+"</b>"+list[i].substring(boldLength)}}}};that.getReplacementStartIndex=function(result,value){var jQueryReference=jQuery(that.field);var start;if(result.getNeedsField()){start=result.getLastFieldNameStartIndex()}else{if(result.getNeedsOperatorOrOperand()){if(result.getNeedsOperator()&&OperatorUtil.isWasOperator(value)){start=result.getLastOperatorStartIndex()}else{start=result.getLastOperandStartIndex()}}else{if(result.getNeedsOperand()){start=result.getLastOperandStartIndex()}else{if(result.getNeedsOperator()){start=result.getLastOperatorStartIndex()}else{if(result.getNeedsOrderByField()){start=result.getLastOrderByFieldNameStartIndex()}else{if(result.getNeedsOrderByDirection()){start=result.getLastOrderByDirectionStartIndex()}else{if(result.getNeedsPredicateOperand()){start=result.getLastOperandStartIndex()}else{if(result.getNeedsLogicalOperator()){if(result.getLastLogicalOperatorStartIndex()!==null&&result.getLastLogicalOperatorStartIndex()!==0){start=result.getLastLogicalOperatorStartIndex()}else{if(result.getLastOrderBy()!==null&&result.getLastOrderByStartIndex()!==0){start=result.getLastOrderByStartIndex()}else{if(result.getLastWasPredicate()!=null&&result.getLastWasPredicateStartIndex()!==0){start=result.getLastWasPredicateStartIndex()}else{if(result.getMustBeOperatorOrPredicate()===true){start=jQueryReference.selectionRange().start}else{start=jQueryReference.selectionRange().start-1}}}}}else{if(result.getNeedsWasPredicate()){start=result.getLastWasPredicateStartIndex()}else{if(result.getNeedsOrderBy()){start=result.getLastOrderByStartIndex()}else{start=jQueryReference.selectionRange().start-1}}}}}}}}}}return start!=null?start:jQueryReference.selectionRange().start};that.getReplacementEndIndex=function(result,start){var jQueryReference=jQuery(that.field);var selectionRange=jQueryReference.selectionRange();var end=null;if(selectionRange.start===selectionRange.end&&selectionRange.end!==that.field.val().length){var currentTokenIdx=result.getTokens().length-1;var token=parser.parse(that.field.val());if(!token.getParseError()){var fullTokenValue=token.getResult().getTokens()[currentTokenIdx];if(fullTokenValue!==null&&fullTokenValue!=="("&&fullTokenValue!==")"){var fullTextVal=that.field.val();var remainingString=fullTextVal.substring(start,fullTextVal.length);var remainingStringArr=remainingString.split("");var whitespaceCount=0;for(var i=0;i<remainingStringArr.length;i++){if(grammar.REGEXP_WHITESPACE.test(remainingStringArr[i])){whitespaceCount++}else{break}}end=start+fullTokenValue.length+whitespaceCount}}}if(end===null){end=selectionRange.end}if(end<start){that.replaceValue(start,end," ");end=start}return end};that.replaceValue=function(start,end,newValue){var jQueryReference=jQuery(that.field);jQueryReference.selectionRange(start,end);jQueryReference.selection(newValue);var newEnd=jQueryReference.selectionRange().end;jQueryReference.selectionRange(newEnd,newEnd)};that.slimListForMapResults=function(stringVal,list,showFull){var escString=Util.htmlEscape(stringVal);var slimedList=jQuery.grep(list,function(arrValue){return Util.startsWithIgnoreCaseNullsMeanAll(escString,arrValue.displayName)});if(!showFull){if(slimedList.length===1&&!Util.startsWithNotEqualsIgnoreCaseNullMeansAll(escString,slimedList[0].displayName)){return{}}}return slimedList};that.slimListForFunctionResults=function(stringVal,list,operator){var fieldName=result.getLastFieldName();var supportedTypes;for(var i=0;i<jql_field_names.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&Util.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){supportedTypes=jql_field_names[i].types;break}}var slimedList=jQuery.grep(list,function(arrValue){if((arrValue.isList&&!OperatorUtil.isListSupportingOperator(operator))||(!arrValue.isList&&OperatorUtil.isListSupportingOperator(operator))){return false}if(supportedTypes){var supportsFunction=jQuery.inArray("java.lang.Object",arrValue.types)>-1||jQuery.inArray("java.lang.Object",supportedTypes)>-1;for(var i=0;i<supportedTypes.length&&!supportsFunction;i++){supportsFunction=jQuery.inArray(supportedTypes[i],arrValue.types)!==-1}if(!supportsFunction){return false}}else{return false}return Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.value)||Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.displayName)});if(slimedList.length===1&&!Util.startsWithNotEqualsIgnoreCaseNullMeansAll(stringVal,slimedList[0].displayName)){return{}}return slimedList};that.slimListForPredicates=function(stringVal,list,predicate){var supportedType;var supportsList;for(var i=0;i<grammar.jql_changed_predicates.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(grammar.jql_changed_predicates[i].value),predicate)){supportedType=grammar.jql_changed_predicates[i].type;supportsList=grammar.jql_changed_predicates[i].supportsList;break}}var slimedList=jQuery.grep(list,function(arrValue){if(typeof arrValue.isList!="undefined"){if((arrValue.isList&&!!supportsList)||(!arrValue.isList&&supportsList)){return false}}var supportsFunction=jQuery.inArray(supportedType,arrValue.types)!==-1;return supportsFunction?Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.value)||Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.displayName):false});if(slimedList.length===1&&!Util.startsWithNotEqualsIgnoreCaseNullMeansAll(stringVal,slimedList[0].displayName)){return{}}return slimedList};that.predicateSupportsAutoComplete=function(predicate){var auto;for(var i=0;i<grammar.jql_changed_predicates.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(grammar.jql_changed_predicates[i].value),predicate)){auto=grammar.jql_changed_predicates[i].auto;break}}return auto};that.getSavedResponse=function(val){if(!this.requested){this.requested={}}return this.requested[val]};that.saveResponse=function(val,response){if(typeof val==="string"&&typeof response==="object"){if(!this.requested){this.requested={}}this.requested[val]=response}};that.startsWithIgnoreCase=function(startStr,str){if(str===null||startStr===null||str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}};that.updateParseIndicator=function(token){if(token.getParseError()){PARSE_INDICATOR.attr("title",token.getResult().getParseErrorMsg()).removeClass("jqlgood").addClass("jqlerror")}else{PARSE_INDICATOR.attr("title","").removeClass("jqlerror").addClass("jqlgood")}};that.updateColumnLineCount=function(){var jQueryReference=jQuery(that.field);var totalCharCountToCursor=0;if(that.field[0]===document.activeElement){var selectionRange=jQueryReference.selectionRange();totalCharCountToCursor=selectionRange.start}else{totalCharCountToCursor=that.field[0].value.length}var rowCount=1;var colCount=1;var fieldValue=that.field.val();for(var i=0;i<totalCharCountToCursor;i++){if(grammar.REGEXP_NEW_LINE.test(fieldValue.charAt(i))){rowCount++;colCount=1}else{colCount++}}jqlcolumnnum.text(colCount);jqlrownum.text(rowCount)};that.init(options);return that};return JQLAutoComplete});define("jira/jql/util",["jira/jql/jql-grammar"],function(grammar){var JQLAutoCompleteUtil={};JQLAutoCompleteUtil.htmlEscape=function(stringVal){if(stringVal==null){return null}var escapedVal="";var strArr=stringVal.split("");for(var j=0;j<strArr.length;j++){if(strArr[j]==="<"){escapedVal+="&lt;"}else{if(strArr[j]===">"){escapedVal+="&gt;"}else{if(strArr[j]==="&"){escapedVal+="&amp;"}else{if(strArr[j]==='"'){escapedVal+="&quot;"}else{escapedVal+=strArr[j]}}}}}return escapedVal};JQLAutoCompleteUtil.stripEscapeCharacters=function(val){if(val==null){return val}var newVal="";var strArr=val.split("");for(var i=0;i<strArr.length;i++){if(strArr[i]=="\\"){if(!grammar.REGEXP_UNICODE.test(val.substring(i,val.length))){i++;if(i>=val.length){break}}}newVal+=strArr[i]}return newVal};JQLAutoCompleteUtil.equalsIgnoreCase=function(str1,str2){if(str1===null&&str2===null){return true}else{if(str1===null||str1===null){return false}else{return str1.toLowerCase()===str2.toLowerCase()}}};JQLAutoCompleteUtil.startsWithIgnoreCaseNullsMeanAll=function(startStr,str){if(str===null||startStr===null){return true}if(str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}};JQLAutoCompleteUtil.startsWithNotEqualsIgnoreCaseNullMeansAll=function(startStr,str){if(str===null||startStr===null){return true}if(str.length<startStr.length){return false}else{var subStrEquals=startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase();if(subStrEquals){var equalsString=null;if(grammar.REGEXP_FIELD_NAME.test(str.substr(startStr.length,str.length))){equalsString=str.substr(0,startStr.length)}else{equalsString=str}return startStr.toLowerCase()!=equalsString.toLowerCase()}return false}};return JQLAutoCompleteUtil});define("jira/jql/operator-util",function(){var that={};that.isListSupportingOperator=function(operator){return operator==="in"||operator==="not in"||operator=="was not in"||operator=="was in"};that.isEmptyOnlyOperator=function(operator){return operator==="is"||operator==="is not"};that.isWasOperator=function(operator){return operator==="was"||operator==="was in"||operator=="was not in"||operator=="was not"};that.isChangedOperator=function(operator){return operator==="changed"};that.isHistoryOperator=function(operator){return that.isWasOperator(operator)||that.isChangedOperator(operator)};return that});define("jira/jql/jql-parser",["jira/jql/jql-grammar","jira/jql/jql-parse-token","jira/jql/operator-util","jquery"],function(grammar,Token,OperatorUtil,jQuery){return function(jqlReservedWords){var jql_reserved_words=jqlReservedWords;return{parse:function(input){var token=Token();token.init(input);this.jql(token);return token},orderByClause:function(token){var remainingString=token.remainingString();var matchArray=remainingString.match(grammar.REGEXP_ORDER_BY);if(matchArray){var orderByString=remainingString.substring(0,matchArray[0].length);token.consumeCharacters(orderByString.length);token.getResult().setLastOrderBy(orderByString,token);if(!token.isComplete()){remainingString=token.remainingString();if(grammar.REGEXP_WHITESPACE.test(remainingString)){this.chewWhitespace(token);this.orderByFields(token)}else{token.getResult().resetLogicalOperators();token.setParseError()}}else{token.getResult().resetLogicalOperators();token.setParseError()}}else{token.consumeCharacters(remainingString.length);token.getResult().setLastOrderBy(remainingString,token);token.setParseError()}},orderByFields:function(token){this.orderByField(token);this.chewWhitespace(token);if(token.isComplete()){if(!token.getResult().getNeedsOrderByField()){token.getResult().setLastOrderByDirection("",token)}}else{var remainingString=token.remainingString();if(this.startsWithIgnoreCase(",",remainingString)){token.consumeCharacter();this.orderByFields(token);this.chewWhitespace(token)}else{remainingString=token.remainingString();if(remainingString!==null){token.consumeCharacters(remainingString.length)}token.getResult().setNeedsOrderByDirection();token.getResult().setLastOrderByDirection(remainingString,token);token.setParseError()}}},orderByField:function(token){this.chewWhitespace(token);var fieldName=this.fieldName(token);if(fieldName.length!==0){token.getResult().setLastOrderByFieldName(fieldName,token);var remainingString=token.remainingString();if(!token.isComplete()&&!grammar.REGEXP_COMMA_DELIMITER.test(remainingString)){if(grammar.REGEXP_ASCENDING.test(remainingString)){this.chewWhitespace(token);token.consumeCharacters(3);token.getResult().setLastOrderByDirection("asc",token);token.getResult().setNeedsOrderByComma()}else{if(grammar.REGEXP_DESCENDING.test(remainingString)){this.chewWhitespace(token);token.consumeCharacters(4);token.getResult().setLastOrderByDirection("desc",token);token.getResult().setNeedsOrderByComma()}else{token.getResult().setNeedsOrderByDirection()}}}else{token.getResult().setNeedsOrderByField();this.chewWhitespace(token)}}else{token.getResult().setLastOrderByFieldName("",token);token.getResult().setNeedsOrderByField();token.setParseError()}},jql:function(token){this.orClause(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){this.orderByClause(token)}},orClause:function(token){while(!token.isComplete()&&!this.startsWithIgnoreCase(")",token.remainingString())){this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){break}if(token.getResult().getMustBeOperatorOrPredicate()){token.getResult().resetLastPredicates()}else{token.getResult().resetLogicalOperators();this.andClause(token)}if(!token.isComplete()&&token.getResult().getLastLogicalOperator()===null){if(token.getResult().getNeedsWasPredicate()){this.predicateClause(token)}if(token.isComplete()){return }remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){break}else{if(remainingString!==null&&(grammar.REGEXP_ORS.test(remainingString)||this.startsWithIgnoreCase("|",remainingString)||this.startsWithIgnoreCase("||",remainingString))){if(this.startsWithIgnoreCase("||",remainingString)){token.getResult().setLastLogicalOperator("||",token.getTokenStringIdx());token.consumeCharacters(2)}else{if(grammar.REGEXP_ORS.test(remainingString)){token.getResult().setLastLogicalOperator("OR",token.getTokenStringIdx());token.consumeCharacters(3)}else{token.getResult().setLastLogicalOperator("|",token.getTokenStringIdx());token.consumeCharacters(1)}}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{if(!this.startsWithIgnoreCase(")",remainingString)||!token.getInParens()){this.chewWhitespace(token);var errorIdx=(remainingString===null)?token.getMaxTokenStringIdx():token.getMaxTokenStringIdx()-remainingString.length;var tokens;if(remainingString!=null){tokens=remainingString.split(" ");token.getResult().setLastLogicalOperator(tokens[0],errorIdx);token.getResult().setLastWasPredicate(tokens[0],token);token.getResult().setNeedsLogicalOperator(token)}if(token.getResult().getLastWasOperator()==null){token.setParseError()}else{if(tokens!=null){if(grammar.REGEXP_PREDICATE.test(tokens[0])){token.getResult().setLastLogicalOperator(null);token.getResult().resetNeedsPredicateOperand()}else{if(grammar.REGEXP_ANDS.test(remainingString)){token.consumeCharacters(4);token.getResult().resetTerminalClause();token.getResult().setNeedsField()}if(token.isComplete()||tokens.length==1){token.setParseError()}}}}}}}}}},andClause:function(token){this.chewWhitespace(token);this.notClause(token);if(!token.isComplete()&&token.getResult().getLastLogicalOperator()===null){this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!==null&&(grammar.REGEXP_ANDS.test(remainingString)||this.startsWithIgnoreCase("&",remainingString)||this.startsWithIgnoreCase("&&",remainingString))){if(this.startsWithIgnoreCase("&&",remainingString)){token.getResult().setLastLogicalOperator("&&",token.getTokenStringIdx());token.consumeCharacters(2)}else{if(this.startsWithIgnoreCase("&",remainingString)){token.getResult().setLastLogicalOperator("&",token.getTokenStringIdx());token.consumeCharacters(1)}else{token.getResult().setLastLogicalOperator("AND",token.getTokenStringIdx());token.consumeCharacters(4)}}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{token.getResult().setNeedsLogicalOperator(token);if(token.isComplete()){token.getResult().setLastLogicalOperator(null,token.getMaxTokenStringIdx())}}}},notClause:function(token){this.chewWhitespace(token);if(!token.isComplete()){this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!==null&&(grammar.REGEXP_NOTS.test(remainingString)||this.startsWithIgnoreCase("!",remainingString))){token.getResult().needsField=false;if(this.startsWithIgnoreCase("!",remainingString)){token.getResult().setLastLogicalOperator("!",token.getTokenStringIdx());token.consumeCharacters(1)}else{token.getResult().setLastLogicalOperator("NOT",token.getTokenStringIdx());token.consumeCharacters(4)}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{this.terminalClause(token)}}else{this.terminalClause(token);token.setParseError()}},predicateClause:function(token){this.chewWhitespace(token);if(!token.isComplete()){var remainingString=token.remainingString();var tokens=remainingString.split(/[\s(]+/);if(remainingString!==null){token.getResult().setMustBeOperatorOrPredicate(false);if(this.startsWithLogicalOperator(remainingString)){if(tokens.length==1){token.getResult().setLastWasPredicate(tokens[0],token);token.setParseError();return }return }token.getResult().resetNeedsPredicateOperand();token.consumeCharacters(tokens[0].length);token.getResult().setLastWasPredicate(tokens[0],token);if(tokens.length==1){token.setParseError();return }if(this.wasPredicateComplete(tokens[0])){token.getResult().setNeedsPredicateOperand();token.getResult().setLastOperand(null,token);this.predicateOperand(token)}else{token.setParseError()}}}else{token.setParseError()}},predicateOperand:function(token){this.chewWhitespace(token);var predicateOperand=this.collectPredicateOperands(token);if(predicateOperand==null||predicateOperand==""){token.getResult().setLastOperandStartIndex(token.getTokenStringIdx());token.setParseError()}if(token.remainingString()!=null){token.getResult().resetNeedsPredicateOperand();token.getResult().resetLastPredicates();token.getResult().setMustBeOperatorOrPredicate(true);token.getResult().setNeedsLogicalOperator(token);this.chewWhitespace(token)}},collectPredicateOperands:function(token){if(token.getResult().getLastWasPredicate()==="DURING"){token.getResult().setNeedsOpenParen(true)}var predicateOperand=this.listOperand(token,true);if(predicateOperand.length===0){predicateOperand=this.functionOperand(token);if(predicateOperand.length===0){predicateOperand=this.singleValueOperand(token)}else{token.getResult().setNeedsOpenParen(false)}}else{token.getResult().setNeedsOpenParen(false)}return token.getResult().getUnquotedString(predicateOperand)},terminalClause:function(token){token.getResult().resetTerminalClause();this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("(",remainingString)){token.getResult().addToken("(");token.setInParens();token.consumeCharacter();this.orClause(token);this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase(")",remainingString)){token.getResult().addToken(")");token.consumeCharacter();token.setOutOfParens();if(token.isComplete()){token.getResult().resetLogicalOperators();token.getResult().resetLastPredicates()}}else{token.setParseError()}}else{this.field(token);if(!token.isComplete()){this.oper(token);if(!token.isComplete()){if(token.getResult().getLastWasOperator()==="changed"){token.getResult().setNeedsLogicalOperator(token);return }this.operand(token);if(token.getResult().getOperandComplete()){var lastWasOperator=token.getResult().getLastWasOperator();token.getResult().setNeedsNothing();if(lastWasOperator){token.getResult().setLastWasOperator(lastWasOperator)}}else{if(token.isComplete()&&!token.getResult().getNeedsListComma()){token.getResult().setNeedsOperand()}}}else{if(token.getResult().getLastOperator()=="was"||token.getResult().getLastOperator()=="was not"){token.getResult().setNeedsOperandOrOperator()}else{if(token.getResult().getLastWasOperator()==="changed"){var currentChar=token.currentCharacter();if(currentChar!==null&&grammar.REGEXP_SPACE_OR_ELSE.test(currentChar)){token.getResult().setNeedsLogicalOperator(token)}else{token.getResult().resetLogicalOperators();token.getResult().setNeedsOrderBy(false)}return }else{token.getResult().setNeedsOperator()}}token.setParseError()}}else{token.getResult().setNeedsField();token.setParseError()}}},field:function(token){var fieldName=this.fieldName(token);if(fieldName.length!==0){token.getResult().setLastFieldName(fieldName,token)}else{if(token.getResult().getLastFieldName()===null){var remainingString=token.remainingString();token.getResult().setNeedsField();token.getResult().setLastFieldName(remainingString,token);token.setParseError()}}},fieldName:function(token){this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("cf",remainingString)){var origIdx=token.getTokenStringIdx();var origString=token.remainingString();token.consumeCharacters(2);this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("[",remainingString)){token.consumeCharacter();remainingString=token.remainingString();var custFieldId=this.numberValue(token);if(custFieldId.length!==0){this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("]",remainingString)){token.consumeCharacter();return origString.substring(0,token.getTokenStringIdx()-origIdx)}}}token.setParseError();return origString}else{if(this.startsWithIgnoreCase("issue.property",remainingString)){return this.entityPropertyName("issue.property",token)}else{return this.fieldOrFunctionName(token)}}},entityPropertyName:function(propertyPrefix,token){token.consumeCharacters(propertyPrefix.length);this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("[",remainingString)){token.consumeCharacter();var propertyKeys=[this.stringValue(token)];while(!token.parseError&&this.startsWithIgnoreCase(".",token.remainingString())){token.consumeCharacter();propertyKeys[propertyKeys.length]=this.stringValue(token)}if(propertyKeys.length!==0&&propertyKeys[0].length!==0&&!this.startsWithIgnoreCase(".",propertyKeys[0])){this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("]",remainingString)){token.consumeCharacter();var propertyPaths=[this.stringValue(token)];while(!token.parseError&&this.startsWithIgnoreCase(".",token.remainingString())){token.consumeCharacter();propertyPaths[propertyPaths.length]=this.stringValue(token)}return propertyPrefix+"["+propertyKeys.join(".")+"]"+propertyPaths.join(".")}}}token.setParseError();return""},oper:function(token){this.chewWhitespace(token);var remainingString=token.remainingString();var operator=this.getLongestOperatorMatch(remainingString,grammar.jql_operators);if(operator!==null){token.getResult().setLastOperator(operator,token.getTokenStringIdx());if(OperatorUtil.isWasOperator(operator)||OperatorUtil.isChangedOperator(operator)){token.getResult().setLastWasOperator(operator)}token.consumeCharacters(operator.length);if(operator=="in"||operator=="is"||operator=="is not"||operator=="not in"||operator=="was"||operator=="was not"||operator=="was in"||operator=="was not in"){var currentChar=token.currentCharacter();if(currentChar!==null&&!grammar.REGEXP_SPACE_OR_ELSE.test(currentChar)){token.setParseError()}}if(operator=="was"){token.getResult().setNeedsOperandOrOperator();this.chewWhitespace(token);remainingString=token.remainingString();if(remainingString!=null&&(grammar.REGEXP_NOTSTART.test(remainingString)||grammar.REGEXP_INSTART.test(remainingString))){token.setParseError()}}else{if(operator=="was not"){token.getResult().setNeedsOperandOrOperator();this.chewWhitespace(token);remainingString=token.remainingString();if(remainingString!=null&&(grammar.REGEXP_INSTART.test(remainingString))){token.setParseError()}}else{if(operator=="changed"){token.getResult().setNeedsLogicalOperator(token)}else{token.getResult().setNeedsOperand()}}}}else{if(token.getResult().getLastOperator()===null){var errorIdx=(remainingString===null)?token.getMaxTokenStringIdx():token.getMaxTokenStringIdx()-remainingString.length;token.getResult().setLastOperator(remainingString,errorIdx);token.getResult().setNeedsOperator();token.setParseError()}}},operand:function(token){this.chewWhitespace(token);if(token.getResult().getLastOperator()==="in"||token.getResult().getLastOperator()==="not in"||token.getResult().getLastOperator()==="was not in"||token.getResult().getLastOperator()==="was in"){token.getResult().setNeedsOpenParen(true)}var operand=this.listOperand(token,true);if(operand.length===0){operand=this.functionOperand(token);if(operand.length===0){operand=this.singleValueOperand(token)}else{token.getResult().setNeedsOpenParen(false)}}else{token.getResult().setNeedsOpenParen(false)}if(operand===null||operand.length===0){var remainingString=token.remainingString();token.getResult().setLastOperand(remainingString,token);token.getResult().setNeedsOperand();token.setParseError()}if(operand.length!==0){return operand}return""},singleValueOperand:function(token){var operand=this.stringValue(token);if(operand.length!==0){token.getResult().setLastOperand(operand,token);if(operand.toLowerCase()!="empty"&&operand.toLowerCase()!="null"&&this.isReservedWord(operand.toLowerCase())){token.setParseError()}return operand}return""},functionOperand:function(token){var startIdx=token.getTokenStringIdx();var functionName=this.fieldOrFunctionName(token);this.chewWhitespace(token);var listArguments=this.listOperand(token,false);if(functionName.length!==0&&listArguments.length!==0){var operand=functionName+listArguments;token.getResult().setLastOperand(operand,token);return operand}else{token.backTrackToIdx(startIdx);return""}},listOperand:function(token,treatAsOperands){if(token.currentCharacter()=="("){token.consumeCharacter();var listValue=this.collectListValues(token,treatAsOperands);var operandVal="("+listValue;this.chewWhitespace(token);if(token.currentCharacter()==")"){token.consumeCharacter();operandVal+=")";if(operandVal=="()"&&treatAsOperands){token.getResult().setLastOperand(operandVal,token)}if(treatAsOperands){token.getResult().setOperandComplete();token.getResult().resetNeedsPredicateOperand()}}else{token.setParseError()}return operandVal}else{return""}},collectListValues:function(token,treatAsOperands){if(treatAsOperands){token.getResult().setNeedsOperand()}this.chewWhitespace(token);var currentOperand=(treatAsOperands)?this.operand(token):this.stringValue(token);if(currentOperand.length!==0){if(this.chewWhitespace(token)&&treatAsOperands){token.getResult().setNeedsListComma()}if(token.currentCharacter()==","){token.consumeCharacter();var nextValue=this.collectListValues(token,treatAsOperands);if(nextValue.length===0){token.setParseError()}return currentOperand+", "+nextValue}else{return currentOperand}}else{return""}},startsWithIgnoreCase:function(startStr,str){if(str===null||startStr===null||str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}},startsWithLogicalOperator:function(str){if(str===null){return false}else{return this.startsWithOr(str)||this.startsWithAnd(str)||this.startsWithNot(str)||this.startsWithBraces(str)}},startsWithOr:function(str){return this.startsWithIgnoreCase("|",str)||this.startsWithIgnoreCase("||",str)||this.startsWithIgnoreCase("or",str)},startsWithAnd:function(str){return this.startsWithIgnoreCase("&",str)||this.startsWithIgnoreCase("&&",str)||this.startsWithIgnoreCase("and",str)},startsWithNot:function(str){return this.startsWithIgnoreCase("!",str)||this.startsWithIgnoreCase("not",str)},startsWithBraces:function(str){return this.startsWithIgnoreCase("(",str)||this.startsWithIgnoreCase(")",str)},chewWhitespace:function(token){var foundWhiteSpace=false;var currentChar=token.currentCharacter();while(currentChar!==null&&grammar.REGEXP_WHITESPACE.test(currentChar)){token.consumeCharacter();currentChar=token.currentCharacter();foundWhiteSpace=true}return foundWhiteSpace},getLongestOperatorMatch:function(value,listOfValues){var longestMatch=null;var matchArray;if(this.startsWithIgnoreCase("is",value)){matchArray=value.substring(2).match(grammar.REGEXP_SNOT);if(matchArray){longestMatch=value.substring(0,matchArray[0].length+2)}else{longestMatch="is"}}if(this.startsWithIgnoreCase("was",value)){matchArray=value.substring(3).match(grammar.REGEXP_SNOT_IN);if(matchArray){longestMatch=value.substring(0,matchArray[0].length+3)}else{longestMatch="was"}}else{if(this.startsWithIgnoreCase("not",value)){var matchArrayNot=value.substring(3).match(grammar.REGEXP_SIN);if(matchArrayNot){longestMatch=value.substring(0,matchArrayNot[0].length+3)}}else{for(var i=0;i<listOfValues.length;i++){if(this.startsWithIgnoreCase(listOfValues[i].value,value)){if(longestMatch===null||grammar.jql_operators[i].value.length>longestMatch){longestMatch=grammar.jql_operators[i].value}}}}}return longestMatch},getValueMinusExtraWhitespace:function(value){if(value===null){return null}var newValue="";var firstWhitespace=true;var valueArr=value.split("");for(var i=0;i<valueArr.length;i++){var currentChar=valueArr[i];if(grammar.REGEXP_WHITESPACE.test(currentChar)){if(firstWhitespace){firstWhitespace=false;newValue=newValue+currentChar}}else{firstWhitespace=true;newValue=newValue+currentChar}}return newValue},fieldOrFunctionName:function(token){var stringValue=this.stringValue(token);if(stringValue==='""'||stringValue==="''"){token.setParseError()}if(this.isReservedWord(stringValue.toLowerCase())){token.setParseError()}return stringValue},isReservedWord:function(word){return jQuery.inArray(word,jql_reserved_words)!==-1},stringValue:function(token){var stringValue="";var inQuote=false;var inSingleQuote=false;var currentChar=token.currentCharacter();while(currentChar!==null&&(inQuote||inSingleQuote||grammar.REGEXP_TOKEN_CHAR.test(currentChar))){stringValue=stringValue+currentChar;token.consumeCharacter();if(currentChar=="\\"){currentChar=token.currentCharacter();if(currentChar===null){token.setParseError();break}else{if(grammar.REGEXP_CHARS_TO_ESCAPE.test(currentChar)){var remainingString=token.remainingString();if(!grammar.REGEXP_UNICODE.test(remainingString)){token.setParseError();break}}}stringValue=stringValue+currentChar;token.consumeCharacter()}else{if(grammar.REGEXP_SPECIAL_CHAR.test(currentChar)&&!(inQuote||inSingleQuote)){token.setParseError();break}else{if(currentChar=='"'&&!inSingleQuote){inQuote=!inQuote}else{if(currentChar=="'"&&!inQuote){inSingleQuote=!inSingleQuote}}}}currentChar=token.currentCharacter()}if(token.isComplete()&&(inQuote||inSingleQuote)){token.setParseError()}return stringValue},numberValue:function(token){var numberVal="";this.chewWhitespace(token);var currentChar=token.currentCharacter();while(currentChar!==null){if(grammar.REGEXP_NUMBER.test(currentChar)){numberVal=numberVal+currentChar;token.consumeCharacter()}else{break}currentChar=token.currentCharacter()}return numberVal},wasPredicateComplete:function(predicate){var foundPredicate=false;var arLen=grammar.jql_changed_predicates.length;for(var i=0;i<arLen;++i){if(predicate.toLowerCase()==grammar.jql_changed_predicates[i].value.toLowerCase()){foundPredicate=true;break}}return foundPredicate}}}});define("jira/jql/jql-parse-result",function(){return function(){var tokens=[];var tokenIdx=0;return{getTokens:function(){return tokens},addToken:function(token){tokens[tokenIdx++]=token},setLastFieldName:function(lastFieldName,token){this.fieldNameStartIndex=(lastFieldName===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastFieldName.length);this.lastFieldName=this.getUnquotedString(lastFieldName);tokens[tokenIdx++]=lastFieldName},getLastFieldName:function(){return this.lastFieldName},getLastFieldNameStartIndex:function(){return this.fieldNameStartIndex},setLastOrderByFieldName:function(lastFieldName,token){this.orderByFieldNameStartIndex=(lastFieldName===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastFieldName.length);this.lastOrderByFieldName=this.getUnquotedString(lastFieldName);this.lastOrderByDirection=null;tokens[tokenIdx++]=lastFieldName},getLastOrderByFieldName:function(){return this.lastOrderByFieldName},getLastOrderByFieldNameStartIndex:function(){return this.orderByFieldNameStartIndex},setLastOrderByDirection:function(lastDirection,token){this.orderByDirectionStartIndex=(lastDirection===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastDirection.length);this.lastOrderByDirection=lastDirection;tokens[tokenIdx++]=lastDirection},getLastOrderByDirection:function(){return this.lastOrderByDirection},getLastOrderByDirectionStartIndex:function(){return this.orderByDirectionStartIndex},setNeedsField:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=true;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false;this.needsWasPredicate=false;this.lastWasOperator=null},getNeedsField:function(){return this.needsField},setNeedsOrderByField:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=true;this.needsOrderByDirection=false;this.lastOrderByDirection=null;this.needsListComma=false},getNeedsOrderByField:function(){return this.needsOrderByField},setNeedsOrderByDirection:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=true;this.needsListComma=false},getNeedsOrderByDirection:function(){return this.needsOrderByDirection},setNeedsOrderByComma:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},setNeedsListComma:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=true},getNeedsListComma:function(){return this.needsListComma},setLastOperator:function(lastOperator,startIndex){this.lastOperator=lastOperator;this.operatorStartIndex=startIndex;tokens[tokenIdx++]=lastOperator},setLastWasOperator:function(lastWasOperator){this.lastWasOperator=lastWasOperator},getLastWasOperator:function(){return this.lastWasOperator},getLastOperator:function(){return this.lastOperator},getLastOperatorStartIndex:function(){return this.operatorStartIndex},setLastOperand:function(lastOperand,token){this.operandStartIndex=(lastOperand===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastOperand.length);this.lastOperand=this.getUnquotedString(lastOperand);tokens[tokenIdx++]=lastOperand},getLastOperand:function(){return this.lastOperand},setNeedsOperand:function(){this.needsField=false;this.needsOperator=false;this.needsLogicalOperator=false;this.needsOperand=true;this.needsOrderBy=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},setNeedsOperandOrOperator:function(){this.needsField=false;this.needsOperator=true;this.needsLogicalOperator=false;this.needsOperand=true;this.needsOrderBy=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},getNeedsOperand:function(){return this.needsOperand},setNeedsPredicateOperand:function(){this.needsPredicateOperand=true},resetNeedsPredicateOperand:function(){this.needsPredicateOperand=false;this.needsOperand=false},getNeedsPredicateOperand:function(){return this.needsPredicateOperand},getLastOperandStartIndex:function(){return this.operandStartIndex},setLastOperandStartIndex:function(index){this.operandStartIndex=index},setLastLogicalOperator:function(lastLogicalOperator,startIndex){this.lastLogicalOperator=lastLogicalOperator;this.logicalOperatorStartIndex=startIndex;tokens[tokenIdx++]=lastLogicalOperator},setNeedsOperator:function(){this.needsField=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsOperator=true;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},getNeedsOperatorOrOperand:function(){return this.needsOperator&&this.needsOperand},getNeedsOperator:function(){return this.needsOperator},getLastLogicalOperator:function(){return this.lastLogicalOperator},getLastLogicalOperatorStartIndex:function(){return this.logicalOperatorStartIndex},setNeedsLogicalOperator:function(token){this.needsLogicalOperator=true;this.needsOperator=false;this.needsOperand=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false;this.needsOrderBy=!token.getInParens();if(this.lastWasOperator!=null){this.needsWasPredicate=true}},setNeedsOpenParen:function(value){this.needsOpenParen=value},getNeedsOpenParen:function(){return this.needsOpenParen},getNeedsLogicalOperator:function(){return this.needsLogicalOperator},setNeedsOrderBy:function(value){this.needsOrderBy=value},getNeedsOrderBy:function(){return this.needsOrderBy},getNeedsWasPredicate:function(){return this.needsWasPredicate},setLastWasPredicate:function(lastWasPredicate,token){this.wasPredicateStartIndex=(lastWasPredicate===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastWasPredicate.length);this.lastWasPredicate=lastWasPredicate;tokens[tokenIdx++]=lastWasPredicate},getLastWasPredicate:function(){return this.lastWasPredicate},resetLastPredicates:function(){this.lastLogicalOperator=null;this.lastWasPredicate=null;this.lastOperand=null;this.wasPredicateStartIndex=null;this.operandStartIndex=null},getLastWasPredicateStartIndex:function(){return this.wasPredicateStartIndex},setLastOrderBy:function(lastOrderBy,token){this.orderByStartIndex=(lastOrderBy===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastOrderBy.length);this.lastOrderBy=lastOrderBy;tokens[tokenIdx++]=lastOrderBy},getLastOrderBy:function(){return this.lastOrderBy},getLastOrderByStartIndex:function(){return this.orderByStartIndex},resetLogicalOperators:function(){this.lastLogicalOperator=null;this.logicalOperatorStartIndex=null;this.needsLogicalOperator=null},getUnquotedString:function(value){var secondToLastNotEsacape=value!=null&&value.length>=3&&value.charAt(value.length-2)!="\\";if(value!=null&&value.charAt(0)=='"'){value=value.substring(1,value.length);if(value.charAt(value.length-1)=='"'&&secondToLastNotEsacape){value=value.substring(0,value.length-1)}}else{if(value!=null&&value.charAt(0)=="'"){value=value.substring(1,value.length);if(value.charAt(value.length-1)=="'"&&secondToLastNotEsacape){value=value.substring(0,value.length-1)}}}return value},setParseError:function(message){this.parseError=true;this.parseErrorMsg=message},getParseError:function(){return this.parseError},getParseErrorMsg:function(){return this.parseErrorMsg},setNeedsNothing:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsOpenParen=false;this.needsListComma=false;this.needsWasPredicate=null;this.needsPredicateOperand=null;this.mustBeOperatorOrPredicate=null;this.lastWasOperator=null},setOperandComplete:function(){this.operandComplete=true},getOperandComplete:function(){return this.operandComplete},setMustBeOperatorOrPredicate:function(state){this.mustBeOperatorOrPredicate=state},getMustBeOperatorOrPredicate:function(){return this.mustBeOperatorOrPredicate},resetTerminalClause:function(){this.lastFieldName=null;this.fieldNameStartIndex=null;this.needsField=null;this.lastOperator=null;this.operatorStartIndex=null;this.needsOperator=null;this.lastOperand=null;this.operandStartIndex=null;this.needsOperand=null;this.operandComplete=null;this.needsOpenParen=null;this.needsListComma=false;this.mustBeOperatorOrPredicate=null},init:function(){this.lastFieldName=null;this.fieldNameStartIndex=null;this.needsField=null;this.lastOperator=null;this.operatorStartIndex=null;this.needsOperator=null;this.lastOperand=null;this.operandStartIndex=null;this.needsOperand=null;this.lastLogicalOperator=null;this.logicalOperatorStartIndex=null;this.lastOrderByFieldName=null;this.lastOrderByFieldNameStartIndex=null;this.lastOrderByDirection=null;this.lastOrderByDirectionStartIndex=null;this.orderByStartIndex=null;this.lastOrderBy=null;this.needsOrderBy=null;this.needsOrderByField=null;this.needsOrderByDirection=null;this.operandComplete=null;this.needsOpenParen=null;this.needsListComma=null;this.wasPredicateStartIndex=null;this.lastWasPredicate=null;this.needsWasPredicate=null;this.needsPredicateOperand=null;this.mustBeOperatorOrPredicate=null;this.lastWasOperator=null}}}});define("jira/jql/jql-parse-token",["jira/jql/jql-parse-result"],function(ParseResult){return function(){return{init:function(tokenString){this.tokenStringIdx=0;this.tokenString=tokenString;this.parseError=false;this.parseErrorMsg=null;this.result=ParseResult();this.result.init();this.inParens=0},consumeCharacter:function(){this.tokenStringIdx++},consumeCharacters:function(numChars){this.tokenStringIdx=this.tokenStringIdx+numChars},backTrackToIdx:function(backTrackIdx){this.tokenStringIdx=backTrackIdx;this.parseError=false;this.parseErrorMsg=null;this.result.parseError=false;this.result.parseErrorMsg=null},getTokenStringIdx:function(){return this.tokenStringIdx},currentCharacter:function(){if(this.tokenStringIdx>=this.tokenString.length){return null}return this.tokenString.charAt(this.tokenStringIdx)},remainingString:function(){if(this.tokenStringIdx>=this.tokenString.length){return null}return this.tokenString.substr(this.tokenStringIdx,this.tokenString.length)},getMaxTokenStringIdx:function(){return this.tokenString.length},isComplete:function(){if(this.parseError){return true}return this.tokenStringIdx>=this.tokenString.length},setInParens:function(){this.inParens++},setOutOfParens:function(){if(this.inParens!==0){this.inParens--}},getInParens:function(){return this.inParens!==0},setParseError:function(){this.parseError=true;var preFixIdx=((this.tokenStringIdx-9)<0)?0:this.tokenStringIdx-9;var errorPrefix=this.tokenString.substring(preFixIdx,this.tokenStringIdx-1);this.result.setParseError("..."+errorPrefix+"^"+this.tokenString.substring(this.tokenStringIdx,this.tokenString.length))},getParseError:function(){return this.parseError},calcLastOperandStartIndex:function(){var result=this.getResult();var operator=result.getLastOperator();if(operator.length>0){var numSpaces=operator.length-(operator.replace(/\s+/g,"")).length;result.setLastOperandStartIndex(result.getLastOperatorStartIndex()+operator.length+numSpaces+1)}},getParsedOperator:function(){var result=this.getResult();return(result.getLastOperator().length>0)?this.tokenString.substr(result.getLastOperatorStartIndex()):null},getResult:function(){return this.result}}}});AJS.namespace("jira.widget.autocomplete.JQL",null,require("jira/autocomplete/jql-autocomplete"));AJS.namespace("JIRA.JQLAutoComplete",null,require("jira/autocomplete/jql-autocomplete"));AJS.namespace("JIRA.JQLAutoComplete.MyParser",null,require("jira/jql/jql-parser"));AJS.namespace("JIRA.JQLAutoComplete.ParseResult",null,require("jira/jql/jql-parse-result"));AJS.namespace("JIRA.JQLAutoComplete.Token",null,require("jira/jql/jql-parse-token"));;
;/* module-key = 'jira.webresources:jqlautocomplete', location = '/includes/jira/autocomplete/initJQLAutoComplete.js' */
(function(){var JQLAutoComplete=require("jira/autocomplete/jql-autocomplete");var JQLParser=require("jira/jql/jql-parser");var Forms=require("jira/util/forms");var jQuery=require("jquery");jQuery(function(){jQuery(".jql-autocomplete-params").each(function(){var params={};jQuery(this).find("input").each(function(){var $this=jQuery(this);params[$this.attr("id")]=$this.val()});var jqlFieldNames=JSON.parse(jQuery("#jqlFieldz").text());var jqlFunctionNames=JSON.parse(jQuery("#jqlFunctionNamez").text());var jqlReservedWords=JSON.parse(jQuery("#jqlReservedWordz").text());var jqlAutoComplete=JQLAutoComplete({fieldID:"jqltext",parser:JQLParser(jqlReservedWords),queryDelay:0.65,jqlFieldNames:jqlFieldNames,jqlFunctionNames:jqlFunctionNames,minQueryLength:0,allowArrowCarousel:true,autoSelectFirst:false,errorID:"jqlerrormsg"});var jQueryRef=jQuery("#jqltext");jQueryRef.unbind("keypress",Forms.submitOnEnter).keypress(function(e){if(jqlAutoComplete.dropdownController===null||!jqlAutoComplete.dropdownController.displayed||jqlAutoComplete.selectedIndex<0){if(e.keyCode===13&&!e.ctrlKey&&!e.shiftKey){jQuery("#jqlform").submit();return false}else{return true}}});jqlAutoComplete.buildResponseContainer();jqlAutoComplete.parse(jQueryRef.text());jqlAutoComplete.updateColumnLineCount();jQueryRef.click(function(){jqlAutoComplete.dropdownController.hideDropdown()})})})})();;
;/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'js/issuelink-jira-jqlautocomplete.js' */
var IssueLinkJQLAutoComplete=IssueLinkJQLAutoComplete||(function($){function initialize(options){var fieldID=options.fieldID;var errorID=options.errorID;var autoCompleteUrl=options.autoCompleteUrl;var autoCompleteData=options.autoCompleteData;var formSubmitFunction=options.formSubmitFunction;var $field=$("#"+fieldID);var hasFocus=$field.length>0&&$field[0]==document.activeElement;var jqlFieldNames=autoCompleteData.visibleFieldNames||[];var jqlFunctionNames=autoCompleteData.visibleFunctionNames||[];var jqlReservedWords=autoCompleteData.jqlReservedWords||[];var jqlAutoComplete=JIRA.JQLAutoComplete({fieldID:fieldID,parser:JIRA.JQLAutoComplete.MyParser(jqlReservedWords),queryDelay:0.65,jqlFieldNames:jqlFieldNames,jqlFunctionNames:jqlFunctionNames,minQueryLength:0,allowArrowCarousel:true,autoSelectFirst:false,errorID:errorID,autoCompleteUrl:autoCompleteUrl});$field.unbind("keypress",submitOnEnter);if(formSubmitFunction){$field.keypress(function(e){if(jqlAutoComplete.dropdownController===null||!jqlAutoComplete.dropdownController.displayed||jqlAutoComplete.selectedIndex<0){if(e.keyCode==13&&!e.ctrlKey&&!e.shiftKey){formSubmitFunction();return false}else{return true}}})}jqlAutoComplete.buildResponseContainer();jqlAutoComplete.parse($field.text());jqlAutoComplete.updateColumnLineCount();$field.click(function(){jqlAutoComplete.dropdownController.hideDropdown()});if(hasFocus){$field.select()}}return{initialize:initialize}})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'js/issuelink-jira-search.js' */
AJS.$(function($){var remoteJiraSearchDialog=new JIRA.FormDialog({id:"remote-jira-search-dialog",trigger:"#link-jira-issue .remote-jira-search-trigger",widthClass:"large",content:function(render){render(JIRA.Templates.RemoteJiraIssueSearch.dialog());initSearchDialog(this.$popup)},submitHandler:function(e,callback){e.preventDefault();$("#simple-search-panel-button").removeAttr("disabled");$("#advanced-search-panel-button").removeAttr("disabled");if($(e.target).attr("id")=="remote-jira-simple-search-form"){$("#simple-search-panel-button").click()}else{$("#advanced-search-panel-button").click()}callback()}});function initSearchDialog($dialog){var appId=$("#jira-app-link").val();var autoCompletePromise=getJqlAutoCompleteData(appId);$("#simple-search-panel-button",$dialog).click(function(){$("#search-results-table",$dialog).empty();var searchText=$("#link-search-text",$dialog).val();searchText=$.trim(searchText);if(searchText){doSimpleSearch(searchText,$dialog)}else{AJS.messages.info("#search-results-table",{body:"Please enter search value.",closeable:false})}return false});$("#advanced-search-panel-button",$dialog).click(function(){advancedSearchButtonClick($dialog);return false});$("#simple-search-toggle",$dialog).click(function(){$("#remote-jira-simple-search-form",$dialog).show();$("#remote-jira-advanced-search-form",$dialog).hide();return false});$("#linkjiraissue-add-selected",$dialog).click(function(){$("table tbody tr:visible  td.selection input:checked",$dialog).each(function(){var issueKey=$(this).parent().data("key");$("#jira-issue-keys").trigger("selectOption",[{value:issueKey}])});$("#link-issue-dialog .error").hide();remoteJiraSearchDialog.hide();$("#link-issue-dialog").show().trigger("multiSelectRevealed");$("#jira-issue-keys-textarea").focus().select()});$("#advanced-search-toggle",$dialog).click(function(){$("#remote-jira-advanced-search-form",$dialog).show();$("#remote-jira-simple-search-form",$dialog).hide();var $jqlSearchText=$("#jql-search-text");if(!$jqlSearchText.attr("jql-initialized")){setAutoCompleteLoadingIconVisible(true,$dialog);autoCompletePromise.done(function(smartAjaxResult){if(smartAjaxResult.successful){IssueLinkJQLAutoComplete.initialize({fieldID:"jql-search-text",errorID:"jql-search-error",autoCompleteUrl:getAutoCompleteUrl(appId),autoCompleteData:smartAjaxResult.data,formSubmitFunction:function(){advancedSearchButtonClick($dialog)}})}else{setJQLErrorVisible(false,$dialog);setAutoCompleteFailedIconVisible(true,$dialog)}setAutoCompleteLoadingIconVisible(false,$dialog);$jqlSearchText.attr("jql-initialized",1)})}$jqlSearchText.focus();return false});$("#simple-search-toggle",$dialog).trigger("click")}function getAutoCompleteUrl(appId){if(appId&&appId!==""){return contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/autocomplete?appId="+appId}return""}function advancedSearchButtonClick($dialog){$("#search-results-table",$dialog).empty();var searchText=$("#jql-search-text",$dialog).val();searchText=$.trim(searchText);if(searchText){doAdvancedSearch(searchText,$dialog)}else{AJS.messages.info("#search-results-table",{body:"Please enter search value.",closeable:false})}}function setLoadingIconVisible(visible,$context){$("#link-search-loading",$context).toggleClass("hidden",!visible)}function setAutoCompleteLoadingIconVisible(visible,$context){$("#autocomplete-loading",$context).toggleClass("hidden",!visible)}function setAutoCompleteFailedIconVisible(visible,$context){$("#autocomplete-failed",$context).toggleClass("hidden",!visible)}function setJQLErrorVisible(visible,$context){$("#jql-search-error",$context).toggleClass("hidden",!visible)}function doSimpleSearch(searchText,$context){setLoadingIconVisible(true,$context);var appId=$("#jira-app-link").val();var issueKeyJql='key = "'+searchText+'"';var projectJql='project = "'+searchText+'"';var plainTextJql='summary ~ "'+searchText+'" OR description ~ "'+searchText+'" OR comment ~ "'+searchText+'"';jqlSearch(issueKeyJql,appId).done(function(smartAjaxResult){if(smartAjaxResult.successful&&smartAjaxResult.data.issues.length>0){setLoadingIconVisible(false,$context);showResults(smartAjaxResult,$context)}else{jqlSearch(projectJql,appId).done(function(smartAjaxResult){if(smartAjaxResult.successful&&smartAjaxResult.data.issues.length>0){setLoadingIconVisible(false,$context);showResults(smartAjaxResult,$context)}else{jqlSearch(plainTextJql,appId).done(function(smartAjaxResult){setLoadingIconVisible(false,$context);if(smartAjaxResult.successful){showResults(smartAjaxResult,$context)}else{showResultsError(smartAjaxResult)}})}})}})}function doAdvancedSearch(jql,$context){setLoadingIconVisible(true,$context);var appId=$("#jira-app-link").val();jqlSearch(jql,appId).done(function(smartAjaxResult){setLoadingIconVisible(false,$context);if(smartAjaxResult.successful){showResults(smartAjaxResult,$context)}else{if(smartAjaxResult.status===400){AJS.messages.warning("#search-results-table",{body:"Invalid JQL query.",closeable:false})}else{showResultsError(smartAjaxResult)}}})}function jqlSearch(jql,appId){var deferred=$.Deferred();var url;if(appId&&appId!==""){url=contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/search?jql="+jql+"&appId="+appId+"&maxResults=10"}else{var currentIssueKey=$("#current-issue-key").val();jql="("+jql+") and key != "+currentIssueKey;url=contextPath+"/rest/api/2/search?jql="+jql+"&maxResults=10"}JIRA.SmartAjax.makeRequest({url:url,complete:function(xhr,textStatus,smartAjaxResult){deferred.resolve(smartAjaxResult)}});return deferred.promise()}function getJqlAutoCompleteData(appId){var deferred=$.Deferred();var remote;var url;if(appId&&appId!==""){url=contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/autocompletedata?appId="+appId;remote=true}else{url=contextPath+"/rest/api/2/jql/autocompletedata";remote=false}JIRA.SmartAjax.makeRequest({url:url,complete:function(xhr,textStatus,smartAjaxResult){if(!smartAjaxResult.successful&&remote){JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/autocompletedata/legacy?appId="+appId,complete:function(xhr,textStatus,smartAjaxResult){deferred.resolve(smartAjaxResult)}})}else{deferred.resolve(smartAjaxResult)}}});return deferred.promise()}function showResults(smartAjaxResult,$context){var resultHtml=JIRA.Templates.RemoteJiraIssueSearch.resultsTable({result:smartAjaxResult.data});$("#search-results-table",$context).html(resultHtml);$("#linkjiraissue-select-all",$context).click(function(){var $masterStatus=$(this).prop("checked");$("tbody tr td.selection input",$context).prop("checked",$masterStatus)});$("tbody tr",$context).click(function(e){if($(e.target).is(":checkbox")){return }var checkbox=$(this).find("td.selection input");checkbox.prop("checked",!checkbox.prop("checked"))})}function showResultsError(smartAjaxResult){AJS.messages.error("#search-results-table",{body:JIRA.SmartAjax.buildSimpleErrorContent(smartAjaxResult),closeable:false})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'templates/dialog/linkjiraissue-search.soy' */
// This file was automatically generated from linkjiraissue-search.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.RemoteJiraIssueSearch == 'undefined') { JIRA.Templates.RemoteJiraIssueSearch = {}; }


JIRA.Templates.RemoteJiraIssueSearch.dialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Find JIRA issues"), '</h2><form class="aui search-form" id="remote-jira-simple-search-form" action="#" method="post"><div class="field-group"><label for="link-search-text">', soy.$$escapeHtml("Search"), ':</label><input id="link-search-text" type="text" tabindex="0" class="text" size="50"> <input type="submit" tabindex="0" class="button" id="simple-search-panel-button" value="', soy.$$escapeHtml("Search"), '"> <a id="advanced-search-toggle" href="#" title="', soy.$$escapeHtml("Perform a JQL search"), '">', soy.$$escapeHtml("Advanced Search"), '</a><span id="link-search-loading" class="icon loading throbber hidden"/></div></form><form class="aui search-form" id="remote-jira-advanced-search-form" action="#" method="post"><div class="field-group"><label for="jql-search-text">', soy.$$escapeHtml("JQL Search"), '<span id="autocomplete-loading" class="hidden"><span class="icon loading throbber"/>', soy.$$escapeHtml("Loading auto-complete"), '</span><span id="autocomplete-failed" class="hidden">', soy.$$escapeHtml("(auto-complete unavailable)"), '</span></label><div id="jql-search-container"><span id="jql-search-error" class="icon jqlgood" /><div class="atlassian-autocomplete"><textarea id="jql-search-text" class="text full-width-field" tabindex="0" /></div><button class="aui-button aui-button-primary search-button" id="advanced-search-panel-button" type="submit"><span class="aui-icon aui-icon-small aui-iconfont-search" title="', soy.$$escapeHtml("Search"), '"></span></button></div> <a id="simple-search-toggle" href="#" title="', soy.$$escapeHtml("Perform a plain text search"), '">', soy.$$escapeHtml("Simple Search"), '</a><span id="link-search-loading" class="icon loading throbber hidden"/></div></form><div class="message-panel hidden"></div><div id="search-results-table" class="data-table"></div><div class="buttons-container form-footer"><div class="buttons"><button type="button" class="aui-button" id="linkjiraissue-add-selected">', soy.$$escapeHtml("Add"), '</button><button class="aui-button aui-button-link cancel" href="#" id="remote-jira-link-cancel" title="', soy.$$escapeHtml("Press Esc to close"), '">', soy.$$escapeHtml("Close"), '</button></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.resultsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.result.issues.length > 0) {
    output.append('<table id="remote-jira-searchresult" class="aui"><thead><tr><th class="selection" ><input id="linkjiraissue-select-all" type="checkbox"/></th><th class="type">', soy.$$escapeHtml("Type"), '</th><th class="key">', soy.$$escapeHtml("Key"), '</th><th class="summary">', soy.$$escapeHtml("Summary"), '</th><th class="status">', soy.$$escapeHtml("Status"), '</th></tr></thead><tbody>');
    var issueList44 = opt_data.result.issues;
    var issueListLen44 = issueList44.length;
    for (var issueIndex44 = 0; issueIndex44 < issueListLen44; issueIndex44++) {
      var issueData44 = issueList44[issueIndex44];
      output.append('<tr title="', soy.$$escapeHtml(issueData44.key), '"><td class="selection" data-key="', soy.$$escapeHtml(issueData44.key), '"><input type="checkbox"/></td><td class="type">');
      JIRA.Templates.RemoteJiraIssueSearch.issueType({issueType: issueData44.fields.issuetype}, output);
      output.append('</td><td class="key" title="', soy.$$escapeHtml(issueData44.key), '">', soy.$$escapeHtml(issueData44.key), '</td><td class="summary" title="', soy.$$escapeHtml(issueData44.fields.summary), '">', soy.$$escapeHtml(issueData44.fields.summary), '</td><td class="status">');
      JIRA.Templates.RemoteJiraIssueSearch.status({status: issueData44.fields.status}, output);
      output.append('</td></tr>');
    }
    output.append('</tbody></table>');
  } else {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml("Search returned no results."), '</p></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.issueType = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<img src="', soy.$$escapeHtml(opt_data.issueType.iconUrl), '" alt="', soy.$$escapeHtml(opt_data.issueType.name), '" title="', soy.$$escapeHtml(opt_data.issueType.name), ' - ', soy.$$escapeHtml(opt_data.issueType.description), '"/>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.status = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Template.Util.Issue.Status.issueStatusResolver({issueStatus: opt_data.status}, output);
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.greenhopper-marketing-plugin:gh-advertising-resources', location = '/js/urls.js' */
;
;/* module-key = 'com.atlassian.jira.plugins.greenhopper-marketing-plugin:gh-advertising-resources', location = '/js/greenhopper-advertising.js' */
;
;/* module-key = 'com.atlassian.jira.plugins.greenhopper-marketing-plugin:gh-advertising-resources', location = '/js/greenhopper-installer.js' */
;
;/* module-key = 'com.atlassian.jira.plugins.greenhopper-marketing-plugin:gh-advertising-resources', location = '/js/greenhopper-advertising.soy' */
;
;/* module-key = 'com.atlassian.jira.plugins.greenhopper-marketing-plugin:gh-advertising-resources', location = '/js/greenhopper-installer.soy' */
;
;/* module-key = 'jira.webresources:field-templates', location = '/includes/jira/field/templates/singleUserPicker.soy' */
// This file was automatically generated from singleUserPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }
if (typeof JIRA.Templates.Fields.Pickers == 'undefined') { JIRA.Templates.Fields.Pickers = {}; }
if (typeof JIRA.Templates.Fields.Pickers.User == 'undefined') { JIRA.Templates.Fields.Pickers.User = {}; }


JIRA.Templates.Fields.Pickers.User.single = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select id="', soy.$$escapeHtml(opt_data.field.id), '" name="', soy.$$escapeHtml(opt_data.field.name), '" class="single-user-picker js-', (opt_data.type) ? soy.$$escapeHtml(opt_data.type) : 'default-user-picker', '"', (opt_data.inputText) ? ' data-input-text="' + soy.$$escapeHtml(opt_data.inputText) + '"' : '', (opt_data.editValue) ? ' data-edit-value="' + soy.$$escapeHtml(opt_data.editValue) + '"' : '', (opt_data.showDropdownButton) ? ' data-show-dropdown-button="true"' : '', (opt_data.userType) ? ' data-user-type="' + soy.$$escapeHtml(opt_data.userType) + '"' : '', (opt_data.containerClass) ? ' data-container-class="' + soy.$$escapeHtml(opt_data.containerClass) + '"' : '', '>');
  var optionList38 = opt_data.options;
  var optionListLen38 = optionList38.length;
  for (var optionIndex38 = 0; optionIndex38 < optionListLen38; optionIndex38++) {
    var optionData38 = optionList38[optionIndex38];
    if (optionData38.optionGroup) {
      output.append('<optgroup id="', soy.$$escapeHtml(opt_data.field.id), '-group-', soy.$$escapeHtml(optionData38.id), '" label="', soy.$$escapeHtml(optionData38.display), '"', (optionData38.footer) ? ' data-footer-text="' + soy.$$escapeHtml(optionData38.footer) + '"' : '', (optionData38.weight != -1) ? ' data-weight="' + soy.$$escapeHtml(optionData38.weight) + '"' : '', '>');
      var groupOptionList59 = optionData38.groupOptions;
      var groupOptionListLen59 = groupOptionList59.length;
      for (var groupOptionIndex59 = 0; groupOptionIndex59 < groupOptionListLen59; groupOptionIndex59++) {
        var groupOptionData59 = groupOptionList59[groupOptionIndex59];
        JIRA.Templates.Fields.Pickers.User.option(groupOptionData59, output);
      }
      output.append('</optgroup>');
    } else {
      JIRA.Templates.Fields.Pickers.User.option(optionData38, output);
    }
  }
  output.append('</select>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.Pickers.User.option = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option ', (opt_data.loggedInUser) ? 'class="current-user" ' : '', (opt_data.selected) ? 'selected="selected" ' : '', 'value="', soy.$$escapeHtml(opt_data.optionName), '" data-field-text="', soy.$$escapeHtml(opt_data.displayName), '" data-field-label="', soy.$$escapeHtml(opt_data.displayName), (opt_data.optionName && opt_data.optionName != '-1') ? ' - ' + soy.$$escapeHtml(opt_data.emailAddress) + ' (' + soy.$$escapeHtml(opt_data.optionName) + ')' : '', '" data-icon="', soy.$$escapeHtml(opt_data.avatarURL), '" >', soy.$$escapeHtml(opt_data.displayName), '</option>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'jira.webresources:field-templates', location = '/includes/jira/field/templates/assigneeField.soy' */
// This file was automatically generated from assigneeField.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }
if (typeof JIRA.Templates.Fields.Pickers == 'undefined') { JIRA.Templates.Fields.Pickers = {}; }
if (typeof JIRA.Templates.Fields.Pickers.User == 'undefined') { JIRA.Templates.Fields.Pickers.User = {}; }


JIRA.Templates.Fields.Pickers.User.assignee = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Fields.Pickers.User.single(soy.$$augmentData(opt_data, {options: opt_data.assigneeOptions.options, showDropdownButton: true, userType: 'assignee', type: 'assignee-picker', containerClass: 'long-field'}), output);
  output.append((opt_data.isLoggedInUserAssignable) ? '<a href="#' + soy.$$escapeHtml(opt_data.field.id) + '" id="assign-to-me-trigger">' + soy.$$escapeHtml("Assign to me") + '</a>' : '', '<fieldset class="hidden parameters"><input type="hidden" title="projectKeys" value="', soy.$$escapeHtml(opt_data.projectKeys), '"/>', (opt_data.issueKey) ? '<input type="hidden" title="assigneeEditIssueKey" value="' + soy.$$escapeHtml(opt_data.issueKey) + '"/>' : '', (opt_data.actionDescriptorId) ? '<input type="hidden" title="actionDescriptorId" value="' + soy.$$escapeHtml(opt_data.actionDescriptorId) + '"/>' : '', '</fieldset>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/lib/jquery.dotdotdot-1.5.7.js' */
(function(i){if(i.fn.dotdotdot){return}i.fn.dotdotdot=function(v){if(this.length==0){if(!v||v.debug!==false){b(true,'No element found for "'+this.selector+'".')}return this}if(this.length>1){return this.each(function(){i(this).dotdotdot(v)})}var r=this;if(r.data("dotdotdot")){r.trigger("destroy.dot")}r.bind_events=function(){r.bind("update.dot",function(y,A){y.preventDefault();y.stopPropagation();t.maxHeight=(typeof t.height=="number")?t.height:o(r);t.maxHeight+=t.tolerance;if(typeof A!="undefined"){if(typeof A=="string"||A instanceof HTMLElement){A=i("<div />").append(A).contents()}if(A instanceof i){w=A}}s=r.wrapInner('<div class="dotdotdot" />').children();s.empty().append(w.clone(true)).css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var z=false,x=false;if(q.afterElement){z=q.afterElement.clone(true);q.afterElement.remove()}if(k(s,t)){if(t.wrap=="children"){x=d(s,t,z)}else{x=m(s,r,s,t,z)}}s.replaceWith(s.contents());s=null;if(i.isFunction(t.callback)){t.callback.call(r[0],x,w)}q.isTruncated=x;return x}).bind("isTruncated.dot",function(y,x){y.preventDefault();y.stopPropagation();if(typeof x=="function"){x.call(r[0],q.isTruncated)}return q.isTruncated}).bind("originalContent.dot",function(y,x){y.preventDefault();y.stopPropagation();if(typeof x=="function"){x.call(r[0],w)}return w}).bind("destroy.dot",function(x){x.preventDefault();x.stopPropagation();r.unwatch().unbind_events().empty().append(w).data("dotdotdot",false)});return r};r.unbind_events=function(){r.unbind(".dot");return r};r.watch=function(){r.unwatch();if(t.watch=="window"){var z=i(window),y=z.width(),x=z.height();z.bind("resize.dot"+q.dotId,function(){if(y!=z.width()||x!=z.height()||!t.windowResizeFix){y=z.width();x=z.height();if(p){clearInterval(p)}p=setTimeout(function(){r.trigger("update.dot")},10)}})}else{u=j(r);p=setInterval(function(){var A=j(r);if(u.width!=A.width||u.height!=A.height){r.trigger("update.dot");u=j(r)}},100)}return r};r.unwatch=function(){i(window).unbind("resize.dot"+q.dotId);if(p){clearInterval(p)}return r};var w=r.contents(),t=i.extend(true,{},i.fn.dotdotdot.defaults,v),q={},u={},p=null,s=null;q.afterElement=c(t.after,r);q.isTruncated=false;q.dotId=l++;r.data("dotdotdot",true).bind_events().trigger("update.dot");if(t.watch){r.watch()}return r};i.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",lastCharacter:{remove:[" ",",",";",".","!","?"],noEllipsis:[]},tolerance:0,callback:null,after:null,height:null,watch:false,windowResizeFix:true,debug:false};var l=1;function d(s,w,v){var u=s.children(),p=false;s.empty();for(var r=0,q=u.length;r<q;r++){var t=u.eq(r);s.append(t);if(v){s.append(v)}if(k(s,w)){t.remove();p=true;break}else{if(v){v.remove()}}}return p}function m(s,r,A,t,q){var w=s.contents(),x=false;s.empty();var z="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, select, optgroup, option, textarea, script, style";for(var y=0,u=w.length;y<u;y++){if(x){break}var v=w[y],p=i(v);if(typeof v=="undefined"){continue}s.append(p);if(q){s[(s.is(z))?"after":"append"](q)}if(v.nodeType==3){if(k(A,t)){x=e(p,r,A,t,q)}}else{x=m(p,r,A,t,q)}if(!x){if(q){q.remove()}}}return x}function e(q,r,p,w,s){var D=false,A=q[0];if(typeof A=="undefined"){return false}var E=(w.wrap=="letter")?"":" ",t=h(A).split(E),F=-1,v=-1,G=0,y=t.length-1;while(G<=y){var x=Math.floor((G+y)/2);if(x==v){break}v=x;a(A,t.slice(0,v+1).join(E)+w.ellipsis);if(!k(p,w)){F=v;G=v}else{y=v}}if(F!=-1&&!(t.length==1&&t[0].length==0)){var u=f(t.slice(0,F+1).join(E),w);D=true;a(A,u)}else{var z=q.parent();q.remove();var C=(s)?s.length:0;if(z.contents().size()>C){var B=z.contents().eq(-1-C);D=e(B,r,p,w,s)}else{var A=z.prev().contents().eq(-1)[0];if(typeof A!="undefined"){var u=f(h(A),w);a(A,u);z.remove();D=true}}}return D}function k(q,p){return q.innerHeight()>p.maxHeight}function f(p,q){while(i.inArray(p.slice(-1),q.lastCharacter.remove)>-1){p=p.slice(0,-1)}if(i.inArray(p.slice(-1),q.lastCharacter.noEllipsis)<0){p+=q.ellipsis}return p}function j(p){return{width:p.innerWidth(),height:p.innerHeight()}}function a(q,p){if(q.innerText){q.innerText=p}else{if(q.nodeValue){q.nodeValue=p}else{if(q.textContent){q.textContent=p}}}}function h(p){if(p.innerText){return p.innerText}else{if(p.nodeValue){return p.nodeValue}else{if(p.textContent){return p.textContent}else{return""}}}}function c(p,q){if(typeof p=="undefined"){return false}if(!p){return false}if(typeof p=="string"){p=i(p,q);return(p.length)?p:false}if(typeof p=="object"){return(typeof p.jquery=="undefined")?false:p}return false}function o(s){var t=s.innerHeight(),r=["paddingTop","paddingBottom"];for(var u=0,q=r.length;u<q;u++){var p=parseInt(s.css(r[u]),10);if(isNaN(p)){p=0}t-=p}return t}function b(q,p){if(!q){return false}if(typeof p=="string"){p="dotdotdot: "+p}else{p=["dotdotdot:",p]}if(typeof window.console!="undefined"){if(typeof window.console.log!="undefined"){window.console.log(p)}}return false}var n=i.fn.html;i.fn.html=function(p){if(typeof p!="undefined"){if(this.data("dotdotdot")){if(typeof p!="function"){return this.trigger("update",[p])}}return n.call(this,p)}return n.call(this)};var g=i.fn.text;i.fn.text=function(q){if(typeof q!="undefined"){if(this.data("dotdotdot")){var p=i("<div />");p.text(q);q=p.html();p.remove();return this.trigger("update",[q])}return g.call(this,q)}return g.call(this)}})(jQuery);;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/DialogController.js' */
JPT={};(function(){JPT.DialogControllerImpl=Class.extend({WELCOME_REST_URL:AJS.contextPath()+"/rest/welcome/1.0/show/welcome",initialize:function(){_.bindAll(this,"handleProjectTemplateTriggered","openWithSelectedProjectTemplate","hideDialogFromNewUser");if(AJS.Meta.getBoolean("show-welcome-screen")){this.handleProjectTemplateTriggered()}},handleProjectTemplateTriggered:function(){this.openWithSelectedProjectTemplate()},openWithSelectedProjectTemplate:function(b){if(b&&this.dialog){this.dialog.remove()}var a=JPT.SelectProjectTemplateController.loadProjectTemplatesData();a.fail(_.bind(function(c){if(c.status===401&&c.responseText.toLowerCase().indexOf("requires websudo")>=0){this._enableWebSudo()}else{this._handleUnknownErrorOfPTRetrieval()}},this));a.done(_.bind(function(c){this.dialog=JPT.DialogView.draw();this.$dialogElement=this.dialog.popup.element;var d;if(!_.isUndefined(JPT.ConfigModel)&&!_.isUndefined(JPT.ConfigModel.selectedTemplate)){d=JPT.ConfigModel.selectedTemplate}JPT.ConfigModel=c;JPT.ConfigModel.selectedTemplate=d;JPT.SelectProjectTemplateController.init(c.projectTemplates,b)},this))},addPage:function(c){var b=this.dialog.addPage(c.name).page[this.dialog.curpage];this.dialog.addHeader(c.title,"add-project-dialog-header");this.dialog.addPanel(c.panelName,"","pt-content");if(c.backButton){this._addBackButton(b)}this.dialog.addButton(c.submitButtonText,c.submitButtonCallback,c.submitButtonClass+" pt-submit-button");var a=this.$dialogElement.find("."+c.submitButtonClass);a.removeClass("button-panel-button").addClass("aui-button aui-button-primary");a.focus();this.dialog.addCancel("Cancel",_.bind(function(d){this.hideDialogFromNewUser("dismissed");this.dialog.remove()},this));return b},_addBackButton:function(b){this.dialog.addButton("Back",_.bind(function(){var c=JPT.DialogView.get$PTContent();c.css("background-image","none");this.dialog.prevPage();b.remove();this.dialog.page.pop()},this),"add-project-back-button");var a=this.$dialogElement.find(".add-project-back-button");a.removeClass("button-panel-button").addClass("aui-button")},_enableWebSudo:function(){JIRA.SmartAjax.showWebSudoDialog({success:_.bind(function(a){this.handleProjectTemplateTriggered();a()},this)})},_handleUnknownErrorOfPTRetrieval:function(){JPT.DialogView.draw();JPT.DialogView.showErrorMessage("An error occurred while trying to contact JIRA")},hideDialogFromNewUser:function(a){if(AJS.Meta.getBoolean("show-welcome-screen")){AJS.$.ajax({url:this.WELCOME_REST_URL+"/"+a,type:"DELETE",success:function(){if(AJS.isDevMode&&AJS.isDevMode()){AJS.log("don't show project template dialog anymore")}}})}}});JPT.DialogController=new JPT.DialogControllerImpl()})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/DialogView.js' */
(function(){JPT.DialogViewImpl=Backbone.View.extend({events:{"click   .add-project-trigger":"_onClickAddProject","click   #add-project-dialog .import-project-trigger":"_onClickImportProject","keydown #add-project-dialog .pt-templates-list":"_onKeydownInTemplatesList"},draw:function(){var b=new AJS.Dialog({width:840,height:400,id:"add-project-dialog",closeOnOutsideClick:false,keypressListener:_.bind(this._onKeyPressed,this)});var c=b.popup.element;b.addPage("project-templates-page");b.addHeader("Select Project Type","add-project-dialog-header");b.addPanel("ProjectTemplatesListPanel",JIRA.Templates.ProjectTemplates.loadingTemplatesList(),"pt-content");this._dialog=b;this._$dialogElement=c;b.show();return b},remove:function(){this._dialog&&this._dialog.remove()},showErrorMessage:function(b){this._dialog.getPanel(1,0).html(JIRA.Templates.errorMsg({closable:false,msg:b}))},get$PTContent:function a(){return JPT.DialogController.$dialogElement.find(".pt-content")},_onKeyPressed:function(c){var b=27;if(this._dialog){if(c.keyCode===b){JPT.DialogController.hideDialogFromNewUser("dismissed");this._dialog.remove();return false}}return true},_onKeydownInTemplatesList:function(c){var b=13;if(this._dialog){if(c.keyCode===b){this._$dialogElement.find(".pt-submit-button:visible").click();return false}}return true},_onClickAddProject:function(b){b.preventDefault();JPT.DialogController.handleProjectTemplateTriggered()},_onClickImportProject:function(b){JPT.DialogController.hideDialogFromNewUser("importproject")}});JPT.DialogView=new JPT.DialogViewImpl({el:AJS.$(document)})})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/SelectProjectTemplateController.js' */
JPT.SelectProjectTemplateController={};JPT.SelectProjectTemplateController.init=function init(b,a){JPT.DialogController.dialog.hide();JPT.SelectProjectTemplateView.draw(b);if(a){var c=_.find(b,function(d){return d.itemModuleCompleteKey===a});if(!_.isUndefined(c)){JPT.SelectProjectTemplateController.openAddProjectPage(c)}else{JPT.DialogView.showErrorMessage("Unable to find the template you were redirected to.");JPT.SelectProjectTemplateView.disableNextButton()}}JPT.DialogController.dialog.show();JPT.DialogController.dialog.updateHeight();JPT.SelectProjectTemplateView.truncateTemplateDescriptions()};JPT.SelectProjectTemplateController.loadProjectTemplatesData=function loadProjectTemplatesData(){return AJS.$.ajax({url:contextPath+"/rest/project-templates/1.0/templates",type:"GET",timeout:5000})};JPT.SelectProjectTemplateController.dialogSubmitted=function dialogSubmitted(){var a=JPT.SelectProjectTemplateView.getSelectedTemplateData();JPT.DialogController.hideDialogFromNewUser("templateselected");JPT.SelectProjectTemplateController.raiseAtlassianEvent(a.itemModuleCompleteKey);if(!_.isUndefined(a.infoSoyPath)){JPT.TemplateInfoController=new JPT.TemplateInfoControllerImpl();JPT.TemplateInfoController.initTemplateInfo(a)}else{JPT.SelectProjectTemplateController.openAddProjectPage(a)}};JPT.SelectProjectTemplateController.openAddProjectPage=function openAddProjectPage(a){if(!a){JPT.DialogView.showErrorMessage("An error occurred while trying to contact JIRA");return}if(a.createProject){JPT.AddProjectController.initProjectTemplate(a)}else{JPT.DialogController.dialog.addPage("blank-template-page");AJS.$("body").trigger(a.itemModuleCompleteKey,JPT.DialogController.dialog)}};JPT.SelectProjectTemplateController.raiseAtlassianEvent=function raiseAtlassianEvent(a){JPT.ConfigModel.selectedTemplate=a;if(AJS.EventQueue){AJS.EventQueue.push({name:"projecttemplates.templateselected",properties:{selectedTemplate:a}})}};;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/SelectProjectTemplateView.js' */
JPT.SelectProjectTemplateView={};JPT.SelectProjectTemplateView.ROW_LENGTH=2;JPT.SelectProjectTemplateView.draw=function draw(b){this.page=JPT.DialogController.addPage({name:"project-templates-page",title:"Select Project Type",panelName:"ProjectTemplatesListPanel",backButton:false,submitButtonText:"Next",submitButtonCallback:JPT.SelectProjectTemplateController.dialogSubmitted,submitButtonClass:"create-project-dialog-create-button"});JPT.DialogController.dialog.getPanel(this.page.id,0).html(JIRA.Templates.ProjectTemplates.renderList({projectTemplates:b}));if(JPT.ConfigModel.projectCount>=2){AJS.$(JIRA.Templates.ProjectTemplates.addWorkflowsLink({baseUrl:contextPath})).appendTo(JPT.DialogController.$dialogElement.find(".dialog-title"))}var c=JPT.DialogController.$dialogElement.find(".create-project-dialog-create-button");JPT.DialogController.$dialogElement.find(".template").click(function(){var d=AJS.$(this);d.addClass("selected").siblings().removeClass("selected")}).dblclick(function(d){c.click()}).focus(function(){AJS.$(this).click()});var a=JPT.SelectProjectTemplateView.get$TemplatesContainer();AJS.$(JIRA.Templates.ProjectTemplates.importProjectLink({baseUrl:contextPath})).prependTo(JPT.DialogController.$dialogElement.find(".dialog-button-panel"));JPT.SelectProjectTemplateView.bindKeyboardEvents(a);if(b.length==0){c.attr("disabled","disabled")}JPT.SelectProjectTemplateView.focusOnFirstTemplate(a)};JPT.SelectProjectTemplateView.get$TemplatesContainer=function getTemplatesContainer(){return JPT.DialogController.$dialogElement.find(".templates")};JPT.SelectProjectTemplateView.focusOnFirstTemplate=function focusOnFirstTemplate(a){JPT.DialogController.$dialogElement.find(".template:first-child").click();setTimeout(function(){a.focus()},0)};JPT.SelectProjectTemplateView.getSelectedTemplateData=function getSelectedTemplateData(){var a=JPT.DialogController.$dialogElement.find(".template.selected");return a.data()};JPT.SelectProjectTemplateView.getMoveDeltaForKey=function(a){switch(a){case 37:return -1;case 39:return +1;case 38:return -JPT.SelectProjectTemplateView.ROW_LENGTH;case 40:return +JPT.SelectProjectTemplateView.ROW_LENGTH}return 0};JPT.SelectProjectTemplateView.bindKeyboardEvents=function(a){a.bind("keydown",function(b){var c=JPT.SelectProjectTemplateView.getMoveDeltaForKey(b.which);if(c){JPT.SelectProjectTemplateView.moveSelection(a,c);return AJS.stopEvent(b)}})};JPT.SelectProjectTemplateView.moveSelection=function(c,f){var b=c.find(".template");var e=b.filter(".selected");var d=b.index(e)+f;if(d<b.length&&d>=0){var a=b.eq(d);a.click().focus();JPT.SelectProjectTemplateView.scrollToSelectedElement(a)}};JPT.SelectProjectTemplateView.scrollToSelectedElement=function scrollToSelectedElement(c){var f=AJS.$(".dialog-panel-body.pt-content");var a=f.offset().top;var b=c.offset().top;var e=b+c.height();var d=a+f.height();if(b<a){f.scrollTop(f.scrollTop()-(a-b))}else{if(e>(a+f.height())){f.scrollTop(f.scrollTop()+e-d)}}};JPT.SelectProjectTemplateView.get$NextButton=function getNextButton(){return JPT.DialogController.$dialogElement.find(".create-project-dialog-create-button")};JPT.SelectProjectTemplateView.disableNextButton=function disableNextButton(){JPT.SelectProjectTemplateView.get$NextButton().attr("disabled","disabled")};JPT.SelectProjectTemplateView.truncateTemplateDescriptions=function truncateTemplateDescriptions(){var a=AJS.Meta.get("user-locale");var b="word";if(a==="ja_JP"){b="letter"}JPT.DialogController.$dialogElement.find(".template-description").each(function(){AJS.$(this).dotdotdot({wrap:b,lastCharacter:{remove:[" ",",",";",".","!","?","。"],noEllipsis:[]}})})};;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/soy/ProjectTemplatesList.soy' */
// This file was automatically generated from ProjectTemplatesList.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }


JIRA.Templates.ProjectTemplates.renderList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.projectTemplates.length == 0) {
    JIRA.Templates.errorMsg({closeable: false, msg: "No project templates could be found."}, output);
  } else {
    output.append('<div class="pt-templates-list">');
    JIRA.Templates.ProjectTemplates.renderItems(opt_data, output);
    output.append('</div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.renderItems = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ol class="templates" tabindex="100">');
  var templateList15 = opt_data.projectTemplates;
  var templateListLen15 = templateList15.length;
  for (var templateIndex15 = 0; templateIndex15 < templateListLen15; templateIndex15++) {
    var templateData15 = templateList15[templateIndex15];
    output.append('<li class="template"', (templateData15.itemModuleCompleteKey) ? 'data-item-module-complete-key="' + soy.$$escapeHtml(templateData15.itemModuleCompleteKey) + '"' : '', (templateData15.projectTemplateModuleCompleteKey) ? 'data-project-template-module-complete-key="' + soy.$$escapeHtml(templateData15.projectTemplateModuleCompleteKey) + '"' : '', (templateData15.createProject) ? 'data-create-project="' + soy.$$escapeHtml(templateData15.createProject) + '"' : '', (templateData15.backgroundIconUrl) ? 'data-background-icon-url="' + soy.$$escapeHtml(templateData15.backgroundIconUrl) + '"' : '', (templateData15.name) ? 'data-name="' + soy.$$escapeHtml(templateData15.name) + '"' : '', (templateData15.description) ? 'data-description="' + soy.$$escapeHtml(templateData15.description) + '"' : '', (templateData15.longDescriptionContent) ? 'data-long-description-content="' + soy.$$escapeHtml(templateData15.longDescriptionContent) + '"' : '', (templateData15.infoSoyPath) ? 'data-info-soy-path="' + soy.$$escapeHtml(templateData15.infoSoyPath) + '"' : '', '><img class="template-preview" src="', soy.$$escapeHtml(templateData15.iconUrl), '" /><div class="template-meta"><div class="template-name" title="', soy.$$escapeHtml(templateData15.name), '">', soy.$$escapeHtml(templateData15.name), '</div><div class="template-description" title="', soy.$$escapeHtml(templateData15.description), '">', soy.$$escapeHtml(templateData15.description), '</div></div></li>');
  }
  output.append('</ol>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.loadingTemplatesList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="wait-container"><img class="wait-icon" src="', soy.$$escapeHtml("/j"), '/images/icons/wait.gif"><span class="wait-text">', soy.$$escapeHtml("Loading project templates"), '&hellip;</span></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.importProjectLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="import-project-trigger button-panel-link" href="', soy.$$escapeHtml(opt_data.baseUrl), '/secure/admin/views/ExternalImport1.jspa" tabindex="-1">', soy.$$escapeHtml("Import from external system"), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.addWorkflowsLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="add-workflow-link" href="', soy.$$escapeHtml(opt_data.baseUrl), '/plugins/servlet/wfshare-import?src=projecttemplates" tabindex="-1">', soy.$$escapeHtml("View Marketplace Workflows"), '</a>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/TemplateInfoController.js' */
(function(){JPT.TemplateInfoControllerImpl=Class.extend({init:function(a){_.bindAll(this,"initTemplateInfo","next")},initTemplateInfo:function(a){this.projectTemplateData=a;JPT.TemplateInfoView=new JPT.TemplateInfoViewImpl();JPT.TemplateInfoView.draw(a.infoSoyPath,a.name)},next:function(){JPT.SelectProjectTemplateController.openAddProjectPage(this.projectTemplateData)}})})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/TemplateInfoView.js' */
(function(){JPT.TemplateInfoViewImpl=Backbone.View.extend({initialize:function(a){_.bindAll(this,"draw","onNext")},draw:function(c,b){var d=JPT.DialogController.addPage({name:"template-info",title:b,panelName:"template-info",backButton:true,submitButtonText:"Select",submitButtonCallback:this.onNext,submitButtonClass:"template-info-dialog-create-button"});var a=this._nameToObj(c)();JPT.DialogController.dialog.getPanel(d.id,0).html(a);JPT.DialogController.dialog.gotoPage(d.id)},_nameToObj:function(a){return _.reduce(a.split("."),function(c,b){if(c){return c[b]}},window)},onNext:function(a){JPT.TemplateInfoController.next();return false}})})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/AddProjectController.js' */
(function(){JPT.AddProjectControllerImpl=Class.extend({postProjectCreationCallbacks:[],projectKeyValidationCallbacks:[],projectNamesUpperCased:[],init:function(g){this._window=g.window||window;_.bindAll(this,"projectCreatedHandler","projectValidationFailedHandler","nameTimeout","keyTimeout","submit")},initProjectTemplate:function(g){this.desiredKeyLength=4;this.lastKeyValidated="";this._getExistingProjects();JPT.ProjectKeyGenerator.init(this.desiredKeyLength,JPT.ConfigModel.maxKeyLength);this.webItemData=g;JPT.AddProjectView.prepareDialog(g.name);JPT.AddProjectView.draw({webItemData:this.webItemData,maxKeyLength:JPT.ConfigModel.maxKeyLength,maxNameLength:JPT.ConfigModel.maxNameLength,currentUserName:JPT.ConfigModel.currentUserName,currentUserDisplayName:JPT.ConfigModel.currentUserDisplayName,currentUserAvatarUrl:JPT.ConfigModel.currentUserAvatarUrl,errors:{}})},_resetProjectLeadValues:function(){JPT.ConfigModel.currentUserDisplayName="";JPT.ConfigModel.currentUserName="";JPT.ConfigModel.currentUserAvatarUrl=""},_hasFullyConfiguredProjectLead:function(){return JPT.AddProjectView.getLeadDisplayName()&&JPT.AddProjectView.getAvatarUrlOfSelectedLead()!=""},submit:function(g){var h=JPT.AddProjectView.getAddProjectForm().serialize();if(JPT.AddProjectView.hasInlineErrors()){return}if(JPT.AddProjectView.enterLoadingState()){if(this._hasFullyConfiguredProjectLead()){JPT.ConfigModel.currentUserDisplayName=JPT.AddProjectView.getLeadDisplayName();JPT.ConfigModel.currentUserName=JPT.ConfigModel.currentUserDisplayName?JPT.AddProjectView.getLeadUserName():"";JPT.ConfigModel.currentUserAvatarUrl=JPT.AddProjectView.getAvatarUrlOfSelectedLead()}else{this._resetProjectLeadValues()}var i=AJS.$.ajax({url:contextPath+"/rest/project-templates/1.0/templates",type:"POST",data:h,timeout:50000,headers:{"X-Atlassian-Token":"nocheck"}});i.then(this.projectCreatedHandler,this.projectValidationFailedHandler)}},registerPostProjectCreationCallback:function(g){this.postProjectCreationCallbacks.push(g)},registerProjectKeyValidationCallback:function(g){this.projectKeyValidationCallbacks.push(g)},localStoragePrefix:"jira.projecttemplates.",projectCreatedHandler:function(h){JPT.AddProjectView.avoidDirtyFormWarning();var g=this.localStoragePrefix;var i=["confluenceProject","fisheyeProject","crucibleProject","bambooProject"];_.map(i,function(j){if(h.remoteProjectLinks[j]){localStorage.setItem(g+j,h.remoteProjectLinks[j])}});if(!_.isEmpty(this.postProjectCreationCallbacks)){JPT.DialogController.dialog.addPage("post-project-created-page");_.each(this.postProjectCreationCallbacks,function(j){j(JPT.DialogController.dialog,h.returnUrl,h.projectId,h.projectKey,h.projectName)})}else{this._window.location=contextPath+h.returnUrl}},projectValidationFailedHandler:function(h,j){var i={};if(h.status===400){i=JSON.parse(h.responseText)}else{if(h.status===500&&!_.isUndefined(JSON.parse(h.responseText).message)){var g=JSON.parse(h.responseText);JIRA.Messages.showReloadErrorMsg(g.message);JPT.AddProjectView.avoidDirtyFormWarning();this._window.location=contextPath+g.returnUrl;return}else{if(j==="timeout"){i={errorMessages:["Request timeout when creating project"]}}else{i={errorMessages:[AJS.format("Error creating project, {0}",h.responseText)]}}}}JPT.AddProjectView.draw({webItemData:this.webItemData,errors:i,currentName:JPT.AddProjectView.getName(),currentKey:JPT.AddProjectView.getKey(),currentUserDisplayName:JPT.ConfigModel.currentUserDisplayName,currentUserName:JPT.ConfigModel.currentUserName,currentUserAvatarUrl:JPT.ConfigModel.currentUserAvatarUrl});JPT.AddProjectView.hideLoadingState()},_updateAndValidateKey:function e(g){JPT.AddProjectView.setKey(g);this._validateKey()},_shouldUpdateKey:function d(){return(JPT.AddProjectView.getKeyEdited()!="true")},autofillKeyIfNeeded:function b(){if(this._shouldUpdateKey()){var g=JPT.ProjectKeyGenerator.generate(JPT.AddProjectView.getName());if(g.length>1){this._updateAndValidateKey(g)}else{JPT.AddProjectView.setKey("")}}},_doesProjectNameExists:function(h){var g;for(g in this.projectNamesUpperCased){if(h.toUpperCase()==this.projectNamesUpperCased[g]){return true}}return false},_validateName:function(){var g=AJS.$.trim(JPT.AddProjectView.getName());if(!g){return}if(g.length<JPT.ConfigModel.minNameLength){JPT.AddProjectView.showInlineErrorForName(AJS.format("The project name should be at least {0} characters in length.",JPT.ConfigModel.minNameLength));return}if(g.length>JPT.ConfigModel.maxNameLength){JPT.AddProjectView.showInlineErrorForName(AJS.format("The project name must not exceed {0} characters in length.",JPT.ConfigModel.maxNameLength));return}if(this._doesProjectNameExists(g)){JPT.AddProjectView.showInlineErrorForName("A project with that name already exists.");return}JPT.AddProjectView.hideInlineErrorForName()},_performKeyValidationChecks:function(g){var h=AJS.$.ajax({url:contextPath+"/rest/api/latest/projectvalidate/key?key="+g.toUpperCase(),timeout:5000});h.done(_.bind(function(j){if(j.errors&&j.errors.projectKey){JPT.AddProjectView.showInlineErrorForKey(j.errors.projectKey)}else{var i=false;_.each(this.projectKeyValidationCallbacks,function(l){var k=l(g.toUpperCase());if(k.errors&&k.errors.projectKey){i=true;JPT.AddProjectView.showInlineErrorForKey(k.errors.projectKey)}});if(!i){JPT.AddProjectView.hideInlineErrorForKey()}}},this))},_validateKey:function a(){var g=JPT.AddProjectView.getKey();if(this.lastKeyValidated===g){return}if(g){this.lastKeyValidated=g;this._performKeyValidationChecks(g)}else{JPT.AddProjectView.hideInlineErrorForKey()}},nameTimeout:function c(){this._validateName();this.autofillKeyIfNeeded()},keyTimeout:function f(){JPT.AddProjectView.setKeyEdited();this._validateKey()},_getExistingProjects:function(){if(this.projectNamesUpperCased.length>0){return this.projectNamesUpperCased}var g=AJS.$.ajax({url:contextPath+"/rest/api/latest/project",timeout:5000});g.done(_.bind(function(h){this.projectNamesUpperCased=_.map(h,function(i){return i.name.toUpperCase()})},this))}});JPT.AddProjectController=new JPT.AddProjectControllerImpl({el:AJS.$(document)})})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/AddProjectView.js' */
(function(){JPT.AddProjectViewImpl=Backbone.View.extend({TIMEOUT_MS:100,postDrawCallbacks:[],events:{"submit #add-project-form":"onSubmitForm"},page:undefined,isSubmitting:false,initialize:function(w){_.bindAll(this,"bindHook")},addPostDrawCallback:function(w){this.postDrawCallbacks.push(w)},prepareDialog:function(w){this.page=JPT.DialogController.addPage({name:"add-project",title:w,panelName:"add-project",backButton:true,submitButtonText:"Submit",submitButtonCallback:this.onSubmitForm.bind(this),submitButtonClass:"add-project-dialog-create-button"})},draw:function(C){function B(D){if(!D.errors){D.errors={}}return D}this.isSubmitting=false;JPT.DialogController.dialog.gotoPage(this.page.id);var z={maxNameLength:JPT.ConfigModel.maxNameLength,maxKeyLength:JPT.ConfigModel.maxKeyLength,shouldShowLead:JPT.ConfigModel.shouldShowProjectLead,projectTemplateWebItemKey:JPT.ConfigModel.selectedTemplate||C.webItemData.itemModuleCompleteKey,projectTemplateModuleKey:C.webItemData.projectTemplateModuleCompleteKey,projectTemplateTitle:C.webItemData.name,projectTemplateDescriptionContent:C.webItemData.longDescriptionContent||C.webItemData.description,currentKey:C.currentKey||"",currentName:C.currentName||"",errors:B(C.errors),projectLeadPickerField:{id:"lead",name:"lead"},leadOptions:[{selected:true,displayName:C.currentUserDisplayName,optionName:C.currentUserName,avatarURL:C.currentUserAvatarUrl}]};var x=JIRA.Templates.ProjectTemplates.addProjectForm(z);JPT.DialogController.dialog.getPanel(this.page.id,0).html(x);if(C.webItemData.backgroundIconUrl){var w=JPT.DialogController.$dialogElement.find(".pt-content");w.css("background-image",'url("'+C.webItemData.backgroundIconUrl+'")')}var y=AJS.$("#add-project-form");JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[y]);this.nameElement=JPT.DialogController.$dialogElement.find("#name");this.keyElement=JPT.DialogController.$dialogElement.find("#key");this.keyEditedElement=JPT.DialogController.$dialogElement.find("#keyEdited");this.leadDisplayElement=JPT.DialogController.$dialogElement.find("#lead-field");this.leadValueElement=JPT.DialogController.$dialogElement.find("#lead");var A=this.keyElement.parent().find(".aui-icon-help");if(A.length){new AJS.InlineDialog(A,"project-key-help-popup",function(F,E,D){F.html(JIRA.Templates.ProjectTemplates.keyHelp());D()},{width:330,offsetX:-30})}this.keyElement.attr("style","text-transform: uppercase");this.nameElement.focus(_.bind(function(D){this.bindHook(D,JPT.AddProjectController.nameTimeout)},this));this.nameElement.blur(function(D){JPT.AddProjectView.unbindHook(D)});this.nameElement.focus();this.keyElement.focus(_.bind(function(E){var D=AJS.$(E.target);D.data("lastValue",D.val());this.bindHook(E,JPT.AddProjectController.keyTimeout)},this));this.keyElement.blur(_.bind(function(D){this.unbindHook(D)},this));this.keyElement.blur(function(){JPT.AddProjectController.autofillKeyIfNeeded()});if(!_.isEmpty(this.postDrawCallbacks)){_.each(this.postDrawCallbacks,function(D){D()})}},onSubmitForm:function(w){JPT.AddProjectController.submit();return false},get$SubmitButton:function(){return JPT.DialogController.$dialogElement.find(".add-project-dialog-create-button")},get$BackButton:function(){return JPT.DialogController.$dialogElement.find(".add-project-back-button")},bindHook:function j(z,x){var w=AJS.$(z.target),y;y=_.bind(function(){this.unbindHook(z);x.apply();if(w.is(":visible")){w.data("checkHook",setTimeout(y,this.TIMEOUT_MS))}},this);if(!w.data("checkHook")){w.data("checkHook",setTimeout(y,0))}},unbindHook:function(x){var w=AJS.$(x.target);clearTimeout(w.data("checkHook"));w.removeData("checkHook")},showInlineError:function(x,y){if(this.isSubmitting){return}var w=x.parent().find(".error");if(!w.length){w=AJS.$("<div class='error'></div>");x.parent().append(w)}w.text(y);w.show()},showInlineErrorForName:function v(w){this.showInlineError(this.nameElement,w)},showInlineErrorForKey:function s(w){this.showInlineError(this.keyElement,w)},hideInlineError:function r(w){w.parent().find(".error").hide()},hideInlineErrorForName:function b(){this.hideInlineError(this.nameElement)},hideInlineErrorForKey:function n(){this.hideInlineError(this.keyElement)},setName:function f(w){this.nameElement.val(w)},getName:function m(){return this.nameElement.val()},setKey:function c(w){this.keyElement.val(w)},getKey:function k(){return this.keyElement.val()},getLeadDisplayName:function o(){return this.leadDisplayElement.val()},getLeadUserName:function p(){return this.leadValueElement.val()},getAvatarUrlOfSelectedLead:function l(){var w=JPT.DialogController.$dialogElement.find("#lead-single-select .aui-ss-entity-icon").css("background-image");if(!_.isUndefined(w)){var x=w.match(/^url\((.+)\)$/);return(x&&x[1])?x[1]:""}else{return""}},setKeyEdited:function i(w){this.keyEditedElement.val(w)},getKeyEdited:function t(){return this.keyEditedElement.val()},setKeyEdited:function i(){var w=this.getKey();if(this.keyElement.data("lastValue")!==w){this.keyEditedElement.val((w)?"true":"false")}this.keyElement.data("lastValue",w)},hasNameErrors:function d(){return this.nameElement.parent().find(".error").size()>0},getAddProjectForm:function e(){return AJS.$("#add-project-form")},get$FormFields:function h(){return JPT.DialogController.$dialogElement.find(":input")},enterLoadingState:function g(){$submitButton=this.get$SubmitButton();if(!$submitButton.attr("disabled")){$backButton=this.get$BackButton();$submitButton.attr("disabled","disabled");$backButton.attr("disabled","disabled");$backButton.before(JIRA.Templates.ProjectTemplates.spinner({id:"addproject-loading"}));this.get$FormFields().attr("disabled","disabled");this.isSubmitting=true;return true}else{return false}},hideLoadingState:function q(){JPT.DialogController.$dialogElement.find("#addproject-loading").remove();this.get$SubmitButton().removeAttr("disabled");this.get$BackButton().removeAttr("disabled");this.get$FormFields().removeAttr("disabled")},avoidDirtyFormWarning:function a(){if(jQuery.fn.removeDirtyWarning){this.getAddProjectForm().removeDirtyWarning()}},hasInlineErrors:function u(){return JPT.DialogController.$dialogElement.find(".error:visible").length!=0}});JPT.AddProjectView=new JPT.AddProjectViewImpl({el:AJS.$(document),dialogView:JPT.DialogView})})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/soy/AddProject.soy' */
// This file was automatically generated from AddProject.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }


JIRA.Templates.ProjectTemplates.addProjectForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.errors.errorMessages) {
    var errorList5 = opt_data.errors.errorMessages;
    var errorListLen5 = errorList5.length;
    for (var errorIndex5 = 0; errorIndex5 < errorListLen5; errorIndex5++) {
      var errorData5 = errorList5[errorIndex5];
      JIRA.Templates.errorMsg({closeable: false, msg: errorData5}, output);
    }
  }
  output.append('<div class="add-project-wrapper"><div class="add-project-form-wrapper">');
  var param11 = new soy.StringBuilder();
  var param13 = new soy.StringBuilder();
  JIRA.Templates.ProjectTemplates.longTextField({id: 'name', name: 'name', isRequired: false, maxLength: opt_data.maxNameLength, labelContent: "Name", descriptionText: AJS.format("Max. {0} characters.",opt_data.maxNameLength), value: opt_data.currentName ? opt_data.currentName : '', errorTexts: opt_data.errors.errors.projectName ? [opt_data.errors.errors.projectName] : []}, param13);
  JIRA.Templates.ProjectTemplates.textFieldWithHelpIcon({id: 'key', name: 'key', isRequired: false, maxLength: opt_data.maxKeyLength, labelContent: "Key", descriptionText: AJS.format("Max. {0} characters.",opt_data.maxKeyLength), helpTitle: "What\x27s a project key?", value: opt_data.currentKey ? opt_data.currentKey : '', errorTexts: opt_data.errors.errors.projectKey ? [opt_data.errors.errors.projectKey] : []}, param13);
  if (opt_data.shouldShowLead) {
    JIRA.Templates.ProjectTemplates.projectLeadField({field: opt_data.projectLeadPickerField, isRequired: false, errorTexts: opt_data.errors.errors.projectLead ? [opt_data.errors.errors.projectLead] : [], options: opt_data.leadOptions}, param13);
  }
  param13.append('<input type="hidden" name="keyEdited" id="keyEdited" value="false"><input type="hidden" name="projectTemplateWebItemKey" value="', soy.$$escapeHtml(opt_data.projectTemplateWebItemKey), '"><input type="hidden" name="projectTemplateModuleKey" value="', soy.$$escapeHtml(opt_data.projectTemplateModuleKey), '"><input type="submit" class="pt-hidden-submit offscreen-left">');
  aui.form.fieldset({legendContent: '', content: param13.toString()}, param11);
  aui.form.form({content: param11.toString(), id: 'add-project-form'}, output);
  output.append('</div>', (opt_data.projectTemplateDescriptionContent) ? '<div class="add-project-description-wrapper"><div class="project-template-title"><h3>' + soy.$$escapeHtml(opt_data.projectTemplateTitle) + '</h3></div><div class="project-template-description">' + opt_data.projectTemplateDescriptionContent + '</div></div>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.keyHelp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-key-help"><p><b>', soy.$$escapeHtml("What\x27s a project key?"), '</b></p><ul><li>', soy.$$escapeHtml("It prefixes each issue in the project"), '</li><li>', soy.$$escapeHtml("It can be changed, but this is not a trivial task"), '</li></ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.projectLeadField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param67 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.field.name + '-field', isRequired: opt_data.isRequired, content: "Project Lead"}, param67);
  JIRA.Templates.Fields.Pickers.User.single({field: opt_data.field, options: opt_data.options, editValue: opt_data.value}, param67);
  aui.form.fieldDescription({message: "Enter the username of the Project Lead."}, param67);
  if (opt_data.errorTexts) {
    var errorList80 = opt_data.errorTexts;
    var errorListLen80 = errorList80.length;
    for (var errorIndex80 = 0; errorIndex80 < errorListLen80; errorIndex80++) {
      var errorData80 = errorList80[errorIndex80];
      aui.form.fieldError({message: errorData80}, param67);
    }
  }
  aui.form.fieldGroup({content: param67.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.textFieldWithHelpIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param86 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.name, isRequired: opt_data.isRequired, content: opt_data.labelContent}, param86);
  aui.form.input({id: opt_data.id, name: opt_data.name, type: 'text', maxLength: opt_data.maxLength, value: opt_data.value}, param86);
  param86.append('<a class="help-lnk" title="', soy.$$escapeHtml(opt_data.helpTitle), '" id="', soy.$$escapeHtml(opt_data.id), '-help-icon"><span class="aui-icon aui-icon-help">', soy.$$escapeHtml(opt_data.helpTitle), '</span></a>');
  if (opt_data.descriptionText) {
    aui.form.fieldDescription({message: opt_data.descriptionText}, param86);
  }
  if (opt_data.errorTexts) {
    var errorList110 = opt_data.errorTexts;
    var errorListLen110 = errorList110.length;
    for (var errorIndex110 = 0; errorIndex110 < errorListLen110; errorIndex110++) {
      var errorData110 = errorList110[errorIndex110];
      aui.form.fieldError({message: errorData110}, param86);
    }
  }
  aui.form.fieldGroup({content: param86.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.longTextField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param116 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.name, isRequired: opt_data.isRequired, content: opt_data.labelContent}, param116);
  aui.form.input({id: opt_data.id, name: opt_data.name, type: 'text', maxLength: opt_data.maxLength, value: opt_data.value, extraClasses: 'long-field'}, param116);
  if (opt_data.descriptionText) {
    aui.form.fieldDescription({message: opt_data.descriptionText}, param116);
  }
  if (opt_data.errorTexts) {
    var errorList134 = opt_data.errorTexts;
    var errorListLen134 = errorList134.length;
    for (var errorIndex134 = 0; errorIndex134 < errorListLen134; errorIndex134++) {
      var errorData134 = errorList134[errorIndex134];
      aui.form.fieldError({message: errorData134}, param116);
    }
  }
  aui.form.fieldGroup({content: param116.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.spinner = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span id=\'', soy.$$escapeHtml(opt_data.id), '\' class=\'icon throbber loading\'/>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.formatAnchor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtml(opt_data.href), '"', (opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '', '>', soy.$$escapeHtml(opt_data.body), '</a>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/ProjectKeyGenerator.js' */
JPT.ProjectKeyGenerator={};JPT.ProjectKeyGenerator.IGNORED_WORDS=["THE","A","AN","AS","AND","OF","OR"];JPT.ProjectKeyGenerator.CHARACTER_MAP={};JPT.ProjectKeyGenerator.CHARACTER_MAP[199]="C";JPT.ProjectKeyGenerator.CHARACTER_MAP[231]="c";JPT.ProjectKeyGenerator.CHARACTER_MAP[252]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[251]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[250]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[249]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[233]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[234]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[235]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[232]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[226]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[228]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[224]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[229]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[225]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[239]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[238]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[236]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[237]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[196]="A";JPT.ProjectKeyGenerator.CHARACTER_MAP[197]="A";JPT.ProjectKeyGenerator.CHARACTER_MAP[201]="E";JPT.ProjectKeyGenerator.CHARACTER_MAP[230]="ae";JPT.ProjectKeyGenerator.CHARACTER_MAP[198]="Ae";JPT.ProjectKeyGenerator.CHARACTER_MAP[244]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[246]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[242]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[243]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[220]="U";JPT.ProjectKeyGenerator.CHARACTER_MAP[255]="Y";JPT.ProjectKeyGenerator.CHARACTER_MAP[214]="O";JPT.ProjectKeyGenerator.CHARACTER_MAP[241]="n";JPT.ProjectKeyGenerator.CHARACTER_MAP[209]="N";JPT.ProjectKeyGenerator.desiredKeyLength=4;JPT.ProjectKeyGenerator.maxKeyLength=10;JPT.ProjectKeyGenerator.getTotalLength=function getTotalLength(a){return a.join("").length};JPT.ProjectKeyGenerator.removeIgnoredWords=function removeIgnoredWords(a){return _.reject(a,function(b){return AJS.$.inArray(b,JPT.ProjectKeyGenerator.IGNORED_WORDS)!==-1})};JPT.ProjectKeyGenerator.createAcronym=function createAcronym(b){var a="";AJS.$.each(b,function(c,d){a+=d.charAt(0)});return a};JPT.ProjectKeyGenerator.getFirstSyllable=function getFirstSyllable(c){var b=false;var a;for(a=0;a<c.length;a++){if(JPT.ProjectKeyGenerator.isVowelOrY(c[a])){b=true}else{if(b){return c.substring(0,a+1)}}}return c};JPT.ProjectKeyGenerator.isVowelOrY=function isVowelOrY(a){return a&&a.length===1&&a.search("[AEIOUY]")!==-1};JPT.ProjectKeyGenerator.init=function init(b,a){JPT.ProjectKeyGenerator.desiredKeyLength=b;JPT.ProjectKeyGenerator.maxKeyLength=a};JPT.ProjectKeyGenerator.generate=function generate(b){b=AJS.$.trim(b);if(!b){return""}var a=[];for(var d=0,f=b.length;d<f;d++){var e=JPT.ProjectKeyGenerator.CHARACTER_MAP[b.charCodeAt(d)];a.push(e?e:b[d])}b=a.join("");var h=[];AJS.$.each(b.split(/\s+/),function(j,k){if(k){k=k.replace(/[^a-zA-Z]/g,"");k=k.toUpperCase();k.length&&h.push(k)}});if(JPT.ProjectKeyGenerator.desiredKeyLength&&JPT.ProjectKeyGenerator.getTotalLength(h)>JPT.ProjectKeyGenerator.desiredKeyLength){h=JPT.ProjectKeyGenerator.removeIgnoredWords(h)}var c;if(h.length==0){c=""}else{if(h.length==1){var g=h[0];if(JPT.ProjectKeyGenerator.desiredKeyLength&&g.length>JPT.ProjectKeyGenerator.desiredKeyLength){c=JPT.ProjectKeyGenerator.getFirstSyllable(g)}else{c=g}}else{c=JPT.ProjectKeyGenerator.createAcronym(h)}}if(JPT.ProjectKeyGenerator.maxKeyLength&&c.length>JPT.ProjectKeyGenerator.maxKeyLength){c=c.substr(0,JPT.ProjectKeyGenerator.maxKeyLength)}return c};;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/RemoteProjectsCreatedMessage.js' */
AJS.$(function(){var b=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"confluenceProject");var h=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"fisheyeProject");var f=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"crucibleProject");var d=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"bambooProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"confluenceProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"fisheyeProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"crucibleProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"bambooProject");var i;function c(k,j){return JIRA.Templates.ProjectTemplates.formatAnchor({href:k,body:j,title:j})}function a(l,m,k,n){var j=[];j.push("a JIRA project");if(l){j.push(c(l,"a Confluence space"))}if(m){j.push(c(m,"a FishEye repository"))}if(k){j.push(c(k,"a Crucible project"))}if(n){j.push(c(n,"a Bamboo project"))}return j}function g(k,m,j,p){var o="The following entities were created: {0} and {1}.";var l=a(k,m,j,p);var n=l.pop();return(l.length>0)?AJS.format(o,l.join(", "),n):null}function e(j){var k=AJS.$(j).offset();if(k){window.scrollTo(k.left,k.top)}}if(b||h||f||d){i=g(b,h,f,d);if(i){JIRA.Messages.showSuccessMsg(i,{closeable:true})}e("#project-config-webpanel-summary-settings")}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/jira-amd.js' */
define("dndattachment/JIRA",function(){return JIRA});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/aui-amd.js' */
define("dndattachment/aui",function(){return AJS});define("dndattachment/aui/dialog",function(){return AJS.Dialog});define("dndattachment/aui/inline-dialog",function(){return AJS.InlineDialog});define("dndattachment/aui/message",function(){return AJS.messages});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/jquery-amd.js' */
define("dndattachment/jquery",["dndattachment/aui"],function(a){return a.$});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/i18n.js' */
define("dndattachment/i18n",function(){var a={"dnd.attachment.unsupported.browser":"Drag and Drop of attachments is currently only available for the following browsers:","dnd.attachment.file.is.too.large":"File exceeds maximum size limit set by the administrator ({0}).","dnd.attachment.upload.in.progress":"Upload in progress, please wait."};return function(b){if(a[b]){return a[b]}else{throw"Unknown key: "+b}}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/Parser.js' */
define("dndattachment/Parser",["dndattachment/aui","dndattachment/jquery"],function(a,b){var c="-dui-type-parsed";var e="*[duiType]:not(."+c+")";function d(g){var f=b(g).find(e).add(g.filter(e));var h=f.addClass(c).map(function(j,k){var i=new b.Deferred();require([b(k).attr("duiType")],function(l){if(typeof l=="function"){i.resolve(new l(k))}else{i.reject()}});return i});return b.when.apply(window,b.makeArray(h))}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(h,f,g){d(f)});if(b.isReady){d(b("body"))}else{b(function(){d(b("body"))})}return{parse:d}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/IssueDropZone.js' */
define("dndattachment/IssueDropZone",["dndattachment/jquery","dndattachment/Parser","dndattachment/aui","dndattachment/JIRA","dndattachment/i18n","dndattachment/TemporaryAttachments"],function(f,h,b,a,e,d){var c=5000;var g=Class.extend({eventGroup:"issuedropzone",progressBarType:"dndattachment/UploadProgressBar",init:function(i){this.$node=f(i);if(!this.isSupportedBrowser()){return this.renderUnsupported()}this.uploadLimit=this.$node.data("upload-limit");this.uploadSize=this.$node.data("upload-size");this.formToken=this.$node.data("form-token");this.pendingQueue=[];this.render();this.connectListeners();this.queueEvent("init")},queueTask:function(i){this.pendingQueue.push(i);i.always(function(){this.pendingQueue.splice(this.pendingQueue.indexOf(i),1)}.bind(this));this.markDirty(true);f.when.apply(window,this.pendingQueue).then(_.debounce(this.checkMarkDirty,false,true).bind(this))},render:function(){this.$node.html(a.Templates.DnDAttachmentPlugin.IssueDropZone({}));this.fileInput=this.$node.find(".issue-drop-zone__file");this.fileLabel=this.fileInput.parent("label.issue-drop-zone__button");if(a.Events.LOCK_PANEL_REFRESHING){a.trigger(a.Events.LOCK_PANEL_REFRESHING,["drag-and-drop-attachment-panel"])}a.trace("jira.issue.dnd.issuedropzone.render")},connectListeners:function(){this.fileInput.change(function(j){this.uploadFiles(this.fileInput[0].files);this.queueEvent("fileInput",{count:this.fileInput[0].files.length});this.fileInput.attr("value",null)}.bind(this));if(f("html.mozilla")[0]&&(parseInt(f.browser.version,10)<22)){this.fileLabel.on("click",function(j){if(j.currentTarget===this.fileLabel[0]&&j.target.nodeName!=="INPUT"){this.fileInput.click()}}.bind(this))}var i=this.$node.find(">*");i.on("dragover drop",function(j){j.preventDefault();j.stopPropagation();this.$node.addClass("dragover");if(j.dataTransfer&&j.dataTransfer.files&&j.dataTransfer.files.length>0){this.uploadFiles(j.dataTransfer.files);this.queueEvent("fileDrop",{count:j.dataTransfer.files.length})}if(j.type=="drop"){this.$node.removeClass("dragover")}}.bind(this));i.on("dragleave",function(){this.$node.removeClass("dragover")}.bind(this))},createUploadProgressBar:function(){return h.parse(f('<div duiType="'+this.progressBarType+'" class="upload-progress-bar"></div>').data("upload-size",this.uploadSize).data("form-token",this.formToken).insertAfter(this.$node))},uploadFiles:function(j){var l=[];var i=_.map(j,function(n){var m=new f.Deferred();this.createUploadProgressBar().then(function(o){this.trigger("progressBarInserted",o);l.push(o);o.uploadFile(n,this.uploadLimit).then(m.resolve.bind(m),m.resolve.bind(m)).done(function(){this.trigger("uploadFinished",o)}.bind(this))}.bind(this));return m}.bind(this));var k=f.when.apply(window,i);k.done(function(){var m=_.filter(i.length==1?[arguments]:arguments,function(n){return n&&n[0]&&n[0].id}).map(function(n){return n[0].id});if(m.length==0){return}this.commitUpload(m).then(function(){_.delay(function(){l.some(function(n){if(n.getAutoDestroy()){n.destroy();this.queueEvent("autoDestroy")}}.bind(this))}.bind(this),c)}.bind(this))}.bind(this));this.queueTask(k);return k},loadFiles:function(i){i.forEach(function(j){this.createUploadProgressBar().then(function(k){k.setFileID(j.id);k.setFileName(j.name);k.setFileSize(j.size);k.setProgress(1);k.setFinished();var l=d.getAttachment(j.id);if(l&&l.file){k.loadThumbnail(l.file)}else{}this.trigger("uploadFinished",k)}.bind(this))},this)},commitUpload:function(j){var i=new f.Deferred();a.SmartAjax.makeRequest({type:"POST",url:contextPath+"/secure/AttachFile.jspa",data:{inline:true,id:a.Issue.getIssueId(),filetoconvert:j,atl_token:atl_token()},success:i.resolve.bind(i),error:i.reject.bind(i)});i.then(function(){if(a.Events.REFRESH_ISSUE_PAGE){a.trigger(a.Events.REFRESH_ISSUE_PAGE,[a.Issue.getIssueId()])}a.trace("jira.issue.dnd.attached")});this.queueTask(i);this.queueEvent("commitUpload",{count:j.length});return i},isSupportedBrowser:function(){if(f("html.webkit")[0]||f("html.safari")[0]){if(!(parseFloat(f.browser.version)>=533)){return false}}else{if(f("html.mozilla")[0]){if(!(parseFloat(f.browser.version)>=1.9)){return false}}else{if(f("html.msie")[0]){if(!(parseFloat(f.browser.version)>=10)){return false}}else{return false}}}return true},renderUnsupported:function(){this.$node.addClass("issue-drop-zone__not-supported").text(e("dnd.attachment.unsupported.browser")).append("<ul><li>FireFox 3.6+</li><li>Chrome 5+</li><li>Safari 5</li></ul>")},markDirty:function(i){this.$node.addClass(a.DirtyForm.ClassNames.SANCTIONED);this.$node.toggleClass(a.DirtyForm.ClassNames.EXEMPT,!i);this.$node.attr("value",false);this.$node.attr("defaultValue",true)},checkMarkDirty:function(){if(this.pendingQueue.length==0){this.markDirty(false)}},queueEvent:function(i,j){b.trigger("analytics",{name:"issue.dnd.attachment."+this.eventGroup+"."+i,data:j||{}})}});return g});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/FormDropZone.js' */
define("dndattachment/FormDropZone",["dndattachment/Parser","dndattachment/IssueDropZone","dndattachment/jquery","dndattachment/aui","dndattachment/i18n","dndattachment/JIRA"],function(g,f,e,b,d,a){var c=f.extend({eventGroup:"formdropzone",init:function(){this._super.apply(this,arguments);this.bind("uploadFinished",this.onUploadFinished.bind(this));this.$containerNode=this.getContainerNode();this.$formNode=this.$node.parents("form");this.formToken=this.$formNode.find('input[name="formToken"]').attr("value");this.$inputNode=e('<input name="dnd-dropzone" type="hidden" />').insertAfter(this.$node);this.$fieldNode=this.$node.parents(".field-group");this.$fieldNode.addClass("long-field");this.$dragoverMask=e('<div class="attach-files-drop-zone__dragover-mask" />');this.$dragoverMask.appendTo(this.$containerNode);this.connectDialogEvents();this.connectFormEvents()},onUploadFinished:function(i,j){var h=e('<input type="checkbox" name="filetoconvert"/>').addClass("upload-progress-bar__checkbox").attr("value",j.fileID).attr("id","filetoconvert-"+j.fileID).prop("checked",true).insertBefore(j.$node);j.bind("onDestroy",function(){h.prop("checked",false)});setTimeout(function(){j.$node.addClass("upload-progress-bar__upload-ready");j.setIcon("aui-iconfont-close-dialog")},1000);a.trace("jira.issue.dnd.uploadfinished")},commitUpload:function(h){this.queueEvent("commitUpload",{count:h.length});return new e.Deferred()},getContainerNode:function(){return this.$node.parents(".jira-dialog-content")},connectDialogEvents:function(){this.$containerNode.on("dragover drop",function(h){h.preventDefault();h.stopPropagation();this.$containerNode.addClass("attach-files-drop-zone__dragover");if(h.dataTransfer&&h.dataTransfer.files&&h.dataTransfer.files.length>0){this.queueEvent("fileDrop",{count:h.dataTransfer.files.length});this.uploadFiles(h.dataTransfer.files)}if(h.type=="drop"){this.$containerNode.removeClass("attach-files-drop-zone__dragover")}}.bind(this));this.$containerNode.on("dragleave",function(){this.$containerNode.removeClass("attach-files-drop-zone__dragover")}.bind(this))},connectFormEvents:function(){this.$formNode.on("before-submit",function(h){if(this.isDirty){h.preventDefault();var i={};i[this.$inputNode.attr("name")]=d("dnd.attachment.upload.in.progress");a.applyErrorsToForm(this.$formNode,i);this.$formNode.find(".error").toArray().some(function(j){j.scrollIntoView()})}}.bind(this))},markDirty:function(h){f.prototype.markDirty.apply(this,arguments);this.isDirty=h;a.trace(h?"jira.issue.dnd.isdirty":"jira.issue.dnd.isclear")}});return c});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/AttachFilesDropZone.js' */
define("dndattachment/AttachFilesDropZone",["dndattachment/FormDropZone","dndattachment/jquery"],function(a,b){var c=a.extend({eventGroup:"attachfiledropzone",init:function(){this._super.apply(this,arguments);this.bind("progressBarInserted",function(d,f){var e=new b.Deferred();this.queueTask(e);f.result.done(e.resolve.bind(e));f.bind("onDestroy",function(){e.resolve()})}.bind(this))},checkMarkDirty:function(){if(this.pendingQueue.length<=1){this.markDirty(false)}}});return c});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/CreateIssueDropZone.js' */
define("dndattachment/CreateIssueDropZone",["dndattachment/jquery","dndattachment/FormDropZone","dndattachment/UploadProgressBar"],function(d,c,b){var a=c.extend({eventGroup:"createissuedropzone",progressBarType:"dndattachment/ProjectUploadProgressBar",getContainerNode:function(){return d(this.$node.parents(".jira-dialog-content")[0]||this.$node.parents("form#issue-create").parents(".aui-page-panel-content")[0])}});return a});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/ProjectUploadProgressBar.js' */
define("dndattachment/ProjectUploadProgressBar",["dndattachment/UploadProgressBar"],function(a){return a.extend({progressBarType:"dndattachment/ProjectUploadProgressBar",getProjectId:function(){return this.$node.parents("form").find("*[name=pid]").val()},getUploadParams:function(b){var c=a.prototype.getUploadParams.apply(this,arguments);if(this.getProjectId()){c.projectId=this.getProjectId()}return c}})});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/TemporaryAttachments.js' */
define("dndattachment/TemporaryAttachments",[],function(){var a={};return{getAttachment:function(b){return a[b]},putAttachment:function(d,b){var c={id:d,name:b.name,type:b.type,file:b};a[d]=c;return c}}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/UploadProgressBar.js' */
define("dndattachment/UploadProgressBar",["dndattachment/jquery","dndattachment/Parser","dndattachment/FileIconUtil","dndattachment/JIRA","dndattachment/aui","dndattachment/i18n","dndattachment/TemporaryAttachments"],function(e,c,f,b,i,d,h){var g=["aui-iconfont-error","aui-iconfont-success","aui-iconfont-close-dialog"];function a(k,l){i.trigger("analytics",{name:"issue.dnd.attachment.uploadprogress."+k,data:l||{}})}var j=Class.extend({autoDestroy:true,init:function(k){this.result=new e.Deferred();this.$node=e(k);this.uploadSize=this.$node.data("upload-size");this.formToken=this.$node.data("form-token");this.render()},render:function(){this.$node.html(b.Templates.DnDAttachmentPlugin.UploadProgressBar({}));this.$node.find(".upload-progress-bar__control button").on("click",function(){this.destroy();a("buttonClick")}.bind(this))},destroy:function(){this.setAutoDestroy(false);this.trigger("onDestroy");this.$node.animate({opacity:0},{duration:250,complete:function(){this.$node.slideUp(250,function(){if(this.objectURL){window.URL.revokeObjectURL(this.objectURL)}this.$node.remove()}.bind(this))}.bind(this)})},setAutoDestroy:function(k){this.autoDestroy=k},getAutoDestroy:function(){return this.autoDestroy},getUploadParams:function(k){var l={filename:k.name,size:k.size,atl_token:atl_token(),formToken:this.formToken};_.extend(l,this.getEntityParams());return l},getEntityParams:function(){var k={};var m=b.Issue.getIssueId();var l=this.$node.parents("form").find('*[name="pid"]').attr("value");if(l){k.projectId=l}else{if(m){k.issueId=m}}return k},setFileID:function(k){this.fileID=k},setFileName:function(k){this.$node.find(".upload-progress-bar__file-name").text(k)},setFileSize:function(k){if(k>=0){this.$node.find(".upload-progress-bar__file-size").html(i.InlineAttach.Text.fileSize(k))}},uploadFile:function(l,m){this.setFileName(l.name);this.setFileSize(i.InlineAttach.Text.fileSize(l.size));this.loadThumbnail(l);var k=this.result;k.fail(this.reportError.bind(this));if(l.size>m){k.reject(d("dnd.attachment.file.is.too.large").replace("{0}",this.uploadSize),true);return k}this.upload=new i.InlineAttach.AjaxUpload({file:l,params:this.getUploadParams(l),url:i.InlineAttach.AjaxPresenter.DEFAULT_URL,progress:function(n){k.notify(n/l.size)},success:function(o,n){if(o.id!==undefined&&o.name!==undefined){k.notify(1);k.resolve(o,n,l)}else{k.reject(o,n,l)}},error:function(o,n){k.reject("Internal error",n)}});this.monitorUpload(k);this.checkSession().then(function(){this.upload.upload()}.bind(this)).fail(function(){k.reject("Unauthorized",401)});this.$node.find(".upload-progress-bar__control button").on("click",function(){this.upload.abort();k.reject()}.bind(this));k.done(function(n){h.putAttachment(n.id,l);this.setFileID(n.id);b.trace("jira.issue.dnd.uploaded")}.bind(this));return k},monitorUpload:function(k){k.progress(this.setProgress.bind(this));k.done(this.setFinished.bind(this));k.fail(function(){this.$node.addClass("UploadProgressBar_uploadFailed")}.bind(this))},setProgress:function(k){var l=this.$node.find(".upload-progress-bar__progress-bar");l.toggleClass("UploadProgressBar_progressUnknown",k===false);if(k>=0){l.find(".upload-progress-bar__bar").css("width",100*k+"%")}},setFinished:function(){this.$node.addClass("upload-progress-bar__upload-finished");this.$node.find(".upload-progress-bar__control button .aui-icon").addClass("aui-iconfont-success").removeClass("aui-iconfont-close-dialog")},loadThumbnail:function(k){if(k.type.match(/image.*/)){this.objectURL=window.URL.createObjectURL(k)}var l=this.objectURL||f.getIconURL(f.matchExtension(k.name),k.type);var m=this.$node.find(".upload-progress-bar__thumbnail");e("<img/>").attr("src",l).appendTo(m);m.addClass(this.objectURL?"upload-progress-bar__thumbnail_image":"upload-progress-bar__thumbnail_icon")},reportError:function(k){if(typeof k=="object"&&k.errorMessage){k=k.errorMessage}this.setIcon("aui-iconfont-error");this.$node.addClass("upload-progress-bar__upload-error");this.$node.find(".upload-progress-bar__bar").css("width","100%");this.$node.find(".upload-progress-bar__error-message").text(k);this.setAutoDestroy(false);a("error",{message:k})},setIcon:function(l){var k=this.$node.find(".upload-progress-bar__control button .aui-icon");if(!g.some(function(m){k.toggleClass(m,m==l);return m==l})){throw"Unknown icon"}},checkSession:function(){var k=new e.Deferred();i.$.ajax({type:"GET",url:contextPath+"/rest/auth/1/session",contentType:"application/json"}).done(function(){k.resolve()}).fail(function(){this.checkPermissions().done(function(l){k.resolve()}).fail(function(){k.reject()})}.bind(this));return k},checkPermissions:function(){var k=new e.Deferred();i.$.ajax({type:"GET",url:contextPath+"/rest/api/2/mypermissions",contentType:"application/json",data:this.getEntityParams()}).done(function(l){if(l.permissions.CREATE_ATTACHMENT.havePermission){k.resolve()}else{k.reject()}}).fail(function(){k.reject()});return k}});return j});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/FileIconUtil.js' */
define("dndattachment/FileIconUtil",function(){function a(h,g,e,f){this.extension=h;this.mimeType=g;this.iconFile=e;this.iconURL=contextPath+"/images/icons/attach/"+e;this.extensionName=f}var b=[new a(".pdf","application/pdf","pdf.gif","PDF File"),new a(".gif","image/gif","image.gif","GIF File"),new a(".png","image/png","image.gif","PNG File"),new a(".jpeg","image/jpeg","image.gif","JPEG File"),new a(".xml","text/xml","xml.gif","XML File"),new a(".html","text/html","html.gif","HTML File"),new a(".java","","java.gif","Java Source File"),new a(".jar","","java.gif","Java Archive File"),new a(".txt","text/plain","text.gif","Text File"),new a(".zip","application/zip","zip.gif","Zip Archive"),new a(".gz","application/x-gzip-compressed","zip.gif","GZip Archive")].concat([".doc",".docx","docm","dotx","dotm"].map(function(e){return new a(e,"application/msword","word.gif","Microsoft Word")})).concat([".xls","xlsx","xlsm","xltx","xltm","xlsb","xlam"].map(function(e){return new a(e,"application/vnd.ms-excel","excel.gif","Microsoft Excel")})).concat(["pptx","pptm","potx","potm","ppam","ppsx","ppsm"].map(function(e){return new a(e,"application/vnd.ms-powerpoint","powerpoint.gif","Microsoft PowerPoint")}));var c=/(\.([a-z]+))$/g;var d=new a("","","file.gif","Unknown format");return{getIcon:function(f,e){return b.filter(function(g){return g.extension==f||g.mimeType==e})[0]||d},getIconURL:function(g,f){var e=this.getIcon(g,f);return e&&e.iconURL},matchExtension:function(f){var e=f.match(c);return e&&e[0]}}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'templates/IssueDropZone.soy' */
// This file was automatically generated from IssueDropZone.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DnDAttachmentPlugin == 'undefined') { JIRA.Templates.DnDAttachmentPlugin = {}; }


JIRA.Templates.DnDAttachmentPlugin.IssueDropZone = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-drop-zone__target"></div><div class="issue-drop-zone__text"><span>', soy.$$escapeHtml("Drop files here to attach them"), '</span><span>', soy.$$escapeHtml("or"), '</span></div><label class="issue-drop-zone__button aui-button">', soy.$$escapeHtml("Select files"), '<input class="issue-drop-zone__file ignore-inline-attach upfile" type="file" multiple /></label>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'templates/AttachFilesDropZone.soy' */
// This file was automatically generated from AttachFilesDropZone.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DnDAttachmentPlugin == 'undefined') { JIRA.Templates.DnDAttachmentPlugin = {}; }


JIRA.Templates.DnDAttachmentPlugin.AttachFilesDropZone = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div duiType="dndattachment/AttachFilesDropZone" class="issue-drop-zone" data-upload-limit="', soy.$$escapeHtml(opt_data.jiraAttachmentSize), '" data-upload-size="', soy.$$escapeHtml(opt_data.uploadLimit), '"></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'templates/CreateIssueDropZone.soy' */
// This file was automatically generated from CreateIssueDropZone.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DnDAttachmentPlugin == 'undefined') { JIRA.Templates.DnDAttachmentPlugin = {}; }


JIRA.Templates.DnDAttachmentPlugin.CreateIssueDropZone = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div duiType="dndattachment/CreateIssueDropZone" class="issue-drop-zone" data-upload-limit="', soy.$$escapeHtml(opt_data.jiraAttachmentSize), '" data-upload-size="', soy.$$escapeHtml(opt_data.uploadLimit), '"></div>', (opt_data.description) ? '<div class="description">' + soy.$$escapeHtml(opt_data.description) + '</div>' : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'templates/UploadProgressBar.soy' */
// This file was automatically generated from UploadProgressBar.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DnDAttachmentPlugin == 'undefined') { JIRA.Templates.DnDAttachmentPlugin = {}; }


JIRA.Templates.DnDAttachmentPlugin.UploadProgressBar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="upload-progress-bar__thumbnail"> </div><span class="upload-progress-bar__file-name"> </span><span class="upload-progress-bar__file-size"> </span><div class="upload-progress-bar__progress-bar"><span class="upload-progress-bar__bar"> </span></div><div class="upload-progress-bar__control"><button type="button" class="aui-button aui-button-subtle aui-button-compact"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">Cancel upload</span></button></div><div class="upload-progress-bar__error-message"></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript-init', location = 'js/initIssueDropZone.js' */
require(["dndattachment/Parser","dndattachment/jquery","dndattachment/IssueDropZone","dndattachment/aui","dndattachment/FileIconUtil"],function(a,b,g,i,d){if(!g.prototype.isSupportedBrowser()){return}var e="com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript.upload-limit";var f=_.isFunction(WRM.data)?WRM.data(e):WRM.data.claim(e);function j(l,p){var k=l.find(".field-group.file-input-list");if(k.size()==0){return}if(k.find('*[duiType*="'+p+'"]').length>0){return}var n=k.find("input[name=filetoconvert]:checked").map(function(q,r){return{id:r.value,name:b(r).siblings("label").text()}}).toArray();var m=k.find(".description:last-child").html();k.empty();var o=b(JIRA.Templates.DnDAttachmentPlugin[p]({uploadLimit:i.InlineAttach.Text.fileSize(f),jiraAttachmentSize:f,description:m}));a.parse(o.appendTo(k)).then(function(q){if(q!=null){q.loadFiles(n)}})}function h(k,l){k.onContentReady(function(m){j(k.$popupContent,l)})}var c=function(){if(JIRA.Dialogs.attachFile){h(JIRA.Dialogs.attachFile,"AttachFilesDropZone")}var k=["create-issue-dialog","create-subtask-dialog","edit-issue-dialog"];var l=_.map(l,function(n){return"#"+n}).join(",");b(i).on("Dialog.show",function(p,n,o){if(_.contains(k,n.attr("id"))){h(o,"CreateIssueDropZone")}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(p,n,o){if(n.parents(l).size()>0){j(n,"CreateIssueDropZone")}});var m=b("form#issue-create, form#issue-edit");if(m.size()>0){j(m,"CreateIssueDropZone")}};if(b.isReady){c()}else{i.$(c)}b.event.props.push("dataTransfer")});;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:update-plugin-banner-resources', location = 'js/banner/update-hipchat-link-banner.js' */
(function(a){AJS.toInit(function(){var e="HIPCHAT_ADMIN_BANNER_DISMISS";var c;if(!d()&&AJS.Meta.get("is-admin")&&!g()){a.ajax({url:AJS.contextPath()+"/rest/hipchat/integrations/1.0/configuration/status",dataType:"json",cache:false}).done(function(i){if(i.requiresManualInstallation||i.v1){c=b(i)}})}function b(k){var j=JIRA.Templates.HipChat.Banner.updateHipChatLink({removeV1link:!k.v2&&k.v1});var i=JIRA.Messages.showWarningMsg(j);a(document).on("click","#remove-hipchat-v1-link",h);a(document).on("aui-flag-close",".aui-flag",f);return i}function d(){return window.location.toString().indexOf("/plugins/servlet/hipchat/configure")>0}function f(i){if(a(i.target).find(".hipchat-update-banner").length>0){AJS.Cookie.save(e,true)}}function g(){return AJS.Cookie.read(e)=="true"}function h(i){i.preventDefault();a.ajax({url:AJS.contextPath()+"/rest/hipchat/integrations/1.0/configuration/v1",cache:false,type:"DELETE"}).error(function(j){if(c){c.hide()}JIRA.Messages.showErrorMsg(AJS.format("We couldn\'\'t find your integration. If the problem persists, contact Atlassian Support.\u003cbr/\u003e Error Status [{0}]",j.status))}).done(function(j){if(c){c.hide()}JIRA.Messages.showSuccessMsg("Integration has been removed successfully")})}})})(AJS.$);;
;/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:update-plugin-banner-resources', location = 'soy/banner/update-hipchat-link-banner.soy' */
// This file was automatically generated from update-hipchat-link-banner.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.HipChat == 'undefined') { JIRA.Templates.HipChat = {}; }
if (typeof JIRA.Templates.HipChat.Banner == 'undefined') { JIRA.Templates.HipChat.Banner = {}; }


JIRA.Templates.HipChat.Banner.updateHipChatLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="hipchat-update-banner"><b>', soy.$$escapeHtml("HipChat Integration is out of date"), '</b><p>', soy.$$escapeHtml("Update to take full advantage of the latest features."), '</p><p/><a href="', soy.$$escapeHtml("/j" + '/plugins/servlet/hipchat/configure'), '">', soy.$$escapeHtml("Update Now!"), '</a>', (opt_data.removeV1link) ? '<a id="remove-hipchat-v1-link">' + soy.$$escapeHtml("Remove Integration") + '</a>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'jira.webresources:jira-analytics', location = '/includes/jira/analytics/analytics.js' */
AJS.toInit(function($){function getBrowseProjectTab(){return $("li.active a.browse-tab").attr("id")}_.defer(function(){if(AJS.EventQueue){$(document).delegate("#project-admin-link","click",function(){var selectedTab=getBrowseProjectTab();AJS.EventQueue.push({name:"browseproject.administerproject",properties:{selectedtab:selectedTab}})});$(document).delegate("#browse-projects-create-project","click",function(){AJS.EventQueue.push({name:"browseprojects.createproject",properties:{}})});$(document).delegate("#no-issues-create-issue","click",function(){AJS.EventQueue.push({name:"browseproject.issuesblankslate.createissue",properties:{}})});$(document).delegate("a.issue-filter-link","click",function(){var $el=$(this);var id=$el.attr("id").replace("filter_","");var type=$el.attr("data-type");AJS.EventQueue.push({name:"browse"+type+".issuefilter."+id,properties:{}})});$(document).on("click","#project_import_link_lnk",function(){AJS.EventQueue.push({name:"topnav.jim",properties:{}})});$(document).on("click",".issueaction-viewworkflow",function(){var isNew=AJS.$(this).attr("class").indexOf("new-workflow-designer")>-1;var version=isNew?"new":"old";var newEnabled=AJS.DarkFeatures.isEnabled("casper.VIEW_ISSUE");AJS.EventQueue.push({name:"issue.viewworkflow",properties:{version:version,newEnabled:newEnabled}})});$.fn.ready(function captureWindowSize(){var width,height,shouldCapture=false;shouldCapture=shouldCapture||$(document.body).hasClass("page-type-navigator");if(!shouldCapture){return }width=$(window).width();height=$(window).height();AJS.EventQueue.push({name:"browserWindowSize",properties:{width:width,height:height}})})}})});;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/jquery/plugins/avataror/avataror.js' */
jQuery.fn.avataror=function(options){var $=jQuery,$document=$(document);this.each(function(){var $this=$(this);var imgsrc=$this.find("img").attr("src");$this.css({"-moz-border-radius":"10px","-webkit-border-radius":"10px"});$this.html("<p>Loading?</p>");var avataror={previewSize:48};avataror.preview=$("<div/>").addClass("avataror-preview").css({border:"solid 1px #000","float":"left",height:avataror.previewSize+"px",overflow:"hidden",width:avataror.previewSize+"px",position:"relative",top:"-9999em",left:"-9999em"});avataror.preview.prependTo(options.previewElement);avataror.img=$('<img src="'+imgsrc+'" alt="Avatar Source"/>');avataror.img.load(function(){avataror.image=$("<div/>").css({background:"url('"+imgsrc+"') no-repeat",clear:"left",position:"relative"});avataror.marker=$("<div/>").css({cursor:"move",position:"relative"});avataror.dash=$("<div/>");avataror.shadow=$("<div/>");avataror.dash.add(avataror.shadow).css({cursor:"move",opacity:0.5,left:0,top:0,position:"absolute"});avataror.image.append(avataror.shadow).append(avataror.dash).append(avataror.marker);$this.append(avataror.image);avataror.marker.html("<div></div><div></div><div></div><div></div>");$("div",avataror.marker).each(function(i){var $this=$(this);$this.css({background:"#000",border:"solid 1px #fff",width:"10px",height:"10px",position:"absolute","font-size":"1px"});$this.css(["left","right","right","left"][i],"-6px");$this.css(["top","top","bottom","bottom"][i],"-6px");$this.css("cursor",["nw-resize","ne-resize","se-resize","sw-resize"][i]);$this.mousedown(function(e){e.preventDefault();e.stopPropagation();avataror.dragging={x:e.pageX,y:e.pageY,ax:avataror.x,ay:avataror.y,w:avataror.width,h:avataror.height,i:i+1};avataror.shadow.hide()})});avataror.marker.add(avataror.image).mousedown(function(e){e.preventDefault();avataror.dragging={x:e.pageX,y:e.pageY,ax:avataror.x,ay:avataror.y,w:avataror.width,h:avataror.height};avataror.shadow.hide()});$document.mouseup(function(e){avataror.handleMouseUp(e)});$document.mousemove(function(e){if(avataror.dragging){avataror.handleMouseMove(e.pageX,e.pageY);e.preventDefault()}});avataror.imgwidth=avataror.img.width();avataror.imgheight=avataror.img.height();avataror.x=parseInt($("#avatar-offsetX").val());avataror.y=parseInt($("#avatar-offsetY").val());avataror.width=parseInt($("#avatar-width").val());avataror.height=avataror.width;avataror.image.css({width:avataror.imgwidth+"px",height:avataror.imgheight+"px"});avataror.setMarker();$this.css({width:avataror.imgwidth+"px"});avataror.preview.css({position:"static"});$("p",$this).remove();$this.trigger("AvatarImageLoaded")});avataror.preview.append(avataror.img);avataror.setMarker=function(){avataror.marker.css("border","dashed 1px #fff");avataror.dash.css("border","solid 1px #000");avataror.shadow.css("border","solid 1px #000");avataror.marker.add(this.dash).css("left",this.x-1+"px");avataror.marker.add(avataror.dash).css("top",avataror.y-1+"px");avataror.shadow.css("border-left-width",avataror.x+"px");avataror.shadow.css("border-right-width",avataror.imgwidth-avataror.x-avataror.width+"px");avataror.shadow.css("border-top-width",avataror.y+"px");avataror.shadow.css("border-bottom-width",avataror.imgheight-avataror.y-avataror.height+"px");avataror.shadow.css("width",avataror.width+"px");avataror.shadow.css("height",avataror.height+"px");avataror.marker.add(avataror.dash).css("width",avataror.width+"px");avataror.marker.add(avataror.dash).css("height",avataror.height+"px")};avataror.adjustPreview=function(){avataror.img.attr("width",avataror.imgwidth*avataror.previewSize/avataror.width);avataror.img.attr("height",avataror.imgheight*avataror.previewSize/avataror.height);avataror.img.css("margin-left","-"+avataror.x*avataror.previewSize/avataror.width+"px");avataror.img.css("margin-top","-"+avataror.y*avataror.previewSize/avataror.height+"px");avataror.preview.select()};avataror.handleMouseMove=function(newX,newY){avataror.dragging.nextExec=avataror.dragging.nextExec||0;if(avataror.dragging.nextExec==0){avataror.dragging.nextExec=3}else{avataror.dragging.nextExec--;return }var dx=newX-avataror.dragging.x;var dy=newY-avataror.dragging.y;if(this.dragging.i){var handler=avataror.resizeHandlers[this.dragging.i-1];handler(dx,dy)}else{avataror.x=avataror.dragging.ax+dx;avataror.y=avataror.dragging.ay+dy;if(avataror.x+avataror.width>avataror.imgwidth){avataror.x=avataror.imgwidth-avataror.width}if(avataror.y+avataror.height>avataror.imgheight){avataror.y=avataror.imgheight-avataror.height}if(avataror.x<0){avataror.x=0}if(avataror.y<0){avataror.y=0}}avataror.setMarker();avataror.adjustPreview()};avataror.handleMouseUp=function(e){$("#avatar-offsetX").val(avataror.x);$("#avatar-offsetY").val(avataror.y);$("#avatar-width").val(avataror.width);avataror.dragging=null;avataror.shadow.show()};avataror.originX=function(){return avataror.dragging.ax};avataror.originY=function(){return avataror.dragging.ay};avataror.originBottomX=function(){return avataror.dragging.ax+avataror.dragging.w};avataror.originBottomY=function(){return avataror.dragging.ay+avataror.dragging.h};avataror.originNw=function(){return{x:avataror.originX(),y:avataror.originY()}};avataror.originNe=function(){return{x:avataror.originBottomX(),y:avataror.originY()}};avataror.originSe=function(){return{x:avataror.originBottomX(),y:avataror.originBottomY()}};avataror.originSw=function(){return{x:avataror.originX(),y:avataror.originBottomY()}};avataror.nwHandler=function(dx,dy){var anchor=avataror.originSe();var tmpBase={x:avataror.originX()+dx,y:avataror.originY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x-newSize<0){newSize=anchor.x}if(anchor.y-newSize<0){newSize=anchor.y}avataror.x=anchor.x-newSize;avataror.y=anchor.y-newSize;avataror.width=avataror.height=newSize};avataror.neHandler=function(dx,dy){var anchor=avataror.originSw();var tmpBase={x:avataror.originBottomX()+dx,y:avataror.originY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x+newSize>avataror.imgwidth){newSize=avataror.imgwidth-anchor.x}if(anchor.y-newSize<0){newSize=anchor.y}avataror.y=anchor.y-newSize;avataror.width=avataror.height=newSize};avataror.seHandler=function(dx,dy){var anchor=avataror.originNw();var tmpBase={x:avataror.originBottomX()+dx,y:avataror.originBottomY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x+newSize>avataror.imgwidth){newSize=avataror.imgwidth-anchor.x}if(anchor.y+newSize>avataror.imgheight){newSize=avataror.imgheight-anchor.y}avataror.width=avataror.height=newSize};avataror.swHandler=function(dx,dy){var anchor=avataror.originNe();var tmpBase={x:avataror.originX()+dx,y:avataror.originBottomY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x-newSize<0){newSize=anchor.x}if(anchor.y+newSize>avataror.imgheight){newSize=avataror.imgheight-anchor.y}avataror.x=anchor.x-newSize;avataror.width=avataror.height=newSize};avataror.resizeHandlers=[avataror.nwHandler,avataror.neHandler,avataror.seHandler,avataror.swHandler]})};;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/Avatar.js' */
JIRA.Avatar=Class.extend({init:function(options){this._id=options.id;this._isSystemAvatar=options.isSystemAvatar;this._isSelected=options.isSelected;this._urls=options.urls},setUnSelected:function(){this._isSelected=false},setSelected:function(){this._isSelected=true},isSelected:function(){return !!this._isSelected},isSystemAvatar:function(){return this._isSystemAvatar},getId:function(){return this._id},getUrl:function(size){return this._urls[size]},toJSON:function(){return{id:this._id,isSystemAvatar:this._isSystemAvatar,isSelected:this._isSelected,urls:this._urls}}});JIRA.Avatar.createCustomAvatar=function(descriptor){descriptor.isSystemAvatar=false;return new JIRA.Avatar(descriptor)};JIRA.Avatar.createSystemAvatar=function(descriptor){descriptor.isSystemAvatar=true;return new JIRA.Avatar(descriptor)};JIRA.Avatar.getSizeObjectFromName=function(name){if("object"===typeof name){return name}var nameTrimmed="string"===typeof name?jQuery.trim(name):"";if(JIRA.Avatar.LARGE.param===name){return JIRA.Avatar.LARGE}else{if(JIRA.Avatar.MEDIUM.param===name){return JIRA.Avatar.MEDIUM}else{if(JIRA.Avatar.SMALL.param===name){return JIRA.Avatar.SMALL}else{if("xsmall"===name){return JIRA.Avatar.SMALL}else{return JIRA.Avatar.LARGE}}}}};JIRA.Avatar.LARGE={param:"large",height:48,width:48};JIRA.Avatar.MEDIUM={param:"medium",width:32,height:32};JIRA.Avatar.SMALL={param:"small",width:16,height:16};;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarManager.js' */
JIRA.AvatarManager=Class.extend({init:function(options){this.store=options.store;this.ownerId=options.ownerId;this.username=options.username;this.anonymousAvatarId=options.anonymousAvatarId;this.avatarSrcBaseUrl=options.avatarSrcBaseUrl},selectAvatar:function(avatar,options){return this.store.selectAvatar(avatar,options)},getById:function(id){return this.store.getById(id)},destroy:function(avatar,options){this.store.destroy(avatar,options)},update:function(avatar,options){this.store.update(avatar,options)},add:function(avatar,options){this.store._add(avatar,options)},getAllSystemAvatars:function(){return this.store.getAllSystemAvatars()},getAllCustomAvatars:function(){return this.store.getAllCustomAvatars()},getSelectedAvatar:function(){return this.store.getSelectedAvatar()},getAllAvatars:function(){return this.store.getAllAvatars()},getAllAvatarsRenderData:function(size){var i,instance=this,avatars=this.getAllAvatars(),renderData={system:[],custom:[]};for(i=0;i<avatars.system.length;i++){renderData.system.push(instance.getAvatarRenderData(avatars.system[i],size))}for(i=0;i<avatars.custom.length;i++){renderData.custom.push(instance.getAvatarRenderData(avatars.custom[i],size))}return renderData},getAvatarRenderData:function(avatar,size){var data=avatar.toJSON();data.src=this.getAvatarSrc(avatar,size);data.width=size.width;data.height=size.height;return data},refreshStore:function(options){this.store.refresh(options)},getAvatarSrc:function(avatar,size){if(this.store.isTempAvatar(avatar)){return contextPath+"/secure/temporaryavatar?"+jQuery.param({cropped:true,magic:new Date().getTime(),size:size.param})}return avatar.getUrl(AJS.format("{0}x{1}",size.height,size.width))},createTemporaryAvatar:function(field,options){this.store.createTemporaryAvatar(field,options)},createAvatarFromTemporary:function(instructions,options){this.store.createAvatarFromTemporary(instructions,options)},getAnonymousAvatarId:function(){return this.anonymousAvatarId}});JIRA.AvatarManager.createUniversalAvatarManager=function(options){var restQueryUrl,restUpdateUrl="",restCreateTempUrl="",restUpdateTempUrl="",restSingleAvatarUrl="";if(options.projectId){var urlAvatarOwnerPrefix=contextPath+"/rest/api/latest/universal_avatar/type/"+options.avatarType+"/owner/"+options.projectId;restQueryUrl=urlAvatarOwnerPrefix;var avatarCreateUrl=urlAvatarOwnerPrefix+"/avatar";restUpdateUrl=null;restCreateTempUrl=urlAvatarOwnerPrefix+"/temp";restUpdateTempUrl=avatarCreateUrl;restSingleAvatarUrl=avatarCreateUrl}else{restQueryUrl=contextPath+"/rest/api/latest/avatar/project/system";restCreateTempUrl=contextPath+"/rest/api/latest/avatar/project/temporary";restUpdateTempUrl=contextPath+"/rest/api/latest/avatar/project/temporaryCrop"}var store=new JIRA.AvatarStore({restQueryUrl:restQueryUrl,restUpdateUrl:restUpdateUrl,restCreateTempUrl:restCreateTempUrl,restUpdateTempUrl:restUpdateTempUrl,restSingleAvatarUrl:restSingleAvatarUrl,defaultAvatarId:options.defaultAvatarId});return new JIRA.AvatarManager({store:store,ownerId:options.projectId,avatarSrcBaseUrl:contextPath+"/secure/projectavatar"})};JIRA.AvatarManager.createProjectAvatarManager=function(options){options.avatarType="project";return JIRA.AvatarManager.createUniversalAvatarManager(options)};JIRA.AvatarManager.createUserAvatarManager=function(options){var userRestUrl=contextPath+"/rest/api/latest/user";var store=new JIRA.AvatarStore({restQueryUrl:userRestUrl+"/avatars",restUpdateUrl:userRestUrl+"/avatar",restCreateTempUrl:userRestUrl+"/avatar/temporary",restUpdateTempUrl:userRestUrl+"/avatar",restSingleAvatarUrl:userRestUrl+"/avatar",restParams:{"username":options.username},defaultAvatarId:options.defaultAvatarId});return new JIRA.AvatarManager({store:store,username:options.username,avatarSrcBaseUrl:contextPath+"/secure/useravatar"})};;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarStore.js' */
JIRA.AvatarStore=Class.extend({TEMP_ID:"TEMP",init:function(options){if(!options.restQueryUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restQueryUrl], The rest url for querying avatars (see class description)")}if(!options.restCreateTempUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restCreateTempUrl], The rest url for creating a temporary avatar (see class description)")}if(!options.restUpdateTempUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restUpdateTempUrl], The rest url for updating a temporary avatar (see class description)")}if(!options.defaultAvatarId){throw new Error("JIRA.AvatarStore.init: You must specify [defaultAvatarId] to the contructor so the store "+"knows what to select if you delete the selected one")}this.restQueryUrl=options.restQueryUrl;this.restUpdateUrl=options.restUpdateUrl;this.restCreateTempUrl=options.restCreateTempUrl;this.restUpdateTempUrl=options.restUpdateTempUrl;this.restSingleAvatarUrl=options.restSingleAvatarUrl;this.restParams=options.restParams||{};this.restParams.atl_token=atl_token();this.defaultAvatarId=options.defaultAvatarId;this.avatars={system:[],custom:[]}},_buildCompleteUrl:function(url){var completeUrl=url;if(this.restParams){var queryParams="";for(var name in this.restParams){queryParams+=AJS.format("&{0}={1}",encodeURIComponent(name),encodeURIComponent(this.restParams[name]))}completeUrl+=("?"+queryParams.substr(1))}return completeUrl},getById:function(avatarId){var match;jQuery.each(this.avatars.system,function(i,avatar){if(this.getId()===avatarId){match=avatar;return false}});if(!match){jQuery.each(this.avatars.custom,function(i,avatar){if(this.getId()===avatarId){match=avatar;return false}})}return match},isTempAvatar:function(avatar){return(avatar.getId()===this.TEMP_ID)},_selectAvatar:function(avatar){var selected=this.getSelectedAvatar();if(selected){selected.setUnSelected()}avatar.setSelected()},selectAvatar:function(avatar,options){var instance=this;if(!avatar){throw new Error("JIRA.AvatarStore.selectAvatar: Cannot select Avatar that does not exist")}if(this.restUpdateUrl){JIRA.SmartAjax.makeRequest({type:"PUT",contentType:"application/json",dataType:"json",url:this._buildCompleteUrl(this.restUpdateUrl),data:JSON.stringify(avatar.toJSON()),success:function(){instance._selectAvatar(avatar);if(options.success){options.success.call(this,avatar)}},error:options.error})}else{instance._selectAvatar(avatar);if(options.success){options.success.call(this,avatar)}}},_destory:function(avatar){var index=jQuery.inArray(avatar,this.avatars.custom);if(index!==-1){this.avatars.custom.splice(index,1)}else{throw new Error("JIRA.AvatarStore._destroy: Cannot remove avatar ["+avatar.getId()+"], "+"it might be a system avatar (readonly) or does not exist.")}},destroy:function(avatar,options){var instance=this;options=options||{};if(!avatar){throw new Error("JIRA.AvatarStore.destroy: Cannot delete Avatar that does not exist")}JIRA.SmartAjax.makeRequest({type:"DELETE",url:this.getRestUrlForAvatar(avatar),success:function(){instance._destory(avatar);if(avatar.isSelected()){instance.selectAvatar(instance.getById(instance.defaultAvatarId),options)}else{if(options.success){options.success.apply(this,arguments)}}},error:options.error})},getSelectedAvatar:function(){for(var i=0;i<this.avatars.custom.length;i++){if(this.avatars.custom[i].isSelected()){return this.avatars.custom[i]}}for(i=0;i<this.avatars.system.length;i++){if(this.avatars.system[i].isSelected()){return this.avatars.system[i]}}},_update:function(avatar){var instance=this;if(this.getById(avatar.getId())){jQuery.each(this.avatars.custom,function(i){if(this.getId()===avatar.getId()){instance.avatars.custom[i]=avatar}})}else{throw new Error("JIRA.AvatarStore._update: Cannot update avatar ["+avatar.getId()+"], "+"it might be a system avatar (readonly) or does not exist.")}},update:function(avatar,options){var instance=this;options=options||{};JIRA.SmartAjax.makeRequest({type:"PUT",url:this.getRestUrlForAvatar(avatar),error:options.error,success:function(){instance._update(avatar);if(options.success){options.success.apply(this,arguments)}}})},_add:function(avatar){if(avatar.isSystemAvatar()){this.avatars.system.push(avatar)}else{this.avatars.custom.push(avatar)}},createAvatarFromTemporary:function(instructions,options){var instance=this;options=options||{};if(this.restUpdateTempUrl){JIRA.SmartAjax.makeRequest({type:"POST",url:this._buildCompleteUrl(this.restUpdateTempUrl),data:JSON.stringify(instructions),contentType:"application/json",dataType:"json",success:function(data){if(!data){data={id:instance.TEMP_ID,isSelected:true}}var avatar=JIRA.Avatar.createCustomAvatar(data);instance._add(avatar);if(options.success){options.success.call(this,data)}},error:options.error})}},createTemporaryAvatar:function(fileInput,options){options=AJS.$.extend(true,{},options,{params:this.restParams});JIRA.AvatarUtil.uploadTemporaryAvatar(this.restCreateTempUrl,fileInput,options)},_refresh:function(avatars){var instance=this;instance.avatars.system=[];instance.avatars.custom=[];if(avatars.system){jQuery.each(avatars.system,function(i,descriptor){instance.avatars.system.push(JIRA.Avatar.createSystemAvatar(descriptor))})}if(avatars.custom){jQuery.each(avatars.custom,function(i,descriptor){instance.avatars.custom.push(JIRA.Avatar.createCustomAvatar(descriptor))})}},refresh:function(options){var instance=this;var tempAvatar=this.getById(instance.TEMP_ID);options=options||{};JIRA.SmartAjax.makeRequest({url:this._buildCompleteUrl(this.restQueryUrl),error:options.error,success:function(avatars){instance._refresh(avatars);if(tempAvatar){instance._add(tempAvatar)}if(options.success){options.success.apply(this,arguments)}}})},getAllAvatars:function(){return this.avatars},getAllSystemAvatars:function(){return this.avatars.system},getAllCustomAvatars:function(){return this.avatars.custom},getRestUrlForAvatar:function(avatar){return this._buildCompleteUrl(this.restSingleAvatarUrl+"/"+avatar.getId())}});;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarUtil.js' */
JIRA.AvatarUtil={uploadUsingIframeRemoting:function(url,field,options){options=options||{};var fileName=field.val(),form=new AJS.InlineAttach.Form(new AJS.InlineAttach.FileInput(field,false)),progress=form.addStaticProgress(fileName);var $oldInput=form.cloneFileInput();form.fileSelector.clear();var timer=new AJS.InlineAttach.Timer(function(){!this.cancelled&&progress.show()},this);var upload=new AJS.InlineAttach.FormUpload({$input:$oldInput,url:url,params:AJS.$.extend({},options.params,{filename:fileName,atl_token:atl_token()}),scope:this,before:function(){!this.cancelled&&progress.start()},success:function(val,status){if(val.errorMessages&&val.errorMessages.length){form.addErrorWithFileName(val.errorMessages[0],fileName,JIRA.AvatarUtil.getErrorTarget(form))}else{if(options.success){options.success(val,status)}}},error:function(text){console.log(text);if(this.cancelled){return }if(text.indexOf("SecurityTokenMissing")>=0){form.addError(AJS.InlineAttach.Text.tr("upload.xsrf.timeout",fileName),JIRA.AvatarUtil.getErrorTarget(form))}else{form.addError(AJS.InlineAttach.Text.tr("upload.error.unknown",fileName),JIRA.AvatarUtil.getErrorTarget(form))}},after:function(){timer.cancel();progress.remove();if(!this.cancelled){form.enable()}}});progress.onCancel(function(){upload.abort()});upload.upload()},uploadUsingFileApi:function(url,field,options){var timer,upload,cancelled,file=field[0].files[0],form=new AJS.InlineAttach.Form(new AJS.InlineAttach.FileInput(field,false)),progress=form.addProgress(file);options=options||{};timer=new AJS.InlineAttach.Timer(function(){if(!cancelled){progress.show()}});upload=new AJS.InlineAttach.AjaxUpload({file:file,params:AJS.$.extend({},options.params,{filename:file.name,size:file.size,atl_token:atl_token()}),scope:this,url:url,before:function(){field.hide();!cancelled&&progress.start()},progress:function(val){progress.progress.$progress.parent().parent().show();!cancelled&&progress.update(val)},success:function(val,status){if(cancelled){return }if(val.errorMessages&&val.errorMessages.length){form.addErrorWithFileName(val.errorMessages[0],file.name,JIRA.AvatarUtil.getErrorTarget(form))}else{if(status===201){options.success(val,status)}}},error:function(text,status){if(status<0){form.addError(text,JIRA.AvatarUtil.getErrorTarget(form))}else{form.addError(AJS.InlineAttach.Text.tr("upload.error.unknown",file.name),JIRA.AvatarUtil.getErrorTarget(form))}if(options.error){options.error(text,status)}},after:function(){timer.cancel();progress.finish().remove();field.val("").show()}});upload.upload();progress.onCancel(function(){upload.abort()})},getErrorTarget:function(form){return{$element:form.$form.find(".error")}},uploadTemporaryAvatar:function(url,field,options){if(AJS.InlineAttach.AjaxPresenter.isSupported(field)){this.uploadUsingFileApi(url,field,options)}else{this.uploadUsingIframeRemoting(url,field,options)}}};;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarPicker.js' */
JIRA.AvatarPicker=AJS.Control.extend({init:function(options){this.avatarManager=options.avatarManager;this.avatarRenderer=options.avatarRenderer;this.imageEditor=options.imageEditor;this.size=options.size;this.selectCallback=options.select;this.cropperDialog=null;this.initialSelection=options.initialSelection},render:function(ready){var instance=this;this.avatarManager.refreshStore({success:function(){if(instance.cropperDialog instanceof JIRA.Dialog){instance.cropperDialog.hide();delete instance.cropperDialog}instance.element=jQuery('<div id="jira-avatar-picker" />');instance.element.html(JIRA.Templates.AvatarPicker.picker({avatars:instance.avatarManager.getAllAvatarsRenderData(instance.size)}));instance._assignEvents("selectAvatar",instance.element.find(".jira-avatar button"));instance._assignEvents("deleteAvatar",instance.element.find(".jira-delete-avatar"));instance._assignEvents("uploader",instance.element.find("#jira-avatar-uploader"));if(undefined!=instance.initialSelection){instance.getAvatarElById(instance.initialSelection).addClass("jira-selected-avatar")}ready(instance.element)},error:function(xhr,error,textStatus,smartAjaxResult){instance.appendErrorContent(instance.element,smartAjaxResult);ready(instance.element)}})},appendErrorContent:function(el,smartAjaxResult){try{var errors=JSON.parse(smartAjaxResult.data);if(errors&&errors.errorMessages){jQuery.each(errors.errorMessages,function(i,message){AJS.messages.error(el,{body:AJS.escapeHTML(message),closeable:false,shadowed:false})})}else{el.append(JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult,true))}}catch(e){el.append(JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult,true))}},uploadTempAvatar:function(field){var instance=this;this.avatarManager.createTemporaryAvatar(field,{success:function(data){if(data.id){instance.render(function(){instance.selectAvatar(data.id)})}else{field.val("");instance.cropperDialog=new JIRA.Dialog({id:"project-avatar-cropper",width:560,content:function(ready){var $el=instance.imageEditor.render(data);instance.imageEditor.edit({confirm:function(instructions){instance.avatarManager.createAvatarFromTemporary(instructions,{success:function(data){instance.render(function(){instance.selectAvatar(data.id)})}})}});$el.find(".cancel").click(function(){instance.cropperDialog.hide()});ready($el)}});instance.cropperDialog.bind("dialogContentReady",function(){AJS.$(instance).trigger(JIRA.AvatarPicker.ImageEditor.LOADED)});instance.cropperDialog.bind("Dialog.hide",function(){AJS.$(instance).trigger(JIRA.AvatarPicker.ImageEditor.DISMISSED)});instance.cropperDialog.show()}},error:function(){console.log(arguments)}})},getAvatarElById:function(id){return this.element.find(".jira-avatar[data-id='"+id+"']")},selectAvatar:function(id){var avatar,instance=this;avatar=this.avatarManager.getById(id);this.avatarManager.selectAvatar(this.avatarManager.getById(id),{error:function(){},success:function(){instance.getAvatarElById(id).remove();if(instance.selectCallback){instance.selectCallback.call(instance,avatar,instance.avatarManager.getAvatarSrc(avatar,instance.size))}}})},deleteAvatar:function(id){var instance=this;if(confirm("Are you sure you want to delete avatar?")){this.avatarManager.destroy(this.avatarManager.getById(id),{error:function(){},success:function(){var selectedAvatar=instance.avatarManager.getSelectedAvatar(),$avatar=instance.getAvatarElById(id);$avatar.fadeOut(function(){$avatar.remove()});if(selectedAvatar.getId()!==id){instance.getAvatarElById(selectedAvatar.getId()).addClass("jira-selected-avatar");instance.selectCallback.call(instance,selectedAvatar,instance.avatarManager.getAvatarSrc(selectedAvatar,instance.size),true)}}})}},_events:{uploader:{change:function(e,el){this.uploadTempAvatar(el)}},deleteAvatar:{click:function(e,el){this.deleteAvatar(el.attr("data-id"))}},selectAvatar:{click:function(e,el){if(el[0].id==="select-avatar-button"){this.selectAvatar(el.attr("data-id"))}}}}});JIRA.AvatarPicker.ImageEditor=AJS.Control.extend({render:function(data){this.element=jQuery('<div id="avatar-picker-image-editor"/>').html(JIRA.Templates.AvatarPicker.imageEditor(data));return this.element},edit:function(options){var instance=this,avator=this.element.find(".avataror");options=options||{};avator.unbind();avator.bind("AvatarImageLoaded",function(){if(options.ready){options.ready()}});avator.find("img").load(function(){avator.avataror({previewElement:instance.element.find(".jira-avatar-cropper-header"),parent:instance.element})});this.element.find("#avataror").submit(function(e){e.preventDefault();if(options.confirm){options.confirm({cropperOffsetX:jQuery("#avatar-offsetX").val(),cropperOffsetY:jQuery("#avatar-offsetY").val(),cropperWidth:jQuery("#avatar-width").val()})}}).find(".cancel").click(function(e){e.preventDefault();if(options.cancel){options.cancel()}})}});JIRA.AvatarPicker.ImageEditor.LOADED="imageEditorLoaded";JIRA.AvatarPicker.ImageEditor.DISMISSED="imageEditorDismissed";JIRA.AvatarPicker.createUniversalAvatarPicker=function(options){return new JIRA.AvatarPicker({avatarManager:JIRA.AvatarManager.createUniversalAvatarManager({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId,avatarType:options.avatarType}),initialSelection:options.initialSelection,imageEditor:new JIRA.AvatarPicker.ImageEditor(),size:options.hasOwnProperty("avatarSize")?options.avatarSize:JIRA.Avatar.LARGE,select:options.select})};JIRA.AvatarPicker.createProjectAvatarPicker=function(options){return new JIRA.AvatarPicker({avatarManager:JIRA.AvatarManager.createProjectAvatarManager({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId}),imageEditor:new JIRA.AvatarPicker.ImageEditor(),size:JIRA.Avatar.LARGE,select:options.select})};JIRA.AvatarPicker.createUserAvatarPicker=function(options){return new JIRA.AvatarPicker({avatarManager:JIRA.AvatarManager.createUserAvatarManager({username:options.username,defaultAvatarId:options.defaultAvatarId}),imageEditor:new JIRA.AvatarPicker.ImageEditor(),size:JIRA.Avatar.LARGE,select:options.select})};JIRA.createUniversalAvatarPickerDialog=function(options){var lastSelection=options.initialSelection||options.defaultAvatarId;var projectAvatarDialog=new JIRA.FormDialog({trigger:options.trigger,id:"project-avatar-picker",width:560,stacked:true,content:function(ready){var avatarPicker,$dialogWrapper;$dialogWrapper=jQuery('<div id="projectavatar-content-wrapper"/>');jQuery("<h2 />").text(options.title||"Select a Project Avatar").appendTo($dialogWrapper);avatarPicker=JIRA.AvatarPicker.createUniversalAvatarPicker({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId,initialSelection:lastSelection,avatarType:options.avatarType,avatarSize:options.avatarSize,select:function(avatar,src,implicit){lastSelection=String(avatar.getId());if(options.select){options.select.apply(this,arguments)}if(!implicit){projectAvatarDialog.hide()}}});avatarPicker.render(function(content){$dialogWrapper.append(content);ready($dialogWrapper)})}});projectAvatarDialog._focusFirstField=function(){}};JIRA.createProjectAvatarPickerDialog=function(options){var projectAvatarDialog=new JIRA.FormDialog({trigger:options.trigger,id:"project-avatar-picker",width:560,stacked:true,content:function(ready){var avatarPicker,$dialogWrapper;$dialogWrapper=jQuery('<div id="projectavatar-content-wrapper"/>');jQuery("<h2 />").text("Select a Project Avatar").appendTo($dialogWrapper);avatarPicker=JIRA.AvatarPicker.createProjectAvatarPicker({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}if(!implicit){projectAvatarDialog.hide()}}});avatarPicker.render(function(content){$dialogWrapper.append(content);ready($dialogWrapper)})}});projectAvatarDialog._focusFirstField=function(){}};JIRA.createUserAvatarPickerDialog=function(options){var userAvatarDialog=new JIRA.FormDialog({trigger:options.trigger,id:"user-avatar-picker",width:560,stacked:true,content:function(ready){var avatarPicker,$dialogWrapper;$dialogWrapper=jQuery('<div id="useravatar-content-wrapper"/>');jQuery("<h2 />").text("Select a User Avatar").appendTo($dialogWrapper);avatarPicker=JIRA.AvatarPicker.createUserAvatarPicker({username:options.username,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}jQuery(".avatar-image").attr("src",src);if(!implicit){userAvatarDialog.hide()}}});avatarPicker.render(function(content){$dialogWrapper.append(content);ready($dialogWrapper)})}})};jQuery(function(){JIRA.createUserAvatarPickerDialog({trigger:"#user_avatar_image",username:jQuery("#avatar-owner-id").text(),defaultAvatarId:jQuery("#default-avatar-id").text()})});;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/GravatarUtil.js' */
(function(){AJS.namespace("JIRA.GravatarUtil");JIRA.GravatarUtil.showGravatarHelp=function(data){if(typeof (data)!=="undefined"&&typeof (data.entry)!=="undefined"){AJS.$(".gravatar-signup-text").addClass("hidden");AJS.$(".gravatar-login-text").removeClass("hidden")}};var displayGravatarHelp=function(){var gravatarJsonUrl=AJS.$("#gravatar_json_url");if(gravatarJsonUrl.length){AJS.$.ajax(gravatarJsonUrl.val(),{dataType:"jsonp",success:JIRA.GravatarUtil.showGravatarHelp})}};AJS.$(document).ready(function(){if(AJS.$("#gravatar_help_params")){displayGravatarHelp()}})}());;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarPicker.soy' */
// This file was automatically generated from AvatarPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.AvatarPicker == 'undefined') { JIRA.Templates.AvatarPicker = {}; }


JIRA.Templates.AvatarPicker.picker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="jira-avatar-upload-form" action="#"><input name="id" value="10000" type="hidden" ><input name="pid" value="10000" type="hidden" ><div class="field-group"><label for="jira-avatar-uploader">', soy.$$escapeHtml("Upload a new avatar"), '</label><input type="file" class="ignore-inline-attach" name="avatar" id="jira-avatar-uploader"/><div class="error"></div></div></form><div class="form-body"><ul class="jira-avatars">');
  var avatarList6 = opt_data.avatars.system;
  var avatarListLen6 = avatarList6.length;
  for (var avatarIndex6 = 0; avatarIndex6 < avatarListLen6; avatarIndex6++) {
    var avatarData6 = avatarList6[avatarIndex6];
    output.append('<li class="jira-avatar jira-system-avatar ', (avatarData6.isSelected) ? 'jira-selected-avatar' : '', '" title="Select this Avatar" data-id="', soy.$$escapeHtml(avatarData6.id), '"><button id="select-avatar-button" data-id="', soy.$$escapeHtml(avatarData6.id), '" class="jira-icon-button" title="', soy.$$escapeHtml("Select this Avatar"), '"><img id="avatar-', soy.$$escapeHtml(avatarData6.id), '" src="', soy.$$escapeHtml(avatarData6.src), '" width="', soy.$$escapeHtml(avatarData6.width), '" height="', soy.$$escapeHtml(avatarData6.height), '" alt="', soy.$$escapeHtml("Select this Avatar"), '"/></button></li>');
  }
  var avatarList29 = opt_data.avatars.custom;
  var avatarListLen29 = avatarList29.length;
  for (var avatarIndex29 = 0; avatarIndex29 < avatarListLen29; avatarIndex29++) {
    var avatarData29 = avatarList29[avatarIndex29];
    output.append('<li class="jira-avatar jira-custom-avatar ', (avatarData29.isSelected) ? 'jira-selected-avatar' : '', '" title="Select this avatar" data-id="', soy.$$escapeHtml(avatarData29.id), '"><button id="select-avatar-button" data-id="', soy.$$escapeHtml(avatarData29.id), '" class="jira-icon-button" title="', soy.$$escapeHtml("Select this Avatar"), '"><img id="avatar-', soy.$$escapeHtml(avatarData29.id), '" src="', soy.$$escapeHtml(avatarData29.src), '" width="', soy.$$escapeHtml(avatarData29.width), '" height="', soy.$$escapeHtml(avatarData29.height), '" alt="', soy.$$escapeHtml("Select this Avatar"), '" /></span><button class="jira-delete-avatar jira-icon-button" data-id="', soy.$$escapeHtml(avatarData29.id), '" title="', soy.$$escapeHtml("Delete this Avatar"), '">', soy.$$escapeHtml("Delete this Avatar"), '</button></li>');
  }
  output.append('</ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.AvatarPicker.imageEditor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form id="avataror" class="jira-avatar-cropper-form aui" action="/jira/secure/project/AvatarPicker.jspa"><input type="hidden" name="cropperOffsetX" id="avatar-offsetX" value="', soy.$$escapeHtml(opt_data.cropperOffsetX), '"><input type="hidden" name="cropperOffsetY" id="avatar-offsetY" value="', soy.$$escapeHtml(opt_data.cropperOffsetY), '"><input type="hidden" name="cropperWidth" id="avatar-width"  value="', soy.$$escapeHtml(opt_data.cropperWidth), '"><div class="jira-avatar-cropper-header"><p>', soy.$$escapeHtml("Please select which part of the uploaded image you wish to use as the avatar."), '</p></div><div class="form-body"><div class="avataror"><img src="', soy.$$escapeHtml(opt_data.url), '" height="300" /></div></div><div class="form-footer buttons-container"><div class="buttons"><input type="submit" class="aui-button" value="', soy.$$escapeHtml("Confirm"), '"><a class="aui-button aui-button-link cancel" href="#">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'jira.webresources:avatar-picker-trigger', location = '/includes/jira/admin/initAvatarPickerTrigger.js' */
(function(){var AvatarPickerContentRetriever=AJS.ContentRetriever.extend({init:function(avatarPicker){this.avatarPicker=avatarPicker},content:function(finished){this.avatarPicker.render(function(el){finished(jQuery("<div />").html(el))})},cache:function(){return false},isLocked:function(){},startingRequest:function(){},finishedRequest:function(){}});var InlineAvatarPicker=AJS.InlineLayer.extend({init:function(options){var instance=this;this.avatarPicker=JIRA.AvatarPicker.createProjectAvatarPicker({projectId:options.projectId,projectKey:options.projectKey,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}if(!implicit){instance.hide()}instance.offsetTarget().attr("src",src);instance.offsetTarget().trigger("AvatarSelected")}});options.contentRetriever=new AvatarPickerContentRetriever(this.avatarPicker);jQuery(this.avatarPicker.imageEditor).bind(JIRA.AvatarPicker.ImageEditor.LOADED,function(){instance.setWidth(instance.layer().attr("scrollWidth"))});this._super(options);var $triggerImg=this.offsetTarget();var $triggerContainer=jQuery("<span class='jira-avatar-picker-trigger'></span>");$triggerContainer.insertBefore($triggerImg).append($triggerImg);this._assignEvents("offsetTarget",$triggerContainer)},_events:{offsetTarget:{click:function(e){this.show()}}}});function initProjectAvatarPicker(ctx){var trigger=jQuery(".jira-avatar-picker-trigger");var triggerImg=jQuery(".jira-avatar-picker-trigger img, img.jira-avatar-picker-trigger",ctx);var avatarIdField=jQuery(ctx).find("#avatar-picker-avatar-id");var avatarIconurlField=jQuery(ctx).find("#avatar-picker-iconurl");var avatarTypeElement=jQuery(ctx).find("#avatar-type");if(""===avatarTypeElement.text()){return }JIRA.createUniversalAvatarPickerDialog({trigger:trigger,title:jQuery(ctx).find("#avatar-dialog-title").text(),projectId:jQuery(ctx).find("#avatar-owner-id").text(),projectKey:jQuery(ctx).find("#avatar-owner-key").text(),defaultAvatarId:jQuery(ctx).find("#default-avatar-id").text(),initialSelection:avatarIdField.val(),avatarSize:JIRA.Avatar.getSizeObjectFromName(jQuery(ctx).find("#avatar-size").text()),avatarType:avatarTypeElement.text(),select:function(avatar,src){triggerImg.attr("src",src);avatarIconurlField.val(src);avatarIdField.val(avatar.getId())}})}function initProjectInlineAvatarPicker(ctx){var $triggerImg=jQuery(".jira-inline-avatar-picker-trigger",ctx);if($triggerImg.length){new InlineAvatarPicker({offsetTarget:$triggerImg,projectId:jQuery(ctx).find("#avatar-owner-id").text(),projectKey:jQuery(ctx).find("#avatar-owner-key").text(),defaultAvatarId:jQuery(ctx).find("#default-avatar-id").text(),alignment:AJS.LEFT,width:420,allowDownsize:true})}}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initProjectAvatarPicker(context);initProjectInlineAvatarPicker(context)}})})();;
;/* module-key = 'jira.webresources:croneditor', location = '/includes/js/cron/croneditor.js' */
function hideCronEdit(elementid){document.getElementById(elementid).style.display="none"}function showCronEdit(elementid){document.getElementById(elementid).style.display=""}function toggleFrequencyControl(paramPrefix,setOriginal){var select=document.getElementById(paramPrefix+"interval");if(select.value==0){switchToOnce(paramPrefix,setOriginal)}else{switchToMany(paramPrefix,setOriginal)}}function switchToOnce(paramPrefix,setOriginal){hideCronEdit(paramPrefix+"runMany");showCronEdit(paramPrefix+"runOnce");if(setOriginal){timesOnce[paramPrefix]=true}}function switchToMany(paramPrefix,setOriginal){hideCronEdit(paramPrefix+"runOnce");showCronEdit(paramPrefix+"runMany");if(setOriginal){timesOnce[paramPrefix]=false}}function switchToDaysOfMonth(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");showCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");hideCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOnce(paramPrefix,false)}function switchToDaysOfWeek(paramPrefix){showCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOriginal(paramPrefix)}function switchToDaily(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOriginal(paramPrefix)}function switchToAdvanced(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");hideCronEdit(paramPrefix+"runOnce");hideCronEdit(paramPrefix+"runMany");hideCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"advanced")}function switchToOriginal(paramPrefix){if(timesOnce[paramPrefix]){switchToOnce(paramPrefix,false)}else{switchToMany(paramPrefix,false)}};;
;/* module-key = 'jira.webresources:calendar', location = '/includes/lib/calendar/Calendar.js' */
Calendar=function(firstDayOfWeek,dateStr,onSelected,onClose){this.activeDiv=null;this.currentDateEl=null;this.getDateStatus=null;this.getDateToolTip=null;this.getDateText=null;this.timeout=null;this.onSelected=onSelected||null;this.onClose=onClose||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT["DEF_DATE_FORMAT"];this.ttDateFormat=Calendar._TT["TT_DATE_FORMAT"];this.isPopup=true;this.weekNumbers=true;this.firstDayOfWeek=typeof firstDayOfWeek=="number"?firstDayOfWeek:Calendar._FD;this.showsOtherMonths=false;this.dateStr=dateStr;this.ar_days=null;this.showsTime=false;this.time24=true;this.yearStep=2;this.hiliteToday=true;this.multiple=null;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined"){Calendar._SDN_len=3}var ar=new Array();for(var i=8;i>0;){ar[--i]=Calendar._DN[i].substr(0,Calendar._SDN_len)}Calendar._SDN=ar;if(typeof Calendar._SMN_len=="undefined"){Calendar._SMN_len=3}ar=new Array();for(var i=12;i>0;){ar[--i]=Calendar._MN[i].substr(0,Calendar._SMN_len)}Calendar._SMN=ar}};Calendar._C=null;Calendar.is_ie=(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent));Calendar.is_ie5=(Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent));Calendar.is_ie6=(Calendar.is_ie&&/msie 6\.0/i.test(navigator.userAgent));Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.getAbsolutePos=function(el){var coords=jQuery(el).offset();coords.x=coords.left;coords.y=coords.top;return coords};Calendar.isRelated=function(el,evt){var related=evt.relatedTarget;if(!related){var type=evt.type;if(type=="mouseover"){related=evt.fromElement}else{if(type=="mouseout"){related=evt.toElement}}}while(related){if(related==el){return true}related=related.parentNode}return false};Calendar.removeClass=function(el,className){if(!(el&&el.className)){return }var cls=el.className.split(" ");var ar=new Array();for(var i=cls.length;i>0;){if(cls[--i]!=className){ar[ar.length]=cls[i]}}el.className=ar.join(" ")};Calendar.addClass=function(el,className){Calendar.removeClass(el,className);el.className+=" "+className};Calendar.getElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.currentTarget;while(f.nodeType!=1||/^div$/i.test(f.tagName)){f=f.parentNode}return f};Calendar.getTargetElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.target;while(f.nodeType!=1){f=f.parentNode}return f};Calendar.stopEvent=function(ev){if(!ev){ev=window.event}if(ev.stopPropagation){ev.preventDefault();ev.stopPropagation()}else{ev.cancelBubble=true;ev.returnValue=false}return false};Calendar.addEvent=function(el,evname,func){if(el.attachEvent){el.attachEvent("on"+evname,func)}else{if(el.addEventListener){el.addEventListener(evname,func,true)}else{el["on"+evname]=func}}};Calendar.removeEvent=function(el,evname,func){if(el.detachEvent){el.detachEvent("on"+evname,func)}else{if(el.removeEventListener){el.removeEventListener(evname,func,true)}else{el["on"+evname]=null}}};Calendar.createElement=function(type,parent){var el=null;if(document.createElementNS){el=document.createElementNS("http://www.w3.org/1999/xhtml",type)}else{el=document.createElement(type)}if(typeof parent!="undefined"){parent.appendChild(el)}return el};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true)}}};Calendar.findMonth=function(el){if(typeof el.month!="undefined"){return el}else{if(typeof el.parentNode.month!="undefined"){return el.parentNode}}return null};Calendar.findYear=function(el){if(typeof el.year!="undefined"){return el}else{if(typeof el.parentNode.year!="undefined"){return el.parentNode}}return null};Calendar.showMonthsCombo=function(){var cal=Calendar._C;if(!cal){return false}var cal=cal;var cd=cal.activeDiv;var mc=cal.monthsCombo;if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}if(cal.activeMonth){Calendar.removeClass(cal.activeMonth,"active")}var mon=cal.monthsCombo.getElementsByTagName("div")[cal.date.getMonth()];Calendar.addClass(mon,"active");cal.activeMonth=mon;var s=mc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px"}else{var mcw=mc.offsetWidth;if(typeof mcw=="undefined"){mcw=50}s.left=(cd.offsetLeft+cd.offsetWidth-mcw)+"px"}s.top=(cd.offsetTop+cd.offsetHeight)+"px"};Calendar.showYearsCombo=function(fwd){var cal=Calendar._C;if(!cal){return false}var cal=cal;var cd=cal.activeDiv;var yc=cal.yearsCombo;if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}if(cal.activeYear){Calendar.removeClass(cal.activeYear,"active")}cal.activeYear=null;var Y=cal.date.getFullYear()+(fwd?1:-1);var yr=yc.firstChild;var show=false;for(var i=12;i>0;--i){if(Y>=cal.minYear&&Y<=cal.maxYear){yr.innerHTML=Y;yr.year=Y;yr.style.display="block";show=true}else{yr.style.display="none"}yr=yr.nextSibling;Y+=fwd?cal.yearStep:-cal.yearStep}if(show){var s=yc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px"}else{var ycw=yc.offsetWidth;if(typeof ycw=="undefined"){ycw=50}s.left=(cd.offsetLeft+cd.offsetWidth-ycw)+"px"}s.top=(cd.offsetTop+cd.offsetHeight)+"px"}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal){return false}if(cal.timeout){clearTimeout(cal.timeout)}var el=cal.activeDiv;if(!el){return false}var target=Calendar.getTargetElement(ev);ev||(ev=window.event);Calendar.removeClass(el,"active");if(target==el||target.parentNode==el){Calendar.cellClick(el,ev)}var mon=Calendar.findMonth(target);var date=null;if(mon){date=new Date(cal.date);if(mon.month!=date.getMonth()){date.setMonth(mon.month);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}else{var year=Calendar.findYear(target);if(year){date=new Date(cal.date);if(year.year!=date.getFullYear()){date.setFullYear(year.year);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev)}};Calendar.tableMouseOver=function(ev){var cal=Calendar._C;if(!cal){return }var el=cal.activeDiv;var target=Calendar.getTargetElement(ev);if(target==el||target.parentNode==el){Calendar.addClass(el,"hilite active");Calendar.addClass(el.parentNode,"rowhilite")}else{if(typeof el.navtype=="undefined"||(el.navtype!=50&&(el.navtype==0||Math.abs(el.navtype)>2))){Calendar.removeClass(el,"active")}Calendar.removeClass(el,"hilite");Calendar.removeClass(el.parentNode,"rowhilite")}ev||(ev=window.event);if(el.navtype==50&&target!=el){var pos=Calendar.getAbsolutePos(el);var w=el.offsetWidth;var x=ev.clientX;var dx;var decrease=true;if(x>pos.x+w){dx=x-pos.x-w;decrease=false}else{dx=pos.x-x}if(dx<0){dx=0}var range=el._range;var current=el._current;var count=Math.floor(dx/10)%range.length;for(var i=range.length;--i>=0;){if(range[i]==current){break}}while(count-->0){if(decrease){if(--i<0){i=range.length-1}}else{if(++i>=range.length){i=0}}}var newval=range[i];el.innerHTML=newval;cal.onUpdateTime()}var mon=Calendar.findMonth(target);if(mon){if(mon.month!=cal.date.getMonth()){if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}Calendar.addClass(mon,"hilite");cal.hilitedMonth=mon}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}}}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}var year=Calendar.findYear(target);if(year){if(year.year!=cal.date.getFullYear()){if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}Calendar.addClass(year,"hilite");cal.hilitedYear=year}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}}}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}}}return Calendar.stopEvent(ev)};Calendar.tableMouseDown=function(ev){if(Calendar.getTargetElement(ev)==Calendar.getElement(ev)){return Calendar.stopEvent(ev)}};Calendar.calDragIt=function(ev){var cal=Calendar._C;if(!(cal&&cal.dragging)){return false}var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft}else{posX=ev.pageX;posY=ev.pageY}var st=cal.element.style;st.left=(posX-cal.xOffs)+"px";st.top=(posY-cal.yOffs)+"px";return Calendar.stopEvent(ev)};Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal){return false}cal.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev)}};Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el.disabled){return false}var cal=el.calendar;cal.activeDiv=el;Calendar._C=cal;if(el.navtype!=300){with(Calendar){if(el.navtype==50){el._current=el.innerHTML;addEvent(document,"mousemove",tableMouseOver)}else{addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver)}addClass(el,"hilite active");addEvent(document,"mouseup",tableMouseUp)}}else{if(cal.isPopup){cal._dragStart(ev)}}if(el.navtype==-1||el.navtype==1){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout("Calendar.showMonthsCombo()",250)}else{if(el.navtype==-2||el.navtype==2){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout((el.navtype>0)?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250)}else{cal.timeout=null}}return Calendar.stopEvent(ev)};Calendar.dayMouseDblClick=function(ev){Calendar.cellClick(Calendar.getElement(ev),ev||window.event);if(Calendar.is_ie){document.selection.empty()}};Calendar.dayMouseOver=function(ev){var el=Calendar.getElement(ev);if(Calendar.isRelated(el,ev)||Calendar._C||el.disabled){return false}if(el.ttip){if(el.ttip.substr(0,1)=="_"){el.ttip=el.caldate.print(el.calendar.ttDateFormat)+el.ttip.substr(1)}el.calendar.tooltips.innerHTML=el.ttip}if(el.navtype!=300){Calendar.addClass(el,"hilite");if(el.caldate){Calendar.addClass(el.parentNode,"rowhilite")}}return Calendar.stopEvent(ev)};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||el.disabled){return false}removeClass(el,"hilite");if(el.caldate){removeClass(el.parentNode,"rowhilite")}if(el.calendar){el.calendar.tooltips.innerHTML=_TT["SEL_DATE"]}return stopEvent(ev)}};Calendar.cellClick=function(el,ev){var cal=el.calendar;var closing=false;var newdate=false;var date=null;if(typeof el.navtype=="undefined"){if(cal.currentDateEl){Calendar.removeClass(cal.currentDateEl,"selected");Calendar.addClass(el,"selected");closing=(cal.currentDateEl==el);if(!closing){cal.currentDateEl=el}}cal.date.setDateOnly(el.caldate);date=cal.date;var other_month=!(cal.dateClicked=!el.otherMonth);if(!other_month&&!cal.currentDateEl){cal._toggleMultipleDate(new Date(date))}else{newdate=!el.disabled}if(other_month){cal._init(cal.firstDayOfWeek,date)}}else{if(el.navtype==200){Calendar.removeClass(el,"hilite");cal.callCloseHandler();return }date=new Date(cal.date);if(el.navtype==0){date.setDateOnly(new Date())}cal.dateClicked=false;var year=date.getFullYear();var mon=date.getMonth();function setMonth(m){var day=date.getDate();var max=date.getMonthDays(m);if(day>max){date.setDate(max)}date.setMonth(m)}switch(el.navtype){case 400:Calendar.removeClass(el,"hilite");var text=Calendar._TT["ABOUT"];if(typeof text!="undefined"){text+=cal.showsTime?Calendar._TT["ABOUT_TIME"]:""}else{text="Help and about box text is not translated into this language.\n"+"If you know this language and you feel generous please update\n"+'the corresponding file in "lang" subdir to match calendar-en.js\n'+"and send it back to <mihai_bazon@yahoo.com> to get it into the distribution  ;-)\n\n"+"Thank you!\n"+"http://dynarch.com/mishoo/calendar.epl\n"}alert(text);return ;case -2:if(year>cal.minYear){date.setFullYear(year-1)}break;case -1:if(mon>0){setMonth(mon-1)}else{if(year-->cal.minYear){date.setFullYear(year);setMonth(11)}}break;case 1:if(mon<11){setMonth(mon+1)}else{if(year<cal.maxYear){date.setFullYear(year+1);setMonth(0)}}break;case 2:if(year<cal.maxYear){date.setFullYear(year+1)}break;case 100:cal.setFirstDayOfWeek(el.fdow);return ;case 50:var range=el._range;var current=el.innerHTML;for(var i=range.length;--i>=0;){if(range[i]==current){break}}if(ev&&ev.shiftKey){if(--i<0){i=range.length-1}}else{if(++i>=range.length){i=0}}var newval=range[i];el.innerHTML=newval;cal.onUpdateTime();return ;case 0:if((typeof cal.getDateStatus=="function")&&cal.getDateStatus(date,date.getFullYear(),date.getMonth(),date.getDate())){return false}break}if(!date.equalsTo(cal.date)){cal.setDate(date);newdate=true}else{if(el.navtype==0){newdate=closing=true}}}if(newdate){ev&&cal.callHandler()}if(closing){Calendar.removeClass(el,"hilite");ev&&cal.callCloseHandler()}};Calendar.prototype.create=function(_par){var parent=null;if(!_par){parent=document.getElementsByTagName("body")[0];this.isPopup=true}else{parent=_par;this.isPopup=false}if(this.dateStr){this.date=new Date(this.dateStr)}if(!this.date||isNaN(this.date)){this.date=new Date()}var table=Calendar.createElement("table");this.table=table;table.cellSpacing=0;table.cellPadding=0;table.calendar=this;Calendar.addEvent(table,"mousedown",Calendar.tableMouseDown);var div=Calendar.createElement("div");this.element=div;div.className="calendar";if(this.isPopup){div.style.position="absolute";div.style.display="none"}div.appendChild(table);var thead=Calendar.createElement("thead",table);var cell=null;var row=null;var cal=this;var hh=function(text,cs,navtype){cell=Calendar.createElement("td",row);cell.colSpan=cs;cell.className="button";if(navtype!=0&&Math.abs(navtype)<=2){cell.className+=" nav"}Calendar._add_evs(cell);cell.calendar=cal;cell.navtype=navtype;cell.innerHTML="<div unselectable='on'>"+text+"</div>";return cell};row=Calendar.createElement("tr",thead);var title_length=6;(this.isPopup)&&--title_length;(this.weekNumbers)&&++title_length;hh("?",1,400).ttip=Calendar._TT["INFO"];this.title=hh("",title_length,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT["DRAG_TO_MOVE"];this.title.style.cursor="move";hh("&#x00d7;",1,200).ttip=Calendar._TT["CLOSE"]}row=Calendar.createElement("tr",thead);row.className="headrow";this._nav_py=hh("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT["PREV_YEAR"];this._nav_pm=hh("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT["PREV_MONTH"];this._nav_now=hh(Calendar._TT["TODAY"],this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT["GO_TODAY"];this._nav_nm=hh("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT["NEXT_MONTH"];this._nav_ny=hh("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT["NEXT_YEAR"];row=Calendar.createElement("tr",thead);row.className="daynames";if(this.weekNumbers){cell=Calendar.createElement("td",row);cell.className="name wn";cell.innerHTML=Calendar._TT["WK"]}for(var i=7;i>0;--i){cell=Calendar.createElement("td",row);if(!i){cell.navtype=100;cell.calendar=this;Calendar._add_evs(cell)}}this.firstdayname=(this.weekNumbers)?row.firstChild.nextSibling:row.firstChild;this._displayWeekdays();var tbody=Calendar.createElement("tbody",table);this.tbody=tbody;for(i=6;i>0;--i){row=Calendar.createElement("tr",tbody);if(this.weekNumbers){cell=Calendar.createElement("td",row)}for(var j=7;j>0;--j){cell=Calendar.createElement("td",row);cell.calendar=this;Calendar._add_evs(cell)}}if(this.showsTime){row=Calendar.createElement("tr",tbody);row.className="time";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;cell.innerHTML=Calendar._TT["TIME"]||"&nbsp;";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=this.weekNumbers?4:3;(function(){function makeTimePart(className,init,range_start,range_end){var part=Calendar.createElement("span",cell);part.className=className;part.innerHTML=init;part.calendar=cal;part.ttip=Calendar._TT["TIME_PART"];part.navtype=50;part._range=[];if(typeof range_start!="number"){part._range=range_start}else{for(var i=range_start;i<=range_end;++i){var txt;if(i<10&&range_end>=10){txt="0"+i}else{txt=""+i}part._range[part._range.length]=txt}}Calendar._add_evs(part);return part}var hrs=cal.date.getHours();var mins=cal.date.getMinutes();var t12=!cal.time24;var pm=(hrs>12);if(t12&&pm){hrs-=12}var H=makeTimePart("hour",hrs,t12?1:0,t12?12:23);var span=Calendar.createElement("span",cell);span.innerHTML=":";span.className="colon";var M=makeTimePart("minute",mins,0,59);var AP=null;cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;if(t12){AP=makeTimePart("ampm",pm?Calendar._TT["PM"]:Calendar._TT["AM"],[Calendar._TT["am"],Calendar._TT["pm"]])}else{cell.innerHTML="&nbsp;"}cal.onSetTime=function(){var pm,hrs=this.date.getHours(),mins=this.date.getMinutes();if(t12){pm=(hrs>=12);if(pm){hrs-=12}if(hrs==0){hrs=12}AP.innerHTML=pm?Calendar._TT["pm"]:Calendar._TT["am"]}H.innerHTML=(hrs<10)?("0"+hrs):hrs;M.innerHTML=(mins<10)?("0"+mins):mins};cal.onUpdateTime=function(){var date=this.date;var h=parseInt(H.innerHTML,10);if(t12){if(new RegExp(Calendar._TT["pm"],"i").test(AP.innerHTML)&&h<12){h+=12}else{if(new RegExp(Calendar._TT["am"],"i").test(AP.innerHTML)&&h==12){h=0}}}var d=date.getDate();var m=date.getMonth();var y=date.getFullYear();date.setHours(h);date.setMinutes(parseInt(M.innerHTML,10));date.setFullYear(y);date.setMonth(m);date.setDate(d);this.dateClicked=false;this.callHandler()}})()}else{this.onSetTime=this.onUpdateTime=function(){}}var tfoot=Calendar.createElement("tfoot",table);row=Calendar.createElement("tr",tfoot);row.className="footrow";cell=hh(Calendar._TT["SEL_DATE"],this.weekNumbers?8:7,300);cell.className="ttip";if(this.isPopup){cell.ttip=Calendar._TT["DRAG_TO_MOVE"];cell.style.cursor="move"}this.tooltips=cell;div=Calendar.createElement("div",this.element);this.monthsCombo=div;div.className="combo";for(i=0;i<Calendar._MN.length;++i){var mn=Calendar.createElement("div");mn.className=Calendar.is_ie?"label-IEfix":"label";mn.month=i;mn.innerHTML=Calendar._SMN[i];div.appendChild(mn)}div=Calendar.createElement("div",this.element);this.yearsCombo=div;div.className="combo";for(i=12;i>0;--i){var yr=Calendar.createElement("div");yr.className=Calendar.is_ie?"label-IEfix":"label";div.appendChild(yr)}this._init(this.firstDayOfWeek,this.date);parent.appendChild(this.element);Calendar.addEvent(this.element,"mousedown",function(ev){ev.preventDefault?ev.preventDefault():ev.returnValue=false})};Calendar._upkeyEvent=function(e){if(e.keyCode===27){window.setTimeout(function(){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple){return false}else{cal.callCloseHandler()}},0)}};Calendar._keyEvent=function(ev){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple){return false}var act=(Calendar.is_ie||ev.type=="keydown"),K=ev.keyCode;if(ev.ctrlKey){switch(K){case 37:act&&Calendar.cellClick(cal._nav_pm);break;case 38:act&&Calendar.cellClick(cal._nav_py);break;case 39:act&&Calendar.cellClick(cal._nav_nm);break;case 40:act&&Calendar.cellClick(cal._nav_ny);break}}else{switch(K){case 32:Calendar.cellClick(cal._nav_now);break;case 37:case 38:case 39:case 40:if(act){var prev,x,y,ne,el,step;prev=K==37||K==38;step=(K==37||K==39)?1:7;function setVars(){el=cal.currentDateEl;var p=el.pos;x=p&15;y=p>>4;ne=cal.ar_days[y][x]}setVars();function prevMonth(){var date=new Date(cal.date);date.setDate(date.getDate()-step);cal.setDate(date)}function nextMonth(){var date=new Date(cal.date);date.setDate(date.getDate()+step);cal.setDate(date)}while(1){switch(K){case 37:if(--x>=0){ne=cal.ar_days[y][x]}else{x=6;K=38;continue}break;case 38:if(--y>=0){ne=cal.ar_days[y][x]}else{prevMonth();setVars()}break;case 39:if(++x<7){ne=cal.ar_days[y][x]}else{x=0;K=40;continue}break;case 40:if(++y<cal.ar_days.length){ne=cal.ar_days[y][x]}else{nextMonth();setVars()}break}break}if(ne){if(!ne.disabled){Calendar.cellClick(ne)}else{if(prev){prevMonth()}else{nextMonth()}}}}break;case 13:if(act){Calendar.cellClick(cal.currentDateEl,ev)}break}}return Calendar.stopEvent(ev)};Calendar.prototype._init=function(firstDayOfWeek,seedDate){var date=new Date(seedDate);date.setHours(13);var today=new Date(),TY=today.getFullYear(),TM=today.getMonth(),TD=today.getDate();this.table.style.visibility="hidden";var year=date.getFullYear();if(year<this.minYear){year=this.minYear;date.setFullYear(year)}else{if(year>this.maxYear){year=this.maxYear;date.setFullYear(year)}}this.firstDayOfWeek=firstDayOfWeek;var month=date.getMonth();var mday=date.getDate();var no_days=date.getMonthDays();date.setDate(1);var day1=(date.getDay()-this.firstDayOfWeek)%7;if(day1<0){day1+=7}date.setDate(-day1);date.setDate(date.getDate()+1);var row=this.tbody.firstChild;var MN=Calendar._SMN[month];var ar_days=this.ar_days=new Array();var weekend=Calendar._TT["WEEKEND"];var dates=this.multiple?(this.datesCells={}):null;for(var i=0;i<6;++i,row=row.nextSibling){var cell=row.firstChild;if(this.weekNumbers){cell.className="day wn";var monthStartDate=date;if(month==0&&i==0&&Date.useISO8601WeekNumbers==false){monthStartDate=new Date(year,month,1)}cell.innerHTML=monthStartDate.getWeekNumber(this.firstDayOfWeek);cell=cell.nextSibling}row.className="daysrow";var hasdays=false,iday,dpos=ar_days[i]=[];for(var j=0;j<7;++j,cell=cell.nextSibling,date.setDate(iday+1)){iday=date.getDate();var wday=date.getDay();cell.className="day day-"+iday;cell.pos=i<<4|j;dpos[j]=cell;var current_month=(date.getMonth()==month);if(!current_month){if(this.showsOtherMonths){cell.className+=" othermonth";cell.otherMonth=true}else{cell.className="emptycell";cell.innerHTML="&nbsp;";cell.disabled=true;continue}}else{cell.otherMonth=false;hasdays=true}cell.disabled=false;cell.innerHTML=this.getDateText?this.getDateText(date,iday):iday;if(dates){dates[date.print("%Y%m%d")]=cell}if(this.getDateStatus){var status=this.getDateStatus(date,year,month,iday);if(this.getDateToolTip){var toolTip=this.getDateToolTip(date,year,month,iday);if(toolTip){cell.title=toolTip}}if(status===true){cell.className+=" disabled";cell.disabled=true}else{if(/disabled/i.test(status)){cell.disabled=true}cell.className+=" "+status}}if(!cell.disabled){cell.caldate=new Date(date);cell.ttip="_";if(!this.multiple&&current_month&&iday==mday&&this.hiliteToday){cell.className+=" selected";this.currentDateEl=cell}if(date.getFullYear()==TY&&date.getMonth()==TM&&iday==TD){cell.className+=" today";cell.ttip+=Calendar._TT["PART_TODAY"]}if(weekend.indexOf(wday.toString())!=-1){cell.className+=cell.otherMonth?" oweekend":" weekend"}}}if(!(hasdays||this.showsOtherMonths)){row.className="emptyrow"}}this.date=new Date(seedDate);this.onSetTime();this.title.innerHTML=Calendar._MN[month]+", "+year;this.table.style.visibility="visible";this._initMultipleDates()};Calendar.prototype._initMultipleDates=function(){if(this.multiple){for(var i in this.multiple){var cell=this.datesCells[i];var d=this.multiple[i];if(!d){continue}if(cell){cell.className+=" selected"}}}};Calendar.prototype._toggleMultipleDate=function(date){if(this.multiple){var ds=date.print("%Y%m%d");var cell=this.datesCells[ds];if(cell){var d=this.multiple[ds];if(!d){Calendar.addClass(cell,"selected");this.multiple[ds]=date}else{Calendar.removeClass(cell,"selected");delete this.multiple[ds]}}}};Calendar.prototype.setDateToolTipHandler=function(unaryFunction){this.getDateToolTip=unaryFunction};Calendar.prototype.setDate=function(date){if(!date.equalsTo(this.date)){this._init(this.firstDayOfWeek,date)}};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date)};Calendar.prototype.setFirstDayOfWeek=function(firstDayOfWeek){this._init(firstDayOfWeek,this.date);this._displayWeekdays()};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(unaryFunction){this.getDateStatus=unaryFunction};Calendar.prototype.setRange=function(a,z){this.minYear=a;this.maxYear=z};Calendar.prototype.callHandler=function(){if(this.onSelected){this.onSelected(this,this.date.print(this.dateFormat))}};Calendar.prototype.callCloseHandler=function(){if(this.onClose){this.onClose(this)}};Calendar.prototype.destroy=function(){var el=this.element.parentNode;el.removeChild(this.element);Calendar._C=null;window._dynarch_popupCalendar=null};Calendar.prototype.reparent=function(new_parent){var el=this.element;el.parentNode.removeChild(el);new_parent.appendChild(el)};Calendar._checkCalendar=function(ev){var calendar=window._dynarch_popupCalendar;if(!calendar){return false}var el=Calendar.is_ie?Calendar.getElement(ev):Calendar.getTargetElement(ev);for(;el!=null&&el!=calendar.element;el=el.parentNode){}if(el==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(ev)}};Calendar.prototype.show=function(){if(this.params.inputField.disabled){return }var rows=this.table.getElementsByTagName("tr");for(var i=rows.length;i>0;){var row=rows[--i];Calendar.removeClass(row,"rowhilite");var cells=row.getElementsByTagName("td");for(var j=cells.length;j>0;){var cell=cells[--j];Calendar.removeClass(cell,"hilite");Calendar.removeClass(cell,"active")}}Calendar.current=this;this.element.style.display="block";this.element.className+=" active";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keyup",Calendar._upkeyEvent);Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar)}};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keyup",Calendar._upkeyEvent);Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar)}Calendar.current=null;this.element.style.display="none";this.element.className=this.element.className.replace(/active/gi,"");this.hidden=true};Calendar.prototype.showAt=function(x,y){var s=this.element.style;s.left=x+"px";s.top=y+"px";this.show()};Calendar.prototype.showAtElement=function(el,opts){var self=this;var p=Calendar.getAbsolutePos(el);if(!opts||typeof opts!="string"){this.showAt(p.x,p.y+el.offsetHeight);return true}function fixPosition(box){if(box.x<0){box.x=0}if(box.y<0){box.y=0}var cp=document.createElement("div");var s=cp.style;s.position="absolute";s.right=s.bottom=s.width=s.height="0px";document.body.appendChild(cp);var br=Calendar.getAbsolutePos(cp);document.body.removeChild(cp);br.y+=jQuery(window).scrollTop();br.x+=jQuery(window).scrollLeft();var tmp=box.x+box.width-br.x;if(tmp>0){box.x-=tmp}tmp=box.y+box.height-br.y;if(tmp>0){box.y-=tmp}}this.element.style.display="block";Calendar.continuation_for_the_khtml_browser=function(){var w=jQuery(self.element).outerWidth();var h=jQuery(self.element).outerHeight();self.element.style.display="none";var valign=opts.substr(0,1);var halign="l";if(opts.length>1){halign=opts.substr(1,1)}switch(valign){case"T":p.y-=h;break;case"B":p.y+=jQuery(el).outerHeight();break;case"C":p.y+=(jQuery(el).outerHeight()-h)/2;break;case"t":p.y+=jQuery(el).outerHeight()-h;break;case"b":break}switch(halign){case"L":p.x-=w;break;case"R":p.x+=jQuery(el).outerWidth();break;case"C":p.x+=(jQuery(el).outerWidth()-w)/2;break;case"l":p.x+=jQuery(el).outerWidth()-w;break;case"r":break}p.width=w;p.height=h+40;self.monthsCombo.style.display="none";fixPosition(p);self.showAt(p.x,p.y)};Calendar.continuation_for_the_khtml_browser()};Calendar.prototype.setDateFormat=function(str){this.dateFormat=str};Calendar.prototype.setTtDateFormat=function(str){this.ttDateFormat=str};Calendar.prototype.parseDate=function(str,fmt){if(!fmt){fmt=this.dateFormat}this.setDate(Date.parseDate(str,fmt))};Calendar.prototype._displayWeekdays=function(){var fdow=this.firstDayOfWeek;var cell=this.firstdayname;var weekend=Calendar._TT["WEEKEND"];for(var i=0;i<7;++i){cell.className="day name";var realday=(i+fdow)%7;if(i){cell.ttip=Calendar._TT["DAY_FIRST"].replace("%s",Calendar._DN[realday]);cell.navtype=100;cell.calendar=this;cell.fdow=realday;Calendar._add_evs(cell)}if(weekend.indexOf(realday.toString())!=-1){Calendar.addClass(cell,"weekend")}cell.innerHTML=Calendar._SDN[(i+fdow)%7];cell=cell.nextSibling}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none"};Calendar.prototype._dragStart=function(ev){if(this.dragging){return }this.dragging=true;var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft}else{posY=ev.clientY+window.scrollY;posX=ev.clientX+window.scrollX}var st=this.element.style;this.xOffs=posX-parseInt(st.left);this.yOffs=posY-parseInt(st.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd)}};Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1000;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date._multisplit=function(s,seps){if(s==null){return null}if(seps==null){seps=""}var arr=[];var len=s.length;var token="";var inWord=false;for(i=0;i<len;i++){var c=s.charAt(i);if(seps.indexOf(c)==-1){inWord=true;token+=c}else{if(inWord){arr[arr.length]=token;token="";inWord=false}}}if(token.length>0){arr[arr.length]=token}if(arr.length==0){arr[arr.length]=""}return arr};Date._parseNonDateFormatChars=function(s){var magicChars="aAbBCdeHIJklmMnpPRSstUWVuwyY%";var nonMagicChars="";var len=s.length;var inMagic=false;for(i=0;i<len;i++){var c=s.charAt(i);if(c=="%"){var peekc="";if(i+1<len){peekc=s.charAt(i+1)}i=i+1;if(peekc.length>0&&magicChars.indexOf(peekc)!=-1){continue}else{if(nonMagicChars.indexOf(c)==-1){nonMagicChars+=c}if(peekc.length>0&&nonMagicChars.indexOf(peekc)==-1){nonMagicChars+=peekc}}}else{if(nonMagicChars.indexOf(c)==-1){nonMagicChars+=c}}}return nonMagicChars};Date.parseDate=function(str,fmt){var today=new Date();var y=0;var m=-1;var d=0;var seps=Date._parseNonDateFormatChars(fmt);var a=Date._multisplit(str,seps);var b=fmt.match(/%./g);var i=0,j=0;var hr=0;var min=0;for(i=0;i<a.length;++i){if(!a[i]){continue}switch(b[i]){case"%d":case"%e":d=parseInt(a[i],10);break;case"%m":m=parseInt(a[i],10)-1;break;case"%Y":case"%y":y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);break;case"%b":case"%B":var monthName=a[i].toLowerCase();var found=false;if(b[i]=="%b"){for(j=0;j<12;++j){if(Calendar._SMN[j].substr(0,monthName.length).toLowerCase()==monthName){m=j;found=true;break}}}if(!found){for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,monthName.length).toLowerCase()==monthName){m=j;break}}}break;case"%H":case"%I":case"%k":case"%l":hr=parseInt(a[i],10);break;case"%P":case"%p":if(/pm/i.test(a[i])&&hr<12){hr+=12}else{if(/am/i.test(a[i])&&hr>=12){hr-=12}}break;case"%M":min=parseInt(a[i],10);break;case"%R":var hrMinString=a[i];var hrMinSeparator=hrMinString.indexOf(":");var hrString=hrMinString.substring(0,hrMinSeparator);var minString=hrMinSeparator==-1?0:hrMinString.substring(hrMinSeparator+1);hr=parseInt(hrString,10);min=parseInt(minString,10);break}}if(isNaN(y)){y=today.getFullYear()}if(isNaN(m)){m=today.getMonth()}if(isNaN(d)){d=today.getDate()}if(isNaN(hr)){hr=today.getHours()}if(isNaN(min)){min=today.getMinutes()}if(y!=0&&m!=-1&&d!=0){return new Date(y,m,d,hr,min,0)}y=0;m=-1;d=0;for(i=0;i<a.length;++i){if(a[i].search(/[a-zA-Z]+/)!=-1){var t=-1;for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){t=j;break}}if(t!=-1){if(m!=-1){d=m+1}m=t}}else{if(parseInt(a[i],10)<=12&&m==-1){m=a[i]-1}else{if(parseInt(a[i],10)>31&&y==0){y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000)}else{if(d==0){d=a[i]}}}}}if(y==0){y=today.getFullYear()}if(m!=-1&&d!=0){return new Date(y,m,d,hr,min,0)}return today};Date.prototype.getMonthDays=function(month){var year=this.getFullYear();if(typeof month=="undefined"){month=this.getMonth()}if(((0==(year%4))&&((0!=(year%100))||(0==(year%400))))&&month==1){return 29}else{return Date._MD[month]}};Date.prototype.getDayOfYear=function(){var now=new Date(this.getFullYear(),this.getMonth(),this.getDate(),13,0,0);var then=new Date(this.getFullYear(),0,0,13,0,0);var time=now-then;return Math.floor(time/Date.DAY)};Date.prototype.getWeekNumber=function(startOfWeek){if(Date.useISO8601WeekNumbers){return this.getISO8601WeekNumber()}else{return this.getSimpleWeekNumber(startOfWeek)}};Date.prototype.getISO8601WeekNumber=function(){function gregdaynumber(year,month,day){y=year;m=month;if(month<3){y=y-1}if(month<3){m=m+12}return Math.floor(365.25*y)-Math.floor(y/100)+Math.floor(y/400)+Math.floor(30.6*(m+1))+day-62}function isocalendar1(date){year=date.getFullYear();month=date.getMonth();day=date.getDate();wday=date.getDay();weekday=((wday+6)%7)+1;isoyear=year;d0=gregdaynumber(year,1,0);weekday0=((d0+4)%7)+1;d=gregdaynumber(year,month+1,day);isoweeknr=Math.floor((d-d0+weekday0+6)/7)-Math.floor((weekday0+3)/7);if((month==11)&&((day-weekday)>27)){isoweeknr=1;isoyear=isoyear+1}if((month==0)&&((weekday-day)>3)){d0=gregdaynumber(year-1,1,0);weekday0=((d0+4)%7)+1;isoweeknr=Math.floor((d-d0+weekday0+6)/7)-Math.floor((weekday0+3)/7);isoyear=isoyear-1}return isoweeknr}return isocalendar1(this)};Date.prototype.getSimpleWeekNumber=function(startOfWeek){function OddWkNo1(D,d1,d2){var Yr=D.getFullYear(),Jan1=new Date(Yr,0,1),Q;Q=Math.round((D-Jan1)/86400000);if(d1!=null){Q-=(7+d1-Jan1.getDay())%7}if(d2!=null){Q+=d2}return[Yr,1+Q/7|0,1+(7+Q)%7]}return OddWkNo1(this,startOfWeek?startOfWeek:6,6)[1]};Date.prototype.equalsTo=function(date){return((this.getFullYear()==date.getFullYear())&&(this.getMonth()==date.getMonth())&&(this.getDate()==date.getDate())&&(this.getHours()==date.getHours())&&(this.getMinutes()==date.getMinutes()))};Date.prototype.setDateOnly=function(date){var tmp=new Date(date);this.setDate(1);this.setFullYear(tmp.getFullYear());this.setMonth(tmp.getMonth());this.setDate(tmp.getDate())};Date.prototype.print=function(str){var m=this.getMonth();var d=this.getDate();var y=this.getFullYear();var wn=this.getWeekNumber();var w=this.getDay();var s={};var hr=this.getHours();var pm=(hr>=12);var ir=(pm)?(hr-12):hr;var dy=this.getDayOfYear();if(ir==0){ir=12}var min=this.getMinutes();var sec=this.getSeconds();s["%a"]=Calendar._SDN[w];s["%A"]=Calendar._DN[w];s["%b"]=Calendar._SMN[m];s["%B"]=Calendar._MN[m];s["%C"]=1+Math.floor(y/100);s["%d"]=(d<10)?("0"+d):d;s["%e"]=d;s["%H"]=(hr<10)?("0"+hr):hr;s["%I"]=(ir<10)?("0"+ir):ir;s["%j"]=(dy<100)?((dy<10)?("00"+dy):("0"+dy)):dy;s["%k"]=hr;s["%l"]=ir;s["%m"]=(m<9)?("0"+(1+m)):(1+m);s["%M"]=(min<10)?("0"+min):min;s["%n"]="\n";s["%p"]=pm?Calendar._TT["PM"]:Calendar._TT["AM"];s["%P"]=pm?Calendar._TT["PM"]:Calendar._TT["AM"];s["%R"]=s["%k"]+":"+s["%M"];s["%s"]=Math.floor(this.getTime()/1000);s["%S"]=(sec<10)?("0"+sec):sec;s["%t"]="\t";s["%U"]=s["%W"]=s["%V"]=(wn<10)?("0"+wn):wn;s["%u"]=w+1;s["%w"]=w;s["%y"]=(""+y).slice(-2);s["%Y"]=y;s["%%"]="%";var re=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml){return str.replace(re,function(par){return s[par]||par})}var a=str.match(re);for(var i=0;i<a.length;i++){var tmp=s[a[i]];if(tmp){re=new RegExp(a[i],"g");str=str.replace(re,tmp)}}return str};Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(y){var d=new Date(this);d.__msh_oldSetFullYear(y);if(d.getMonth()!=this.getMonth()){this.setDate(28)}this.__msh_oldSetFullYear(y)};window._dynarch_popupCalendar=null;;
;/* module-key = 'jira.webresources:calendar', location = '/includes/lib/calendar/Calendar.setup.js' */
Calendar.setup=function(params){params=params||{};function param_default(pname,def){if(typeof params[pname]=="undefined"){params[pname]=def}}param_default("inputField",null);param_default("context",null);param_default("displayArea",null);param_default("button",null);param_default("eventName","click");param_default("ifFormat","%Y/%m/%d");param_default("daFormat","%Y/%m/%d");param_default("singleClick",true);param_default("disableFunc",null);param_default("dateStatusFunc",params["disableFunc"]);param_default("dateText",null);param_default("firstDay",null);param_default("align","Br");param_default("range",[1900,2999]);param_default("weekNumbers",true);param_default("useISO8601WeekNumbers",false);param_default("flat",null);param_default("flatCallback",null);param_default("onSelect",null);param_default("onClose",null);param_default("onUpdate",null);param_default("date",null);param_default("showsTime",false);param_default("timeFormat","24");param_default("electric",true);param_default("step",1);param_default("position",null);param_default("cache",false);param_default("showOthers",false);param_default("multiple",null);var i,item;var unwrap=["context","inputField","button","displayArea"];for(i in unwrap){item=unwrap[i];if(params[item] instanceof jQuery){params[item]=params[item][0]}}var tmp=["inputField","displayArea","button"];for(i in tmp){item=tmp[i];if(typeof params[item]==="string"){var escapedSelector="#"+params[item].escapejQuerySelector();var el=jQuery(params.context||document.body).find(escapedSelector);params[item]=el[0]}}if(!(params.flat||params.multiple||params.inputField||params.displayArea||params.button)){AJS.log("Calendar.setup:\n  Nothing to setup (no fields found).  Please check your code");return false}if(params.firstDay&&params.firstDay!==null){params.firstDay=+params.firstDay}function onSelect(cal){var p=cal.params;var update=(cal.dateClicked||p.electric);if(update&&p.inputField){p.inputField.value=cal.date.print(p.ifFormat);jQuery(p.inputField).change()}if(update&&p.displayArea){p.displayArea.innerHTML=cal.date.print(p.daFormat)}if(update&&typeof p.onUpdate=="function"){p.onUpdate(cal)}if(update&&p.flat){if(typeof p.flatCallback=="function"){p.flatCallback(cal)}}if(p.singleClick==="true"){p.singleClick=true}else{if(p.singleClick==="false"){p.singleClick=false}}if(update&&p.singleClick&&cal.dateClicked){cal.callCloseHandler()}}if(params.flat!=null){if(typeof params.flat=="string"){params.flat=document.getElementById(params.flat)}if(!params.flat){AJS.log("Calendar.setup:\n  Flat specified but can't find parent.");return false}var cal=new Calendar(params.firstDay,params.date,params.onSelect||onSelect);cal.showsOtherMonths=params.showOthers;cal.showsTime=params.showsTime;cal.time24=(params.timeFormat=="24");cal.params=params;cal.weekNumbers=params.weekNumbers;cal.setRange(params.range[0],params.range[1]);cal.setDateStatusHandler(params.dateStatusFunc);cal.getDateText=params.dateText;if(params.ifFormat){cal.setDateFormat(params.ifFormat)}if(params.inputField&&typeof params.inputField.value=="string"){cal.parseDate(params.inputField.value)}cal.create(params.flat);cal.show();return false}var triggerEl=params.button||params.displayArea||params.inputField;jQuery(triggerEl).bind(params.eventName,function(e){e.preventDefault();createCalendar()});if(params.inputField){enhanceInputField()}function createCalendar(){if(Calendar._UNSUPPORTED===true){alert("The JIRA Calendar does not currently support your language.");return }var dateEl=params.inputField||params.displayArea;var dateFmt=params.inputField?params.ifFormat:params.daFormat;var mustCreate=false;var cal=window.calendar;if(cal){cal.hide()}if(dateEl){if(dateEl.value||dateEl.innerHTML){params.date=Date.parseDate(dateEl.value||dateEl.innerHTML,dateFmt)}}if(!(cal&&params.cache)){window.calendar=cal=new Calendar(params.firstDay,params.date,params.onSelect||onSelect,params.onClose||function(cal){cal.hide()});cal.showsTime=params.showsTime;cal.time24=(params.timeFormat=="24");cal.weekNumbers=params.weekNumbers;Date.useISO8601WeekNumbers=params.useISO8601WeekNumbers;if(params.useISO8601WeekNumbers){cal.firstDayOfWeek=1}mustCreate=true}else{if(params.date){cal.setDate(params.date)}cal.hide()}if(params.multiple){cal.multiple={};for(var i=params.multiple.length;--i>=0;){var d=params.multiple[i];var ds=d.print("%Y%m%d");cal.multiple[ds]=d}}cal.showsOtherMonths=params.showOthers;cal.yearStep=params.step;cal.setRange(params.range[0],params.range[1]);cal.params=params;cal.setDateStatusHandler(params.dateStatusFunc);cal.getDateText=params.dateText;cal.setDateFormat(dateFmt);if(mustCreate){cal.create()}cal.refresh();if(!params.position){cal.showAtElement(params.button||params.displayArea||params.inputField,params.align)}else{cal.showAt(params.position[0],params.position[1])}return false}function enhanceInputField(){var $inputField=jQuery(params.inputField);if(params.button){jQuery(params.button).mousedown(function(e){e.preventDefault();if(!$inputField.is(":focus")&&$inputField.is(":enabled")){$inputField.focus()}})}$inputField.keydown(function(e){var cal=window.calendar;if(e.keyCode===40){if(!cal||cal.hidden){setTimeout(function(){createCalendar()},1)}}})}return cal};;
;/* module-key = 'jira.webresources:group-pickers', location = '/includes/jira/field/groupPickerUtil.js' */
JIRA.GroupPickerUtil={formatResponse:function(data){var ret=[];AJS.$(data).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.header});AJS.$(suggestions.groups).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.name,html:this.html,highlighted:true}))});ret.push(groupDescriptor)});return ret}};;
;/* module-key = 'jira.webresources:group-pickers', location = '/includes/jira/field/initMultiGroupPickers.js' */
(function(){function initMultiGroupPickers(ctx){ctx.find(".js-default-multi-group-picker").each(function(){var $el=jQuery(this);new AJS.MultiSelect({element:this,itemAttrDisplayed:"label",showDropdownButton:false,ajaxOptions:{data:function(query){return{query:query,exclude:$el.val()}},url:contextPath+"/rest/api/2/groups/picker",query:true,formatResponse:JIRA.GroupPickerUtil.formatResponse}})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initMultiGroupPickers(context)}})})();;
;/* module-key = 'jira.webresources:group-pickers', location = '/includes/jira/field/initSingleGroupPickers.js' */
(function(){var SingleSelect=require("jira/ajs/select/single-select");function initSingleGroupPickers(ctx){ctx.find(".js-default-single-group-picker").each(function(){var $el=jQuery(this);var $emptyValue=$el.find("option[data-empty]");new SingleSelect({element:this,itemAttrDisplayed:"label",revertOnInvalid:true,ajaxOptions:{data:function(query){return{query:query,exclude:$el.val()}},url:contextPath+"/rest/api/2/groups/picker",query:true,formatResponse:function(data){var formattedData=JIRA.GroupPickerUtil.formatResponse(data);if($emptyValue.length&&$el.val()!==""){formattedData.unshift(new AJS.ItemDescriptor({value:"",label:$emptyValue.text(),highlighted:true}))}return formattedData}}})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initSingleGroupPickers(context)}})})();;
;/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/userPickerUtil.js' */
(function($){JIRA.UserPickerUtil={formatResponse:function(data){var ret=[];$(data).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.footer});$(suggestions.users).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.displayName,html:this.html,icon:this.avatarUrl,allowDuplicate:false,highlighted:true}))});ret.push(groupDescriptor)});return ret}}})(AJS.$);;
;/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/initSingleUserPickers.js' */
(function($){function createSingleUserPickers(ctx){var restPath="/rest/api/1.0/users/picker";$(".js-default-user-picker",ctx).each(function(){var $this=$(this);if($this.data("aui-ss")){return }var data={showAvatar:true},inputText=$this.data("inputValue");new AJS.SingleSelect({element:$this,submitInputVal:true,showDropdownButton:!!$this.data("show-dropdown-button"),errorMessage:AJS.format("There is no user \'\'{0}\'\'.","'{0}'"),ajaxOptions:{url:contextPath+restPath,query:true,data:data,formatResponse:JIRA.UserPickerUtil.formatResponse},inputText:inputText})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createSingleUserPickers(context)}})})(AJS.$);;
;/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/NoBrowseUserNamePicker.js' */
AJS.NoBrowseUserNamePicker=AJS.MultiSelect.extend({_getDefaultOptions:function(){return AJS.$.extend(true,this._super(),{errorMessage:"The requested user does not exist.",showDropdownButton:false,removeOnUnSelect:true,itemAttrDisplayed:"label"})},_handleCharacterInput:function(){},_setSuggestions:function(){},_handleServerError:function(smartAjaxResult){if(smartAjaxResult.status===404){this.showErrorMessage()}else{this._super()}},_deactivate:function(){this.validateAndAdd()},validateAndAdd:function(){var instance=this;if(AJS.$.trim(this.$field.val())===""){this.hideErrorMessage()}else{jQuery.ajax({url:contextPath+"/rest/api/2/user",data:{username:AJS.$.trim(instance.getQueryVal())},success:function(user){instance.hideErrorMessage();instance.$field.val("");instance.addItem(new AJS.ItemDescriptor({label:user.displayName,value:user.name}))},error:function(){instance.showErrorMessage()}})}},_handleSpace:function(){this.validate()},_handleServerSuggestions:function(){this.hideErrorMessage();this.handleFreeInput()},handleFreeInput:function(){var value=AJS.$.trim(this.$field.val());if(value!==""){this.addItem({value:value,label:value});this.model.$element.trigger("change")}this.$field.val("")},keys:{"Return":function(event){event.preventDefault();this.validateAndAdd()},"Spacebar":function(event){event.preventDefault();this.validateAndAdd()}}});;
;/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/initMultiUserPickers.js' */
(function(){function initMultiUserPicker(ctx){ctx.find(".js-default-multi-user-picker").each(function(){var $el=jQuery(this);if(AJS.params.currentUserCanBrowseUsers){new AJS.MultiSelect({element:this,itemAttrDisplayed:"label",showDropdownButton:false,removeOnUnSelect:true,submitInputVal:true,ajaxOptions:{url:contextPath+"/rest/api/1.0/users/picker",query:true,data:function(query){return{showAvatar:true,query:query,exclude:$el.val()}},formatResponse:JIRA.UserPickerUtil.formatResponse}})}else{new AJS.NoBrowseUserNamePicker({element:this})}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initMultiUserPicker(context)}})})();;
;/* module-key = 'jira.webresources:ie-imitation-placeholder', location = '/includes/jira/field/IEImitationPlaceholder.js' */
(function($){$.fn.ieImitationPlaceholder=function(){if($.browser.msie){var form=this,fields=form.find("[placeholder]");fields.focus(clearTextIfUnchanged);fields.blur(setTextFromPlaceholder);form.submit(clearAllIfUnchanged);fields.each(setTextFromPlaceholder);function setTextFromPlaceholder(){var field=$(this);if(field.val()===""){field.val(field.attr("placeholder"));field.addClass("input-placeholder")}}function clearTextIfUnchanged(){var field=$(this);if(field.val()===field.attr("placeholder")){field.val("");field.removeClass("input-placeholder")}}function clearAllIfUnchanged(){fields.each(clearTextIfUnchanged)}}}})(AJS.$);;
;/* module-key = 'jira.webresources:jira-project-issuetype-fields', location = '/includes/jira/field/ProjectIssueTypeSelect.js' */
JIRA.ProjectIssueTypeSelect=Class.extend({init:function(options){var val,instance=this;this.$project=options.project;this.issueTypeSelect=options.issueTypeSelect;this.$projectIssueTypesSchemes=options.projectIssueTypesSchemes;this.$issueTypeSchemeIssueDefaults=options.issueTypeSchemeIssueDefaults;this.projectIssueTypeSchemes=JSON.parse(this.$projectIssueTypesSchemes.html());this.issueTypesSchemeDefaults=JSON.parse(this.$issueTypeSchemeIssueDefaults.html()||"[]");if(instance.$project.length>0){val=instance.$project.val();instance.setIssueTypeScheme(instance.getIssueTypeSchemeForProject(val));this.$project.change(function(){var val=instance.$project.val();instance.setIssueTypeScheme(instance.getIssueTypeSchemeForProject(val))})}},getIssueTypeSchemeForProject:function(projectId){return this.projectIssueTypeSchemes[projectId]},getDefaultIssueTypeForScheme:function(issueTypeSchemeId){return this.issueTypesSchemeDefaults[issueTypeSchemeId]},setIssueTypeScheme:function(issueTypeSchemeId){var selectedIssueType=this.issueTypeSelect.model.getValue();this.issueTypeSelect.model.setFilterGroup(issueTypeSchemeId);if(!this.issueTypeSelect.model.setSelected(selectedIssueType,false)){this.setDefaultIssueType(issueTypeSchemeId)}this.issueTypeSelect.model.$element.data("project",this.$project.val())},setDefaultIssueType:function(issueTypeSchemeId){var defaultIssueType=this.getDefaultIssueTypeForScheme(issueTypeSchemeId),descriptor=this.issueTypeSelect.model.getDescriptor(defaultIssueType);if(!descriptor){descriptor=this.issueTypeSelect.model.getAllDescriptors()[0]}this.issueTypeSelect.setSelection(descriptor,false)}});;
;/* module-key = 'jira.webresources:jira-project-issuetype-fields', location = '/includes/jira/field/initProjectIssueTypeSelect.js' */
(function(){var SuggestionCollectionModel=require("jira/ajs/select/suggestion-collection-model");function findProjectAndIssueTypeSelectAndConvertToPicker(ctx){var $ctx=ctx||jQuery("body");$ctx.find(".issuetype-field").each(function(index){var $project=$ctx.find(".project-field, .project-field-readonly"),$issueTypeSelect=jQuery(this),$projectIssueTypes=$ctx.find("#"+$issueTypeSelect.attr("id")+"-projects"),$defaultProjectIssueTypes=$ctx.find("#"+$issueTypeSelect.attr("id")+"-defaults"),issueTypeSelect=new AJS.SingleSelect({element:$issueTypeSelect,revertOnInvalid:true,model:SuggestionCollectionModel});issueTypeSelect.model.remove("");if($project.length>0){new JIRA.ProjectIssueTypeSelect({project:$project.eq(index),issueTypeSelect:issueTypeSelect,projectIssueTypesSchemes:$projectIssueTypes,issueTypeSchemeIssueDefaults:$defaultProjectIssueTypes})}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findProjectAndIssueTypeSelectAndConvertToPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-project-issuetype-fields', location = '/includes/jira/field/initIssueTypePickers.js' */
(function(){function createissueTypePicker(context){context.find(".issuetype-field").each(function(){var $select=jQuery(this);$select.bind("reset",function(){$select.find("option[value='']").remove()}).trigger("reset");new AJS.SingleSelect({element:this,revertOnInvalid:true})})}})();;
;/* module-key = 'jira.webresources:jira-project-issuetype-fields', location = '/includes/jira/field/initProjectPickers.js' */
(function(){var ScrollableSingleSelect=require("jira/ajs/select/scrollable-single-select");var SuggestionCollectionModel=require("jira/ajs/select/suggestion-collection-model");function createProjectPicker(context){context.find(".project-field").each(function(){new ScrollableSingleSelect({element:this,revertOnInvalid:true,pageSize:50,pagingThreshold:100,model:SuggestionCollectionModel})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createProjectPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/field-templates.soy' */
// This file was automatically generated from field-templates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }


JIRA.Templates.Fields.username = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.escape) ? soy.$$escapeHtml(opt_data.displayName) : opt_data.displayName);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.recipientUsername = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li data-username="', soy.$$escapeHtml(opt_data.username), '" title=', soy.$$escapeHtml(opt_data.username), '><span><span class="user-hover" rel="', soy.$$escapeHtml(opt_data.username), '"><img alt="" src="', soy.$$escapeHtml(opt_data.icon), '" title="');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('"><span title="');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('">');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('</span></span>', (! opt_data.readOnly) ? '<button type="button" class="remove-recipient item-delete">' + soy.$$escapeHtml(AJS.format("Remove watcher: {0}",opt_data.username)) + '</button>' : '', '</span></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.recipientEmail = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li data-email="', soy.$$escapeHtml(opt_data.email), '" title=', soy.$$escapeHtml(opt_data.email), '><span><img src="', soy.$$escapeHtml(opt_data.icon), '" title="', soy.$$escapeHtml(opt_data.email), '"><span title="', soy.$$escapeHtml(opt_data.email), '">', soy.$$escapeHtml(opt_data.email), '</span><span class="remove-recipient item-delete"/></span></li>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/IssuePicker.js' */
define("jira/field/issue-picker",["jira/ajs/select/multi-select","jira/ajs/list/group-descriptor","jira/ajs/list/item-descriptor","jquery"],function(MultiSelect,GroupDescriptor,ItemDescriptor,jQuery){var IssuePicker=MultiSelect.extend({_formatResponse:function(response){var ret=[],canonicalBaseUrl=(function(){var uri=parseUri(window.location);return uri.protocol+"://"+uri.authority})();if(response&&response.sections){jQuery(response.sections).each(function(i,section){var groupDescriptor=new GroupDescriptor({weight:i,label:section.label,description:section.sub});if(section.issues&&section.issues.length>0){jQuery(section.issues).each(function(){groupDescriptor.addItem(new ItemDescriptor({highlighted:true,value:this.key,label:this.key+" - "+this.summaryText,icon:this.img?canonicalBaseUrl+contextPath+this.img:null,html:this.keyHtml+" - "+this.summary}))})}ret.push(groupDescriptor)})}return ret},_getDefaultOptions:function(){return jQuery.extend(true,this._super(),{ajaxOptions:{formatResponse:this._formatResponse}})},_launchPopup:function(){function getWithDefault(value,def){if(typeof value=="undefined"||value==null){return def}else{return value}}var url,urlParam,vWinUsers,options,instance=this;IssuePicker.callback=function(items){if(typeof items==="string"){items=JSON.parse(items)}instance._addMultipleItems(items,true);instance.$field.focus()};options=this.options.ajaxOptions.data;url=contextPath+"/secure/popups/IssuePicker.jspa?";urlParam={singleSelectOnly:"false",decorator:"popup",currentIssue:options.currentIssueKey||"",showSubTasks:getWithDefault(options.showSubTasks,false),showSubTasksParent:getWithDefault(options.showSubTaskParent,false)};if(options.currentProjectId){urlParam["currentProjectId"]=options.currentProjectId}url+=jQuery.param(urlParam);vWinUsers=window.open(url,"IssueSelectorPopup","status=no,resizable=yes,top=100,left=200,width="+this.options.popupWidth+",height="+this.options.popupHeight+",scrollbars=yes,resizable");vWinUsers.opener=self;vWinUsers.focus()},_createFurniture:function(disabled){var $popupLink;this._super(disabled);$popupLink=this._render("popupLink");this._assignEvents("popupLink",$popupLink);this.$container.addClass("jira-issue-picker");this.$container.addClass("hasIcon");this.$container.after($popupLink)},handleFreeInput:function(){var values=this.$field.val().toUpperCase().match(/\S+/g);if(values){this._addMultipleItems(jQuery.map(values,function(value){return{value:value,label:value}}))}this.$field.val("")},_events:{popupLink:{click:function(e){this._launchPopup();e.preventDefault()}}},_renders:{popupLink:function(){return jQuery("<a class='issue-picker-popup' />").attr({href:"#",title:this.options.popupLinkMessage}).text(""+this.options.popupLinkMessage+"")}}});IssuePicker.callback=null;return IssuePicker});AJS.namespace("jira.issuepicker",null,require("jira/field/issue-picker"));AJS.namespace("AJS.IssuePicker",null,require("jira/field/issue-picker"));AJS.namespace("JIRA.IssuePicker",null,require("jira/field/issue-picker"));;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/LabelPicker.js' */
define("jira/field/label-picker",["jira/ajs/select/multi-select","jira/ajs/list/group-descriptor","jira/ajs/list/item-descriptor","jquery"],function(MultiSelect,GroupDescriptor,ItemDescriptor,jQuery){return MultiSelect.extend({_getDefaultOptions:function(){return jQuery.extend(true,this._super(),{ajaxOptions:{url:contextPath+"/includes/js/ajs/layer/labeldata.js",query:true,formatResponse:this._formatResponse},removeDuplicates:true,removeOnUnSelect:true,userEnteredOptionsMsg:"New Label"})},isValidItem:function(itemValue){return !/\s/.test(itemValue)},_handleServerSuggestions:function(data){if(data&&data.token){if(jQuery.trim(this.$field.val())!==data.token){return }}this._super(data)},_handleSpace:function(){if(jQuery.trim(this.$field.val())!==""){if(this.handleFreeInput()){this.hideSuggestions()}}},keys:{"Spacebar":function(event){this._handleSpace();event.preventDefault()}},_formatResponse:function(data){var optgroup=new GroupDescriptor({label:"Suggestions",type:"optgroup",styleClass:"labels-suggested"});if(data&&data.suggestions){jQuery.each(data.suggestions,function(){optgroup.addItem(new ItemDescriptor({value:this.label,label:this.label,html:this.html,highlighted:true}))})}return[optgroup]},handleFreeInput:function(){var values=jQuery.trim(this.$field.val()).match(/\S+/g);if(values){for(var value,i=0;value=values[i];i++){this.addItem({value:value,label:value})}this.model.$element.trigger("change")}this.$field.val("")}})});AJS.namespace("AJS.LabelPicker",null,require("jira/field/label-picker"));AJS.namespace("JIRA.LabelPicker",null,require("jira/field/label-picker"));;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/MultiUserListPicker.js' */
(function($){JIRA.MultiUserListPicker=AJS.MultiSelect.extend({init:function(options){var restPath="/rest/api/1.0/users/picker";function formatResponse(response){var ret=[];$(response).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.footer});$(suggestions.users).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.displayName,html:this.html,icon:this.avatarUrl,allowDuplicate:false,highlighted:true}))});ret.push(groupDescriptor)});return ret}$.extend(options,{itemAttrDisplayed:"label",userEnteredOptionsMsg:"Email address",showDropdownButton:false,removeOnUnSelect:true,ajaxOptions:{url:contextPath+restPath,query:true,data:{showAvatar:true},formatResponse:formatResponse},suggestionsHandler:AJS.UserListSuggestHandler,itemGroup:new AJS.Group(),itemBuilder:function(descriptor){return new JIRA.MultiUserListPicker.Item({descriptor:descriptor,container:this.$selectedItemsContainer})}});this._super(options)},_createFurniture:function(disabled){this._super(disabled);if(this.options.description){this._render("description",this.options.description).insertAfter(this.$field)}},updateItemsIndent:$.noop,_renders:{selectedItemsWrapper:function(){return $('<div class="recipients"></div>')},selectedItemsContainer:function(){return $("<ol />")},description:function(description){return $("<div />").addClass("description").text(description)}}})}(AJS.$));;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/MultiUserListPicker.Item.js' */
JIRA.MultiUserListPicker.Item=AJS.Control.extend({init:function(options){this._setOptions(options);this.$lozenge=this._render("item");this.$removeButton=this.$lozenge.find(".remove-recipient");this._assignEvents("instance",this);this._assignEvents("lozenge",this.$lozenge);this._assignEvents("removeButton",this.$removeButton);this.$lozenge.prependTo(this.options.container)},_getDefaultOptions:function(){return{label:null,title:null,container:null,focusClass:"focused"}},_renders:{"item":function(){var descriptor=this.options.descriptor;var data;if(descriptor.noExactMatch()!==true){data={escape:false,username:descriptor.value(),icon:descriptor.icon(),displayName:AJS.escapeHtml(descriptor.label())};return AJS.$(JIRA.Templates.Fields.recipientUsername(data))}else{data={email:descriptor.value(),icon:AJS.Meta.get("default-avatar-url")};return AJS.$(JIRA.Templates.Fields.recipientEmail(data))}}},_events:{"instance":{"remove":function(){this.$lozenge.remove()}},"removeButton":{"click":function(e){e.stopPropagation();this.trigger("remove")}}}});;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initCascadingSelects.js' */
(function(){function initCascadingSelect(el){AJS.$(el||document.body).find("div.aui-field-cascadingselect").add("tr.aui-field-cascadingselect").add("td.aui-field-cascadingselect").each(function(){var $container=AJS.$(this),parent=$container.find(".cascadingselect-parent"),parentOptions=parent.find("option"),oldClass="",child=$container.find(".cascadingselect-child"),childOptions=child.find("option"),selectedChild=child.find(":selected");function update(){var placeholder,currentClass=parent.find("option:selected").attr("class");if(currentClass!==oldClass){placeholder=jQuery("<span />").insertAfter(child);child.detach();child.find("option").each(function(i,elem){elem.parentNode.removeChild(this)});child.insertAfter(placeholder);placeholder.remove();childOptions.filter("."+parent.find("option:selected").attr("class")).appendTo(child);if(selectedChild.hasClass(parent.find("option:selected").attr("class"))){child.val(selectedChild.val())}else{child.val(child.find("option:first").val())}oldClass=currentClass}}parent.bind("cascadingSelectChanged",update).change(function(){AJS.$(this).trigger("cascadingSelectChanged")}).trigger("cascadingSelectChanged")})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initCascadingSelect(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initComponentPickers.js' */
(function(){JIRA.ComponentPicker=AJS.MultiSelect.extend({init:function(options){this._super(options);this.suggestionsHandler=new AJS.OnlyNewItemsSuggestHandler(this.options,this.model)},_getDefaultOptions:function(opts){var canCreate=false;if(opts&&opts.element){canCreate=AJS.$(opts.element).data("create-permission")}if(canCreate){return AJS.$.extend(true,this._super(),{userEnteredOptionsMsg:"New Component"})}else{return this._super(opts)}},_selectionHandler:function(selected,e){var allExistingDescriptors=this.model.getDisplayableSelectedDescriptors().concat(this.model.getDisplayableUnSelectedDescriptors());var selectedDescriptor=selected.data("descriptor");var existingDescriptor=_.find(allExistingDescriptors,function(descriptor){return descriptor.label()===selectedDescriptor.label()});if(!existingDescriptor){selectedDescriptor.properties.value="nv_"+selectedDescriptor.value();JIRA.trigger("Issue.Component.new.selected",[selectedDescriptor.value()])}this._super(selected,e)}});function createPicker($selectField){new JIRA.ComponentPicker({element:$selectField,itemAttrDisplayed:"label",errorMessage:"{0} is not a valid component.",maxInlineResultsDisplayed:15,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}var DEFAULT_SELECTORS=["div.aui-field-componentspicker.frother-control-renderer","td.aui-field-componentspicker.frother-control-renderer","tr.aui-field-componentspicker.frother-control-renderer"];function findComponentSelectAndConvertToPicker(context,selector){selector=selector||DEFAULT_SELECTORS.join(", ");AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findComponentSelectAndConvertToPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initMultiselectPickers.js' */
(function(){function createPicker($selectField){new AJS.MultiSelect({element:$selectField,itemAttrDisplayed:"label",errorMessage:"{0} is not a valid value.",maxInlineResultsDisplayed:15,submitInputVal:true,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}var DEFAULT_SELECTORS=["div.aui-field-multiselectpicker.frother-control-renderer"];function findComponentSelectAndConvertToPicker(context,selector){selector=selector||DEFAULT_SELECTORS.join(", ");AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findComponentSelectAndConvertToPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initDatePickers.js' */
(function(){function initDatePicker(el){AJS.$(el||document.body).find("div.aui-field-datepicker").add("tr.aui-field-datepicker").add("td.aui-field-datepicker").each(function(){var $container=AJS.$(this),field=$container.find("input:text"),defaultCheckbox=$container.find("#useCurrentDate"),params=JIRA.parseOptionsFromFieldset($container.find("fieldset.datepicker-params"));params.context=el;Calendar.setup(params);function toggleField(){field.prop("disabled",defaultCheckbox.is(":checked"))}if(defaultCheckbox.length){toggleField();defaultCheckbox.click(toggleField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initDatePicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLegacyGroupPickers.js' */
(function(){function initLegacyGroupPicker(el){AJS.$(el||document.body).find("div.aui-field-grouppicker").add("tr.aui-field-grouppicker").add("td.aui-field-grouppicker").each(function(){var $container=AJS.$(this),trigger=$container.find("a.grouppicker-trigger"),url=trigger.attr("href");function openGroupPickerWindow(e){e.preventDefault();window.open(url,"GroupPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes")}trigger.click(openGroupPickerWindow)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initLegacyGroupPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initIssuePickers.js' */
(function(){var IssuePicker=require("jira/field/issue-picker");var Events=require("jira/util/events");var Types=require("jira/util/events/types");var Reasons=require("jira/util/events/reasons");var $=require("jquery");function initIssuePicker(el){$(el||document.body).find(".aui-field-issuepicker").each(function(){new IssuePicker({element:$(this),userEnteredOptionsMsg:"Enter issue key",uppercaseUserEnteredOnSelect:true})})}Events.bind(Types.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==Reasons.panelRefreshed){initIssuePicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLabelPickers.js' */
define("jira/field/label-picker-factory",["jira/field/label-picker","jira/data/parse-options-from-fieldset","jquery","exports"],function(LabelPicker,parseOptionsFromFieldset,$,exports){exports.createPicker=function($fieldset,context){var opts=parseOptionsFromFieldset($fieldset),$select=$("#"+opts.id,context),issueId=opts.issueId,data={};if(/customfield_\d/.test(opts.id)){data.customFieldId=parseInt(opts.id.replace("customfield_",""),10)}new LabelPicker({element:$select,ajaxOptions:{url:contextPath+"/rest/api/1.0/labels"+(issueId?"/"+issueId:"")+"/suggest",data:data}})}});(function(){var LabelPickerFactory=require("jira/field/label-picker-factory");var Events=require("jira/util/events");var Types=require("jira/util/events/types");var Reasons=require("jira/util/events/reasons");var $=require("jquery");var FIELDSET_SELECTOR="fieldset.labelpicker-params";function locateFieldset(parent){var $parent=$(parent),$fieldset;if($parent.is(FIELDSET_SELECTOR)){$fieldset=$parent}else{$fieldset=$parent.find(FIELDSET_SELECTOR)}return $fieldset}function findLabelsFieldsetAndConvertToPicker(context,selector){selector=selector||".aui-field-labelpicker";$(selector,context).each(function(){var $fieldset=locateFieldset(this);if($fieldset.length>0){LabelPickerFactory.createPicker($fieldset,context)}})}Events.bind(Types.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==Reasons.panelRefreshed){findLabelsFieldsetAndConvertToPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initVersionPickers.js' */
(function(){JIRA.VersionPicker=AJS.MultiSelect.extend({init:function(options){this._super(options);this.suggestionsHandler=new AJS.OnlyNewItemsSuggestHandler(this.options,this.model)},_getDefaultOptions:function(opts){var canCreate=false;if(opts&&opts.element){canCreate=AJS.$(opts.element).data("create-permission")}if(canCreate){return AJS.$.extend(true,this._super(),{userEnteredOptionsMsg:"New Version"})}else{return this._super(opts)}},_selectionHandler:function(selected,e){var allExistingVersionDescriptors=this.model.getDisplayableSelectedDescriptors().concat(this.model.getDisplayableUnSelectedDescriptors());var selectedDescriptor=selected.data("descriptor");var existingVersion=_.find(allExistingVersionDescriptors,function(descriptor){return descriptor.label()===selectedDescriptor.label()});if(!existingVersion){selectedDescriptor.properties.value="nv_"+selectedDescriptor.value();JIRA.trigger("Issue.Version.new.selected",[selectedDescriptor.value()])}this._super(selected,e)}});function createPicker($selectField){new JIRA.VersionPicker({element:$selectField,itemAttrDisplayed:"label",removeOnUnSelect:false,submitInputVal:true,errorMessage:"{0} is not a valid version.",maxInlineResultsDisplayed:15,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}function findVersionSelectAndConvertToPicker(context,selector){selector=selector||".aui-field-versionspicker.frother-control-renderer";AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findVersionSelectAndConvertToPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initCommentControls.js' */
(function($){function applyCommentControls($contexts){if($contexts.attr("id")==="addcomment"){$contexts=$contexts.find("#issue-comment-add")}$contexts.each(function(){var $context=$(this);var $commentLevel=$context.find("#commentLevel");if($commentLevel.length>0){new AJS.SecurityLevelSelect($commentLevel)}$context.find(".wiki-js-prefs").each(function(){JIRA.wikiPreview(this,$context).init()})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context){applyCommentControls(context)})})(AJS.$);;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLogWorkControls.js' */
(function($){JIRA.Events.VALIDATE_TIMETRACKING="validateTimeTracking";function toggleTimeTrackingContainer(context,activate){var $logWorkContainer=$(context).find("#worklog-logworkcontainer"),$timeTrackingContainer=$(context).find("#worklog-timetrackingcontainer"),$logWorkCheckbox=$(context).find("#log-work-activate");if(activate){$logWorkContainer.removeClass("hidden");$timeTrackingContainer.addClass("hidden");$logWorkCheckbox.prop("checked",true)}else{$logWorkContainer.addClass("hidden");$timeTrackingContainer.removeClass("hidden");$logWorkCheckbox.prop("checked",false)}}function applyLogworkControls(context){$("#log-work-adjust-estimate-new-value, #log-work-adjust-estimate-manual-value",context).attr("disabled","disabled");$("#log-work-adjust-estimate-"+$("input[name=worklog_adjustEstimate]:checked,input[name=adjustEstimate]:checked",context).val()+"-value",context).removeAttr("disabled");$("input[name=worklog_adjustEstimate],input[name=adjustEstimate]",context).change(function(){$("#log-work-adjust-estimate-new-value,#log-work-adjust-estimate-manual-value",context).attr("disabled","disabled");$("#log-work-adjust-estimate-"+$(this).val()+"-value",context).removeAttr("disabled")});$("#delete-log-work-adjust-estimate-new-value").change(function(){$("#delete-log-work-adjust-estimate-new").prop("checked",true)});$("#delete-log-work-adjust-estimate-manual-value").change(function(){$("#delete-log-work-adjust-estimate-manual").prop("checked",true)});$(context).find("#log-work-activate").change(function(){toggleTimeTrackingContainer(context,$(this).is(":checked"))})}JIRA.bind(JIRA.Events.VALIDATE_TIMETRACKING,function(e,context){toggleTimeTrackingContainer(context,true)});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){applyLogworkControls(context)}})})(AJS.$);;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initPriorityPickers.js' */
(function($){function createPriorityPicker(context){context.find("select#priority").each(function(i,el){new AJS.SingleSelect({element:el,revertOnInvalid:true})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createPriorityPicker(context)}})})(AJS.$);;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initInlineAttach.js' */
(function(){var Events=require("jira/util/events");var Types=require("jira/util/events/types");var Reasons=require("jira/util/events/reasons");require("jira/jquery/plugins/attachment/inline-attach");function createInlineAttach(context){context.find("input[type=file]:not('.ignore-inline-attach')").inlineAttach()}Events.bind(Types.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==Reasons.panelRefreshed){createInlineAttach(context)}})})();;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/namespace.js' */
jQuery.namespace("JIRA.Forms");;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/util.js' */
Class.prototype.triggerEvent=function(c,a,b){jQuery(this).trigger(c,a);if(b&&this.globalEventNamespaces){jQuery.each(this.globalEventNamespaces,function(e,d){jQuery(AJS).trigger(d+"."+c,a)})}return this};Class.prototype.bind=function(a,b){jQuery(this).bind(a,b);return this};JIRA.makePropertyFunc=function(a){if(jQuery.isFunction(a)){return a}else{return function(){return a}}};JIRA.Dialog.getAttrFromActiveTrigger=function(b){var c=JIRA.Dialog.current,a=c.$activeTrigger;if(a){return a.attr(b)}};JIRA.Dialog.getIssueActionTitle=function(b){var a=JIRA.Dialog.getActionIssueKey();if(!a){return b}return b+" : "+a};JIRA.Dialog.getActionIssueKey=function(){var a=JIRA.Dialog.getAttrFromActiveTrigger("data-issueKey");if(!a&&JIRA.Issue){a=JIRA.Issue.getIssueKey()}if(!a&&JIRA.IssueNavigator){a=JIRA.IssueNavigator.getSelectedIssueKey()}if(!a&&JIRA.Issues){a=JIRA.Issues.Api.getSelectedIssueKey()}return a};JIRA.activateTabWithChild=function(e){var c,b,a,d=e.closest(".tabs-pane");if(d.length){b=d.closest(".aui-tabs");c=d.attr("id");a=b.find("a[href='#"+c+"']");a.click()}};JIRA.applyErrorsToForm=function(c,d){var b,a=[];jQuery.each(d,function(f,i){var h,e,g=c.find(":input[name='"+f+"']").last();if(g.length===1){if(!b){b=g}e=jQuery("<div class='error' />").attr("data-field",f).text(i);h=g.closest(".field-group, .group");h.find(".error").remove();h.append(e)}else{if(g.length===0){a.push(i)}}});if(a.length>0){JIRA.applyErrorMessageToForm(c,JIRA.Templates.Issue.undealtErrors({errors:a}))}JIRA.activateTabWithChild(c.find(".error:first"));if(b){b.focus()}};JIRA.extractScripts=function(b){var a=jQuery(b);return{html:a.not("script"),scripts:a.filter("script")}};JIRA.applyMessageToForm=function(a,c,b,e){var d=c.find(".aui-message-context");if(!d.length){d=jQuery("<div class='aui-message-context' />");if(JIRA.useLegacyDecorator()){d.prependTo(c.find(".content-body"))}else{d.prependTo(c.find(".form-body"))}}d.empty();AJS.messages[a](d,{shadowed:false,closeable:e,body:b})};JIRA.useLegacyDecorator=function(){return !JIRA.Version.isGreaterThanOrEqualTo("5.0")};JIRA.applyErrorMessageToForm=function(b,a){return JIRA.applyMessageToForm("error",b,a,false)};JIRA.applySuccessMessageToForm=function(b,a){return JIRA.applyMessageToForm("success",b,a,true)};;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/model.js' */
JIRA.Forms.Model=Class.extend({init:function(a){this.userFieldsResource=a.userFieldsResource;this.fieldsResource=a.fieldsResource;this.retainedFields=[];this._hasRetainFeature=false;this._hasVisibilityFeature=true},getFieldsResource:function(){return this.fieldsResource},getAtlToken:function(){return this.atlToken},getFormToken:function(){return this.formToken},getActiveFieldIds:function(){return this.getUserFields()},addFieldToRetainValue:function(a){if(this._hasRetainFeature){this.removeFieldToRetainValue(a);this.retainedFields.push(a)}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")}},clearRetainedFields:function(){this.retainedFields=[]},removeFieldToRetainValue:function(b){if(this._hasRetainFeature){var a=jQuery.inArray(b,this.retainedFields);if(a!=-1){this.retainedFields.splice(a,1)}}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")}},getFieldsWithRetainedValues:function(){if(this._hasRetainFeature){return this.retainedFields}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")}},hasRetainedValue:function(a){if(this._hasRetainFeature){return jQuery.inArray(a.id,this.retainedFields)!==-1}else{throw new Error("HasRetainedValue: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")}},refresh:function(c){var a=this,b=jQuery.Deferred(),d;if(c){d=c+"&retainValues=true"}JIRA.SmartAjax.makeRequest({url:this.getFieldsResource(),type:"POST",data:d,success:function(e){a.atlToken=e.atl_token;a.formToken=e.formToken;a.fields=e.fields;a.sortedTabs=e.sortedTabs;a.userPreferences=e.userPreferences},complete:function(f,g,e){if(e.successful){b.resolveWith(a,arguments)}else{a.triggerEvent("serverError",[e]);b.rejectWith(a,[e])}}});return b.promise()},setFields:function(a){this.fields=a},getConfigurableFields:function(){return this.getFields()},getFields:function(){var a=this,b=jQuery.Deferred();if(!this.fields){this.refresh().done(function(){b.resolve(a.fields)})}else{b.resolve(a.fields)}return b.promise()},_mungeTabs:function(b){var a=0,c=[];jQuery.each(b,function(d,e){a++;if(e.tab){if(!c[e.tab.position]){c[e.tab.position]=AJS.copyObject(e.tab)}if(e.tab.position===0){c[e.tab.position].isFirst=true}if(!c[e.tab.position].fields){c[e.tab.position].fields=[]}c[e.tab.position].fields.push(AJS.copyObject(e))}});return c},getTabs:function(){var a=this,b=jQuery.Deferred();this.getFields().done(function(c){var d=a._mungeTabs(c);b.resolve(d)});return b.promise()},getSortedTabs:function(){var a=jQuery.Deferred();if(!this.sortedTabs){this.refresh().done(function(){a.resolve(this.sortedTabs)})}else{a.resolve(this.sortedTabs)}return a.promise()},getUserFields:function(){var a=this,b=jQuery.Deferred();if(!this.userPreferences){this.refresh().done(function(){b.resolve(a.userPreferences.fields)})}else{b.resolve(a.userPreferences.fields)}return b.promise()},setUserFields:function(a){var b={};b.fields=a;return this.updateUserPrefs(b)},hasRetainFeature:function(){return !!this._hasRetainFeature},hasVisibilityFeature:function(){return !!this._hasVisibilityFeature},getUseConfigurableForm:function(){var a=this,b=jQuery.Deferred();if(!this.userPreferences){this.refresh().done(function(){b.resolve(a.userPreferences.useQuickForm)}).fail(function(){b.reject()})}else{b.resolve(a.userPreferences.useQuickForm)}return b.promise()},setUseConfigurableForm:function(a){var b={};b.useQuickForm=a;return this.updateUserPrefs(b)},updateUserPrefs:function(c){var b=jQuery.Deferred(),a=this;if(AJS.Meta.get("remote-user")===""){b.done();return b.promise()}if(!this.userPreferences){console.log("JIRA.Forms.Model: Cannot update user preferences if there are none to update");b.reject();return b.promise()}if(!c.fields){c.fields=this.userPreferences.fields}if(typeof c.showWelcomeScreen==="undefined"){c.showWelcomeScreen=this.userPreferences.showWelcomeScreen}if(typeof c.useQuickForm==="undefined"){c.useQuickForm=this.userPreferences.useQuickForm}return JIRA.SmartAjax.makeRequest({url:this.userFieldsResource,type:"POST",data:JSON.stringify(c),dataType:"json",contentType:"application/json",complete:function(e,f,d){if(d.successful){a.userPreferences=c}else{a.triggerEvent("serverError",[d])}}})}});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/quickform.soy' */
// This file was automatically generated from quickform.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.QuickForm == 'undefined') { JIRA.Templates.QuickForm = {}; }


JIRA.Templates.QuickForm.field = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(opt_data.editHtml);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.fieldPicker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="qf-picker"><div class="qf-picker-header"><dl><dt>', soy.$$escapeHtml("Show Fields:"), '</dt>', (opt_data.isConfigurable) ? '<dd><a class="qf-unconfigurable" href="#">' + soy.$$escapeHtml("All") + '</a></dd><dd>' + soy.$$escapeHtml("Custom") + '</dd>' : '<dd>' + soy.$$escapeHtml("All") + '</dd><dd><a class="qf-configurable" href="#">' + soy.$$escapeHtml("Custom") + '</a></dd>', '</dl></div><div class="qf-picker-content ', (! opt_data.isConfigurable) ? 'qf-picker-unconfigurable' : '', '"></div><div class="qf-picker-footer"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.configurablePickerButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a title="', soy.$$escapeHtml(opt_data.label), '" data-field-id="', soy.$$escapeHtml(opt_data.fieldId), '" class="qf-picker-button', (opt_data.isActive) ? ' qf-active' : '', '" href="#">', soy.$$escapeHtml(opt_data.label), (opt_data.required) ? '<span class="aui-icon icon-required"></span>' : '', '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.unconfigurablePickerButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span title="', soy.$$escapeHtml(opt_data.label), '" data-field-id="', soy.$$escapeHtml(opt_data.fieldId), '" class="qf-picker-button', (opt_data.isActive) ? ' qf-active' : '', '" href="#">', soy.$$escapeHtml(opt_data.label), (opt_data.required) ? '<span class="aui-icon icon-required"></span>' : '', '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.errorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.error({closeable: 'true', content: opt_data.message}, output);
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/field.js' */
JIRA.Forms.ConfigurableField=AJS.Control.extend({init:function(a){this.descriptor=a;this.$element=jQuery("<div />").attr("id","qf-field-"+this.getId())},focus:function(){this.$element.find(":input:first").focus()},highlight:function(){var a=this;this.$element.css("backgroundColor","#fff").animate({backgroundColor:"lightyellow"},function(){a.$element.animate({backgroundColor:"#fff"},function(){a.$element.css("backgroundColor","")})})},getLabel:function(){return this.descriptor.label},getId:function(){return this.descriptor.id},activate:function(b){var a;this.active=true;this.$element.addClass("qf-field-active").show();this.$element.find("textarea").trigger("refreshInputHeight");if(!b){a=this.render();this.$element.append(a.scripts);this.focus();JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$element]);this.$element.scrollIntoView();this.triggerEvent("activated")}},hasVisibilityFeature:function(){return !!this.descriptor.hasVisibilityFeature},hasRetainFeature:function(){return !!this.descriptor.hasRetainFeature},isActive:function(){return this.active},disable:function(a){this.render();this.active=false;this.$element.removeClass("qf-field-active").hide();if(!a){this.triggerEvent("disabled")}},render:function(){var b=JIRA.Templates.QuickForm.field(this.descriptor),a=JIRA.extractScripts(b);this.$element.html(a.html).addClass("qf-field").data("model",this);return{element:this.$element,scripts:a.scripts}}});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/picker.js' */
JIRA.Forms.FieldPicker=AJS.Control.extend({INLINE_DIALOG_ID:"field_picker_popup",init:function(){this.buttons=[]},switchToAll:function(a){this.isConfigurable=false;if(a!==true){this.hideCallback=function(){this.remove()};this.inlineDialog.hide();this.triggerEvent("switchedToAll")}},setForm:function(a){this.form=a},switchToCustom:function(a){this.isConfigurable=true;if(a!==true){this.hideCallback=function(){this.remove()};this.inlineDialog.hide();this.triggerEvent("switchedToCustom")}},hideCallback:function(){},bindInlineDialog:function(){var b=this,a=this.getInlineDialogTrigger();function c(f,d,e){b.render().done(function(g){if(f.find(".qf-picker").length===0){f.html(g);f.click(function(k){k.stopPropagation()})}var j=jQuery("#qf-field-picker-trigger:visible").offset().top-jQuery(window).scrollTop(),i=jQuery(window).height(),h=i-j-110;f.find(".qf-picker-content").css("maxHeight",h);e()})}if(this.inlineDialog){this.inlineDialog.remove()}this.inlineDialog=AJS.InlineDialog(a,this.INLINE_DIALOG_ID,c,{width:450,upfrontCallback:function(){a.parent().addClass("active")},hideCallback:function(){a.parent().removeClass("active")},nobind:true});a.click(function(d){if(jQuery("#inline-dialog-"+b.INLINE_DIALOG_ID).is(":visible")){b.inlineDialog.hide()}else{b.inlineDialog.show()}});return this.inlineDialog},getInlineDialogTrigger:function(){return this.form.$element.find("#qf-field-picker-trigger")},renderButtons:function(b){var a=this,c=jQuery('<ul class="qf-picker-buttons" />').appendTo(this.$content);jQuery.each(b,function(e,f){var g,d;if(a.isConfigurable){a.form.getFieldById(f.id).done(function(i){if(i&&i.hasVisibilityFeature()){var j=jQuery("<li />").appendTo(c);var h=new JIRA.Forms.FieldPicker.ConfigurableButton({field:i});h.render().appendTo(j);a.buttons.push(h)}})}else{d=new JIRA.Forms.FieldPicker.UnconfigurableButton(f);g=jQuery("<li />").appendTo(c);d.render().appendTo(g)}});if(c.children().length===0){c.addClass("qf-no-fields").append("<li><em>"+"No fields can be configured for this tab"+"</em></li>")}},renderContents:function(){var a=this,b=jQuery.Deferred();this.form.model.getSortedTabs().done(function(c){if(c.length===1){a.renderButtons(c[0].fields)}else{jQuery.each(c,function(d,e){if(e.fields.length>0){jQuery("<h4><span></span></h4>").appendTo(a.$content).find("span").text(e.label);a.renderButtons(e.fields)}})}b.resolveWith(a,[a.$element])});return b.promise()},show:function(){this.inlineDialog.show()},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.fieldPicker({isConfigurable:this.isConfigurable}));this.$content=this.$element.find(".qf-picker-content");this._assignEvents("switchToCustom",this.$element.find(".qf-configurable"));this._assignEvents("switchToAll",this.$element.find(".qf-unconfigurable"));return this.renderContents()},_events:{switchToCustom:{click:function(a){this.switchToCustom();a.preventDefault()}},switchToAll:{click:function(a){this.switchToAll();a.preventDefault()}}}});JIRA.Forms.FieldPicker.UnconfigurableButton=AJS.Control.extend({init:function(a){this.descriptor=a},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.unconfigurablePickerButton({required:this.descriptor.required,label:this.descriptor.label,fieldId:this.descriptor.id,isActive:true}));return this.$element}});JIRA.Forms.FieldPicker.ConfigurableButton=AJS.Control.extend({init:function(b){var a=this;this.field=b.field;this.field.bind("disabled",function(){a.$element.removeClass("qf-active")}).bind("activated",function(){a.$element.addClass("qf-active")})},toggle:function(){if(this.field.isActive()){this.field.disable()}else{this.field.activate()}},getId:function(){return this.field.getId()},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.configurablePickerButton({required:this.field.descriptor.required,label:this.field.getLabel(),fieldId:this.field.getId(),isActive:this.field.isActive()}));this._assignEvents("button",this.$element);return this.$element},_events:{button:{click:function(a){this.toggle();a.preventDefault()}}}});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/form.js' */
JIRA.Forms.AbstractForm=AJS.Control.extend({submit:function(){var a=this;a.getForm().addClass("submitting");this.triggerEvent("submitting",[],true);return JIRA.SmartAjax.makeRequest({url:this.getAction(),type:"POST",beforeSend:function(){a.disable()},data:this.serialize(),complete:function(g,h,c){var e=c.data;a.getForm().find(".aui-message-context").remove();a.enable();a.getForm().find(".error").remove();if(c.successful){a.performAnalytics();if(e&&e.fields){a.invalidateFieldsCache();a.model.setFields(e.fields)}if(typeof e==="string"){var f=AJS.$(AJS.extractBodyFromResponse(e));var d=f.find("#atl_token").val();if(d){a.model.atlToken=d;a.getForm().find('input[name="atl_token"]').val(d)}var b=new JIRA.FormDialog({offsetTarget:"body",content:f});b._handleServerSuccess=function(){if(b.prev){b.prev._removeStackState();b.prev._resetWindowTitle();b._removeStackState()}b.hide();a.triggerEvent("sessionComplete",[],true);a.handleSubmitSuccess()};b._handleServerError=function(i){b.hide();a.handleSubmitError(i)};b.show()}else{a.handleSubmitSuccess(c.data)}}else{a.handleSubmitError(g)}a.getForm().removeClass("submitting")}})},disable:function(){this.getForm().find(":input").attr("disabled","disabled").trigger("disable");this.getForm().find(":submit").attr("disabled","disabled")},enable:function(){this.getForm().find(":input").removeAttr("disabled").trigger("enable");this.getForm().find(":submit").removeAttr("disabled")},getActiveFieldIds:function(){throw new Error("getActiveFieldIds: Abstract, must be implemented by sub class")},serialize:function(c){var a=this,b=this.getForm().serialize();if(this.model.isInMultipleMode&&this.model.isInMultipleMode()){b=b+"&multipleMode=true"}if(this.model.hasRetainFeature()){this.model.clearRetainedFields();jQuery.each(this.getActiveFieldIds(),function(e,d){a.model.addFieldToRetainValue(d,c)});jQuery.each(this.model.getFieldsWithRetainedValues(),function(d,e){b=b+"&fieldsToRetain="+e})}return b},invalidateFieldsCache:function(){delete this.fields},setInitialFocus:function(){this.getFormContent().find(":input:first").focus()},handleSubmitSuccess:function(){this.triggerEvent("submitted");AJS.reloadViaWindowLocation()},performAnalytics:function(){var a=function(d,e){var c="***** Analytics log ["+d+"]";if(e){c+="["+JSON.stringify(e)+"]"}AJS.log(c);if(AJS.EventQueue){AJS.EventQueue.push({name:d,properties:e||{}})}};var b=function(e){var c={};var f=_.filter(e,function(g){return !_.contains(["isCreateIssue","isEditIssue","atl_token","hasWorkStarted"],g.name)});var d=_.filter(f,function(g){return g.value!=""});_.each(d,function(h){var g=h.name;if(!_.has(c,g)){c[g]=[]}c[g].push(h.value)});return c};this.previousAnalytics=(function(k,o){var f=b(k);var m=_.keys(f);var g=_.keys(o.data);var j=_.difference(m,g);var n=_.difference(g,m);var l=_.intersection(g,m);var d=_.filter(l,function(p){return _.isEqual(o.data[p],f[p])});var c=_.difference(l,d);var i=o.count+1;var h=(JIRA.Dialog.current.options.id==="edit-issue-dialog");var e={"atlassian.numCreates":i,"edit.form":h};_.each(j,function(p){e[p]="added"});_.each(n,function(p){e[p]="removed"});_.each(d,function(p){e[p]="same"});_.each(c,function(p){e[p]="changed"});a("quick.create.fields",e);return{data:f,count:i}})(this.getForm().serializeArray(),this.previousAnalytics||{data:{},count:0})},handleSubmitError:function(d){var a=this;var f;try{f=JSON.parse(d.responseText)}catch(c){}if(f){if(f.errorMessages&&f.errorMessages.length){JIRA.applyErrorMessageToForm(this.getForm(),f.errorMessages[0])}if(f&&f.errors&&d.status===400){if(this.getFieldById){jQuery.each(f.errors,function(e){if(/^timetracking/.test(e)){a.getFieldById("timetracking").done(function(g){JIRA.trigger(JIRA.Events.VALIDATE_TIMETRACKING,[a.$element]);g.activate(true)})}else{if(/^worklog/.test(e)){a.getFieldById("worklog").done(function(g){JIRA.trigger(JIRA.Events.VALIDATE_TIMETRACKING,[a.$element]);g.activate(true)})}else{a.getFieldById(e).done(function(g){g.activate(true)})}}})}JIRA.applyErrorsToForm(this.getForm(),f.errors);this.triggerEvent("validationError",[this,f.errors],true)}var b=a.$element.find(".error");if(b.length){b[0].scrollIntoView(false)}}},getAction:function(){return this.action},getFormContent:function(){return this.$element.find("div.content")},getForm:function(){return this.$element.find("form")},createField:function(){throw new Error("JIRA.Forms.AbstractForm: You must implement [createField] method in subclass.")},_getActiveAttachments:function(a){var b=[];if(!a){return b}var d=a.split("&");for(var c=0;c<d.length;c++){var e=d[c].split("=");if(e[0]=="filetoconvert"){b.push(e[1])}}return b},_setActiveAttachments:function(b){var a=this.$element.find("input[name=filetoconvert]");a.each(function(){var d=jQuery(this);var c=_.contains(b,d.attr("value"));d.prop("checked",c)})},render:function(c){var b=jQuery.Deferred(),a=this;var d=a._getActiveAttachments(c);if(c){this.invalidateFieldsCache();this.model.refresh(c).done(function(){a._render().done(function(f,e){a.triggerEvent("rendered",[a.$element]);b.resolveWith(a,[a.$element,e])})})}else{a._render().done(function(f,e){a.triggerEvent("rendered",[a.$element]);b.resolveWith(a,[a.$element,e])})}b.always(function(){a._setActiveAttachments(d)});return b.promise()}});JIRA.Forms.AbstractConfigurableForm=JIRA.Forms.AbstractForm.extend({getFields:function(){var b=jQuery.Deferred(),a=this;if(!this.fields){this.fields=[];this.model.getConfigurableFields().done(function(c){jQuery.each(c,function(d,f){var e=a.createField(f);a.fields.push(e)});b.resolveWith(a,[a.fields])})}else{b.resolveWith(this,[this.fields])}return b.promise()},getActiveFieldIds:function(){var b=[],a=this.$element.find(".qf-field.qf-field-active:not(.qf-required), .qf-field.qf-required:not(.qf-field-active)");jQuery.each(a,function(e,f){var d=jQuery(f);var c=d.data("model");var g=d.data("field-id")||c&&c.getId();if(g!=null){b.push(g)}if(g==="attachment"){d.find("input[name=filetoconvert]").each(function(){b.push(this.id)})}});return b},createField:function(c){c.hasVisibilityFeature=this.model.hasVisibilityFeature(c);if(this.model.hasRetainFeature(c)){c.hasRetainFeature=true;c.retainValue=this.model.hasRetainedValue(c)}var a=this,b=new JIRA.Forms.ConfigurableField(c);if(c.hasVisibilityFeature){b.bind("activated",function(){a.model.setUserFields(a.getActiveFieldIds());b.highlight();a.triggerEvent("QuickForm.fieldAdded",[b])}).bind("disabled",function(){a.model.setUserFields(a.getActiveFieldIds());a.triggerEvent("QuickForm.fieldRemoved",[b])})}return b},getFieldById:function(c){var a=this,b=jQuery.Deferred();this.getFields().done(function(d){jQuery.each(d,function(e,f){if(f.getId()===c){b.resolveWith(a,[f])}});b.rejectWith(a,[])});return b.promise()},hasNoVisibleFields:function(){var a=jQuery.Deferred();a.resolve(this.getActiveFieldIds().length===0);return a.promise()},renderFormContents:function(){var c=jQuery.Deferred(),b=jQuery(),a=this;a.getFields().done(function(d){a.model.getActiveFieldIds().done(function(e){jQuery.each(d,function(){var f=this.render();b=b.add(f.scripts);a.getFormContent().append(f.element)});jQuery.each(e,function(g,f){jQuery.each(d,function(){if(this.getId()===f){this.activate(true)}})});jQuery.each(d,function(){if(!this.isActive()){this.disable(true)}});a.hasNoVisibleFields().done(function(g){if(g===true){for(var f=0;f<3;f++){if(d[f]){d[f].activate(true)}}}c.resolveWith(this,[a.$element,b])})})});return c.promise()}});JIRA.Forms.AbstractUnconfigurableForm=JIRA.Forms.AbstractForm.extend({getFieldsHtml:function(){var a=this,b=jQuery.Deferred(),c={};this.model.getTabs().done(function(d){if(d.length===1){c.fields=d[0].fields}else{c.tabs=d;c.hasTabs=true}b.resolveWith(a,[JIRA.Templates.Issue.issueFields(c)])});return b.promise()},getActiveFieldIds:function(){var b=[];this.model.getFields().done(function(c){jQuery.each(c,function(d,e){b.push(e.id)})});if(b.indexOf("attachment")){var a=this.$element.find("input[name=filetoconvert]").map(function(c,d){return d.id}).toArray();b.push.apply(b,a)}return b},getFields:function(){var b=jQuery.Deferred(),a=this;if(!this.fields){this.fields=[];this.model.getFields().done(function(c){jQuery.each(c,function(d,f){var e=a.createField(f);a.fields.push(e)});b.resolveWith(a,[a.fields])})}else{b.resolveWith(this,[this.fields])}return b.promise()}});JIRA.Forms.Error=AJS.Control.extend({getErrorMessageFromSmartAjax:function(a){var b,c;if(a.hasData&&a.status!==401){try{c=JSON.parse(a.data);if(c.errorMessages&&c.errorMessages.length>0){b=JIRA.Templates.QuickForm.errorMessage({message:c.errorMessages[0]})}else{b=JIRA.SmartAjax.buildDialogErrorContent(a,true).html()}}catch(d){b=JIRA.SmartAjax.buildDialogErrorContent(a,true).html()}}else{b=JIRA.SmartAjax.buildDialogErrorContent(a,true).html()}return b},render:function(b){var a=this.getErrorMessageFromSmartAjax(b);return this._render(a)}});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/container.js' */
JIRA.Forms.Container=AJS.Control.extend({init:function(a){this.$element=jQuery("<div />").addClass("qf-container");this.options=JIRA.makePropertyFunc(a);this.fieldPicker=new JIRA.Forms.FieldPicker();this.successData=[]},decorateRenderers:function(){var a=this;if(!this.fieldPicker.decorated){this.fieldPicker.bind("switchedToAll",function(){a.unconfigurableForm.render(a.currentView.serialize(true)).done(function(){a.fieldPicker.show()})});this.fieldPicker.bind("switchedToCustom",function(){a.configurableForm.render(a.currentView.serialize(true)).done(function(){a.fieldPicker.show()})});this.fieldPicker.decorated=true}if(!this.configurableForm.decorated){this.configurableForm.bind("rendered",function(c,b){a.currentView=a.configurableForm;a.fieldPicker.switchToCustom(true);a.fieldPicker.setForm(a.configurableForm);a.fieldPicker.bindInlineDialog();a.applyGlobalDecorator(b);a.model.setUseConfigurableForm(true);a.triggerEvent("configurableFormRendered")});this.configurableForm.bind("submitted",function(c,b){a.successData.push(b);a.triggerEvent("configurableFormSubmitted")});this.configurableForm.decorated=true}if(!this.unconfigurableForm.decorated){this.unconfigurableForm.bind("rendered",function(c,b){a.fieldPicker.switchToAll(true);a.fieldPicker.setForm(a.unconfigurableForm);a.fieldPicker.bindInlineDialog();a.currentView=a.unconfigurableForm;a.applyGlobalDecorator(b);a.model.setUseConfigurableForm(false);a.triggerEvent("unconfigurableFormRendered")});this.unconfigurableForm.bind("submitted",function(c,b){a.successData.push(b);a.triggerEvent("unconfigurableFormSubmitted")});this.unconfigurableForm.decorated=true}},applyGlobalDecorator:function(c){function b(){if(a.currentView.setInitialFocus){a.currentView.setInitialFocus()}}var a=this;c.detach();this.$element.html(c);this.triggerEvent("contentRefreshed",[this.$element]);if(jQuery.browser.msie){window.setTimeout(b,0)}else{b()}},asDialog:function(b){var a=this,c;this.dialog=c=new JIRA.FormDialog({id:b.id,trigger:b.trigger,windowTitle:b.windowTitle,width:JIRA.Dialog.WIDTH_PRESETS.large,delayShowUntil:JIRA.Dialogs.waitForSavesToComplete,content:function(d){a.render().done(function(){d(a.$element)});a.triggerEvent("dialogShown")},submitHandler:function(f,d){f.preventDefault();a.currentView.submit().then(d,d)},stacked:true});if(b.id==="edit-issue-dialog"){jQuery(this.dialog).on("beforeShow",function(d){if(!jira.app.issue.getIssueKey()&&!jira.app.issuenavigator.isRowSelected()){d.preventDefault()}})}this.dialog._focusFirstField=function(){JIRA.FormDialog.prototype._focusFirstField.apply(this,["div.content :input:visible:first"])};this.bind("initialized",function(){this.unconfigurableForm.bind("sessionComplete",function(){c.hide()});this.configurableForm.bind("sessionComplete",function(){c.hide()})}).bind("contentRefreshed",function(){c.notifyOfNewContent()});c.bind("Dialog.hide",function(){if(a.successData.length){a.triggerEvent("sessionComplete",[a.successData],true);a.successData=[]}});a.$element.ajaxStart(function(){c.showFooterLoadingIndicator()}).ajaxStop(function(){c.hideFooterLoadingIndicator()});c.getQuickForm=function(){return a};c.dirtyFormWarning();return c},lazyInit:function(){var a=this,b=this.options.call(this);this.model=b.model;this.errorHandler=b.errorHandler;this.globalEventNamespaces=b.globalEventNamespaces;this.configurableForm=b.configurableForm;this.unconfigurableForm=b.unconfigurableForm;this.sessionComplete=b.sessionComplete;this.model.clearRetainedFields();this.configurableForm.invalidateFieldsCache();this.model.bind("serverError",function(d,c){a.$element.html(a.errorHandler.render(c));a.triggerEvent("contentRefreshed",[this.$element])});this.triggerEvent("initialized");this.decorateRenderers()},render:function(){var a=this,b=jQuery.Deferred();this.lazyInit();a.model.getUseConfigurableForm().done(function(c){if(c===true){a.configurableForm.render().done(function(e,d){b.resolveWith(a,[a.$element]);a.$element.append(d)})}else{a.unconfigurableForm.render().done(function(e,d){b.resolveWith(a,[a.$element,d]);a.$element.append(d)})}}).fail(function(){b.resolveWith(a,[a.$element])});return b.promise()}});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-create-issue', location = 'js/Issue/create.js' */
JIRA.Forms.CreateIssueModel=JIRA.Forms.Model.extend({DEFAULT_NON_RETAINED_FIELDS:["summary","description","timetracking","timetracking_originalestimate","timetracking_remainingestimate","worklog","worklog_startDate","worklog_timeLogged","worklog_newEstimate","worklog_adjustmentAmount","attachment"],CUSTOMFIELD_PATTERN:/^(customfield_(\d+))(?:|\:(?:\d+))$/,TIMETRACKING_PATTERN:/^timetracking_/,init:function(a){a=a||{};this.userFieldsResource=contextPath+"/rest/quickedit/1.0/userpreferences/create";this._hasRetainFeature=true;this._hasVisibilityFeature=true;this.retainedFields=[];this.dirtyFields=[];this.initIssueType=a.issueType;this.initProjectId=a.projectId;this.parentIssueId=a.parentIssueId;this.nonRetainedFields=this.DEFAULT_NON_RETAINED_FIELDS;if(a.nonRetainedFields){this.nonRetainedFields=_.union(a.nonRetainedFields,this.DEFAULT_NON_RETAINED_FIELDS)}},getParentIssueId:function(){return this.parentIssueId},isInMultipleMode:function(){return this.multipleMode},setIsMultipleMode:function(a){this.multipleMode=a},getActiveFieldIds:function(){var a=this,b=jQuery.Deferred(),c=[];this.getUserFields().done(function(d){jQuery.each(d,function(f,e){c.push(e)});a.getRequiredFields().done(function(e){jQuery.each(e,function(g,f){if(jQuery.inArray(f.id,c)===-1){c.push(f.id)}});b.resolve(c)})});return b.promise()},hasVisibilityFeature:function(a){return !a.required},getFieldsResource:function(){var a=contextPath+"/secure/QuickCreateIssue!default.jspa?decorator=none";if(this.parentIssueId){return a+"&parentIssueId="+this.parentIssueId}if(this.initIssueType){a=a+"&issuetype="+this.initIssueType;delete this.initIssueType}if(this.initProjectId){a=a+"&pid="+this.initProjectId;delete this.initProjectId}return a},addFieldToRetainValue:function(d,b){var a=!_.contains(this.nonRetainedFields,d);var c=d.match(/^filetoconvert/)!==null;if(a||c||b){this._super(d)}},getRequiredFields:function(){var a=jQuery.Deferred(),b=[];this.getFields().done(function(c){jQuery.each(c,function(d,e){if(e.required){b.push(e)}});a.resolve(b)});return a.promise()},getConfigurableFields:function(){var a=jQuery.Deferred(),b=[];this.getFields().done(function(c){jQuery.each(c,function(d,e){if(e.id!=="project"&&e.id!=="issuetype"){b.push(e)}});a.resolve(b)});return a.promise()},getIssueSetupFields:function(){var a=jQuery.Deferred(),b=[];this.getFields().done(function(c){jQuery.each(c,function(d,e){if(e.id==="project"||e.id==="issuetype"){b.push(e)}});a.resolve(b)});return a.promise()},markFieldAsDirty:function(a){a=this.normalizeCustomFieldId(a);if(!this.fieldIsDirty(a)){this.dirtyFields.push(a)}},fieldIsDirty:function(a){return _.contains(this.dirtyFields,a)},isCustomFieldId:function(a){return !!a.match(this.CUSTOMFIELD_PATTERN)},isTimetrackingFieldId:function(a){return !!a.match(this.TIMETRACKING_PATTERN)},normalizeCustomFieldId:function(a){if(this.isCustomFieldId(a)){return a.match(this.CUSTOMFIELD_PATTERN)[1]}else{return a}},normalizeFieldParam:function(a,b){if(a=="filetoconvert"){return a+"-"+b}else{if(this.isCustomFieldId(a)){return this.normalizeCustomFieldId(a)}else{if(this.isTimetrackingFieldId(a)){return"timetracking"}else{return a}}}}});JIRA.Forms.CreateIssueHelper=Class.extend({init:function(a){this.form=a},handleSubmitSuccess:function(d){function c(e,g,f){var h='<a href="'+f+'">'+e+" - "+AJS.escapeHTML(g)+"</a>";return AJS.format("Issue {0} has been successfully created",h)}var a=this,b=this.form.$element.find("#summary").val();d.summary=b;this.form.triggerEvent("submitted",[d,this]);this.form.triggerEvent("issueCreated",[d,this],true);if(a.form.model.isInMultipleMode()){this.form.render().done(function(){var e=c(d.issueKey,b,contextPath+"/browse/"+d.issueKey);JIRA.applySuccessMessageToForm(a.form.getForm(),e)})}else{this.form.triggerEvent("sessionComplete")}},getCreateAnotherCheckbox:function(){return this.form.$element.find("#qf-create-another")},isInMultipleMode:function(){return this.getCreateAnotherCheckbox().is(":checked")},getProjectField:function(){return this.form.$element.find(".issue-setup-fields #project")},getIssueTypeField:function(){return this.form.$element.find(".issue-setup-fields #issuetype")},serializeForToggle:function(c){if(!this.form.model.hasRetainFeature()){return this.form.getForm().serialize()}var e=this.form.model.prevActiveFields||[];var k=this.form.getForm().serializeArray();var g=function(l){return this.form.model.normalizeFieldParam(l.name,l.value)}.bind(this);var d=this.form.getActiveFieldIds();var f=jQuery.grep(k,function(l){return jQuery.inArray(g(l),d)!==-1});var a=jQuery.grep(e,function(l){return jQuery.inArray(g(l),d)===-1});var b=jQuery.map(a,function(l){return g(l)});var i=jQuery.merge(f,a);var h=jQuery.merge(d,b);this.form.model.prevActiveFields=jQuery.extend(true,[],i);if(c){h=this.executeProjectChangedSecuritySettingAction(h)}h=h.filter(function(l){return !this.form.model.isCustomFieldId(l)||this.form.model.fieldIsDirty(l)}.bind(this));var j=jQuery.merge([{name:"retainValues",value:true}],i);jQuery.each(k,function(l,m){if(m.name==="pid"||m.name==="issuetype"){j.push(m)}});j.push({name:"toggle",value:true});jQuery.each(h,function(l,m){j.push({name:"fieldsToRetain",value:m})});j.push({name:"formToken",value:this.form.model.getFormToken()});return jQuery.param(j)},executeProjectChangedSecuritySettingAction:function(a){return _.reject(a,function(b){return b==="security"})},prepareFieldsToRetain:function(a,b){jQuery.each(a,function(c,d){b.push({name:"fieldsToRetain",value:d})});return b},setIssueType:function(){var a=this,b=this.serializeForToggle();this.form.invalidateFieldsCache();this.form.disable();this.form.render(b).done(function(){a.form.enable()})},setProjectId:function(){var a=this,b=this.serializeForToggle(true);this.form.invalidateFieldsCache();this.form.disable();this.form.render(b).done(function(){a.form.enable()})},saveFormDirtyStatus:function(){this.form.isDirty=this.form.getForm().isDirty()},restoreFormDirtyStatus:function(){if(this.form.isDirty){this.form.getForm().addClass(JIRA.DirtyForm.ClassNames.BY_DEFAULT)}},decorate:function(){var a=this;this.getProjectField().change(function(){a.saveFormDirtyStatus();JIRA.trigger("dialogBeforeContentChange",["projectId",this.value,JIRA.Dialog.current.options.id]);a.setProjectId(this.value)});this.getIssueTypeField().change(function(){a.saveFormDirtyStatus();JIRA.trigger("dialogBeforeContentChange",["issueType",this.value,JIRA.Dialog.current.options.id]);a.setIssueType(this.value)});this.getCreateAnotherCheckbox().change(function(){a.form.model.setIsMultipleMode(this.checked)})},decorateFields:function(){var a=this;this.form.$element.find('*[id^="customfield_"]').off("change.customField").on("change.customField",function(){a.form.model.markFieldAsDirty(this.name)})}});JIRA.Forms.CreateIssueError=JIRA.Forms.Error.extend({_render:function(a){return jQuery(JIRA.Templates.Issue.createIssueError({errorHtml:a,useLegacyDecorator:JIRA.useLegacyDecorator()}))}});JIRA.Forms.UnconfigurableCreateIssueForm=JIRA.Forms.AbstractUnconfigurableForm.extend({init:function(a){this._serialization={};this.globalEventNamespaces=a.globalEventNamespaces||[];this.model=a.model;this.helper=new JIRA.Forms.CreateIssueHelper(this);this.title=a.title;this.action=contextPath+"/secure/QuickCreateIssue.jspa?decorator=none";this.$element=jQuery("<div class='qf-unconfigurable-form' />")},handleSubmitSuccess:function(a){this.helper.handleSubmitSuccess(a)},_render:function(){var b=jQuery.Deferred(),a=this;this.getFieldsHtml().done(function(c){a.model.getIssueSetupFields().done(function(f){var e=JIRA.Templates.Issue.createIssueForm({issueSetupFields:f,fieldsHtml:c,parentIssueId:a.model.getParentIssueId(),atlToken:a.model.getAtlToken(),formToken:a.model.getFormToken(),title:a.title,multipleMode:a.model.isInMultipleMode(),useLegacyDecorator:JIRA.useLegacyDecorator(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous(),modifierKey:AJS.Navigator.modifierKey()}),d=JIRA.extractScripts(e);a.$element.empty().append(d.html);a.helper.restoreFormDirtyStatus();a.helper.decorate();a.helper.decorateFields();b.resolveWith(a,[a.$element,d.scripts])})});return b.promise()}});JIRA.Forms.ConfigurableCreateIssueForm=JIRA.Forms.AbstractConfigurableForm.extend({init:function(a){this.model=a.model;this.helper=new JIRA.Forms.CreateIssueHelper(this);this.globalEventNamespaces=a.globalEventNamespaces||[];this.issueId=a.issueId;this.title=a.title;this._serialization={};this.action=contextPath+"/secure/QuickCreateIssue.jspa?decorator=none";this.$element=jQuery("<div />").addClass("qf-form qf-configurable-form")},handleSubmitSuccess:function(a){return this.helper.handleSubmitSuccess(a)},_render:function(){var b=jQuery.Deferred(),a=this;a.model.getIssueSetupFields().done(function(d){var c=JIRA.Templates.Issue.createIssueForm({issueSetupFields:d,atlToken:a.model.getAtlToken(),formToken:a.model.getFormToken(),isConfigurable:true,title:a.title,parentIssueId:a.model.getParentIssueId(),useLegacyDecorator:JIRA.useLegacyDecorator(),multipleMode:a.model.isInMultipleMode(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous(),modifierKey:AJS.Navigator.modifierKey()});a.$element.html(c);a.helper.decorate();a.renderFormContents().done(function(f,e){a.helper.decorateFields();b.resolveWith(a,[a.$element,e])});a.bind("QuickForm.fieldAdded",function(){a.helper.decorateFields()})});return b.promise()}});JIRA.Forms.createCreateIssueForm=function(a){a=a||{};return new JIRA.Forms.Container(function(){a.globalEventNamespaces=a.globalEventNamespaces||["QuickCreateIssue"];var e="Create Issue",b=new JIRA.Forms.CreateIssueModel({projectId:a.pid,issueType:a.issueType}),d=new JIRA.Forms.ConfigurableCreateIssueForm({model:b,title:e,globalEventNamespaces:a.globalEventNamespaces}),c=new JIRA.Forms.UnconfigurableCreateIssueForm({model:b,title:e,globalEventNamespaces:a.globalEventNamespaces});return{globalEventNamespaces:a.globalEventNamespaces,model:b,errorHandler:new JIRA.Forms.CreateIssueError(),configurableForm:d,unconfigurableForm:c}})};JIRA.Forms.createSubtaskForm=(function(){var a=function a(c){return c.parentIssueId||JIRA.Issue.getIssueId()||JIRA.IssueNavigator.getSelectedIssueId()};var b=function b(c){c=c||{};return new JIRA.Forms.Container(function(){c.globalEventNamespaces=c.globalEventNamespaces||["QuickCreateSubtask"];var g=a(c),h=JIRA.Dialog.getIssueActionTitle("Create Subtask"),d=new JIRA.Forms.CreateIssueModel({parentIssueId:g,projectId:c.pid,issueType:c.issueType}),f=new JIRA.Forms.ConfigurableCreateIssueForm({model:d,title:h,globalEventNamespaces:c.globalEventNamespaces}),e=new JIRA.Forms.UnconfigurableCreateIssueForm({model:d,title:h,globalEventNamespaces:c.globalEventNamespaces});return{globalEventNamespaces:c.globalEventNamespaces,model:d,errorHandler:new JIRA.Forms.CreateIssueError(),configurableForm:f,unconfigurableForm:e}})};return b})();jQuery(function(){var a;jQuery(document).on("simpleClick",".create-issue, .create-issue-type",function(f){var b=jQuery(f.target);var d=b.is("a")?b:b.find("a");var g=parseUri(d.attr("href")).queryKey;var c={pid:g.pid,issueType:g.issuetype};c=jQuery.extend(c,{pid:b.attr("data-pid"),issueType:b.attr("data-issue-type")});JIRA.Forms.createCreateIssueForm(c).asDialog({trigger:document.createElement("a"),id:"create-issue-dialog",windowTitle:"Create Issue"}).show();f.preventDefault()});a=document.getElementById("stqc_show");if(a){a.onclick=null}jQuery(document).on("simpleClick",".issueaction-create-subtask",function(f){var b=jQuery(f.target);var d=b.is("a")?b:b.find("a");var c={parentIssueId:d.attr("data-issueid")};JIRA.Forms.createSubtaskForm(c).asDialog({windowTitle:function(){return JIRA.Dialog.getIssueActionTitle("Create Subtask")},trigger:document.createElement("a"),id:"create-subtask-dialog"}).show();f.preventDefault()})});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-create-issue', location = 'js/Issue/issue.soy' */
// This file was automatically generated from issue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issue == 'undefined') { JIRA.Templates.Issue = {}; }


JIRA.Templates.Issue.editIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Edit Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.editIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" name="jiraform" class="aui"><h2>', (opt_data.showFieldConfigurationToolBar) ? '<div class="qf-form-operations aui-toolbar"><div class="toolbar-split toolbar-split-right"><div class="toolbar-group"><span class="toolbar-item"><a href="#" class="toolbar-trigger" id="qf-field-picker-trigger"><span class="icon icon-tools"></span>' + soy.$$escapeHtml("Configure Fields") + '<span class="icon drop-menu"></span></a></span></div></div></div>' : '', opt_data.title, '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '"><input type="hidden" name="id" value="', soy.$$escapeHtml(opt_data.issueId), '" /><input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', (opt_data.commentField) ? opt_data.commentField.editHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button" id="edit-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Update"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.issueFields = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.hasTabs) {
    output.append('<div class="aui-tabs horizontal-tabs" id="horizontal"><ul class="tabs-menu">');
    var tabList68 = opt_data.tabs;
    var tabListLen68 = tabList68.length;
    for (var tabIndex68 = 0; tabIndex68 < tabListLen68; tabIndex68++) {
      var tabData68 = tabList68[tabIndex68];
      output.append((tabData68) ? '<li class="menu-item ' + ((tabData68.isFirst) ? 'first active-tab' : '') + ' "><a href="#tab-' + soy.$$escapeHtml(tabData68.position) + '" ><strong>' + soy.$$escapeHtml(tabData68.label) + '</strong></a></li>' : '');
    }
    output.append('</ul>');
    var tabList82 = opt_data.tabs;
    var tabListLen82 = tabList82.length;
    for (var tabIndex82 = 0; tabIndex82 < tabListLen82; tabIndex82++) {
      var tabData82 = tabList82[tabIndex82];
      if (tabData82) {
        output.append('<div class="tabs-pane ', (tabData82.isFirst) ? 'active-pane' : '', '" id="tab-', soy.$$escapeHtml(tabData82.position), '">');
        var fieldList92 = tabData82.fields;
        var fieldListLen92 = fieldList92.length;
        for (var fieldIndex92 = 0; fieldIndex92 < fieldListLen92; fieldIndex92++) {
          var fieldData92 = fieldList92[fieldIndex92];
          output.append((fieldData92.editHtml) ? fieldData92.editHtml : '');
        }
        output.append('</div>');
      }
    }
    output.append('</div>');
  } else {
    var fieldList102 = opt_data.fields;
    var fieldListLen102 = fieldList102.length;
    for (var fieldIndex102 = 0; fieldIndex102 < fieldListLen102; fieldIndex102++) {
      var fieldData102 = fieldList102[fieldIndex102];
      output.append((fieldData102.editHtml) ? fieldData102.editHtml : '');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form name="jiraform" action="#" class="aui"><h2>', (opt_data.showFieldConfigurationToolBar) ? '<div class="qf-form-operations aui-toolbar"><div class="toolbar-split toolbar-split-right"><div class="toolbar-group"><span class="toolbar-item"><a href="#" class="toolbar-trigger" id="qf-field-picker-trigger"><span class="icon icon-tools"></span>' + soy.$$escapeHtml("Configure Fields") + '<span class="icon drop-menu"></span></a></span></div></div></div>' : '', soy.$$escapeHtml(opt_data.title), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">');
  if (opt_data.issueSetupFields) {
    output.append('<div class="issue-setup-fields">');
    var fieldList126 = opt_data.issueSetupFields;
    var fieldListLen126 = fieldList126.length;
    for (var fieldIndex126 = 0; fieldIndex126 < fieldListLen126; fieldIndex126++) {
      var fieldData126 = fieldList126[fieldIndex126];
      output.append('<div class="qf-field qf-field-', soy.$$escapeHtml(fieldData126.id), ' qf-required" data-field-id="', soy.$$escapeHtml(fieldData126.id), '">', fieldData126.editHtml, '</div>');
    }
    output.append('</div>');
  }
  output.append((opt_data.parentIssueId) ? '<input type="hidden" name="parentIssueId" value="' + soy.$$escapeHtml(opt_data.parentIssueId) + '" />' : '', '<input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><label for="qf-create-another" class="qf-create-another"><input id="qf-create-another" type="checkbox" ', (opt_data.multipleMode) ? 'checked="checked"' : '', ' />', soy.$$escapeHtml("Create another"), '</label><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button aui-button-primary" id="create-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Create"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Create Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-footer', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.undealtErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div>', soy.$$escapeHtml("There were some errors when trying to create this issue"), '</div><ul>');
  var errorList193 = opt_data.errors;
  var errorListLen193 = errorList193.length;
  for (var errorIndex193 = 0; errorIndex193 < errorListLen193; errorIndex193++) {
    var errorData193 = errorList193[errorIndex193];
    output.append('<li>', soy.$$escapeHtml(errorData193), '</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics', location = 'browser-metrics-legacy.js' */
(function(){var a=window.BrowserMetrics||{};var b=window.WRM||{};a.isFunction=function(c){return !!(c&&c.constructor&&c.call&&c.apply)};a.isEnabled=function(){if(a.enabled===undefined){var c="com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy";a.enabled=a.isFunction(b.data)?b.data(c):b.data.claim(c)}return a.enabled};window.BrowserMetrics=a}());(function(){var b=window.BrowserMetrics||{};if(b.isEnabled()){var f=5;var e=12000;var c=function(g){return Math.round(g)};var a=function(g){return Math.round(g*100)/100};var d=function(k){var h=(function(){var n=/^(\w+):\/\/([^\/]*)(.*)$/;return function(p){var o=p.match(n);if(!o){return{path:p}}return{scheme:o[1],host:o[2],path:o[3]}}}());var i=(function(){var n=["secureConnectionStart","requestStart","responseStart","responseEnd","domContentLoadedEventStart","domContentLoadedEventEnd","loadEventEnd"];return function(o){if(k.performance&&k.performance.getEntries){Array.prototype.forEach.call(k.performance.getEntries(),function(u){if(u.name.match("experimental/main.js")){o("experimentalMainJsDuration",u.duration)}})}if(k.performance){var s=k.performance.timing;var p=s.navigationStart;if(p){for(var r=0;r<n.length;++r){var q=n[r];var t=s[q];if(t){o(q,t-p)}}}}}}());var g=(function(){var o=[{key:"LOGIN",pattern:/^\/login.*/i},{key:"J-DASH",pattern:/^\/secure\/dashboard\.jspa.*/i},{key:"J-ISSUE",pattern:/^\/browse\/\w+\-\w+.*/i},{key:"J-NAV",pattern:/^\/issues.*/i},{key:"J-RAPID",pattern:/secure\/rapidboard\.jspa/i},{key:"SD-AGENT",pattern:/^(\/\w+)?\/servicedesk\/agent\/.*/i},{key:"SD-CUSTOMER",pattern:/^(\/\w+)?\/servicedesk\/customer\/.*/i},{key:"C-DASH",pattern:/^\/wiki(\/)?(\?.*|#.*)?$/i},{key:"C-DASH",pattern:/^\/wiki\/dashboard\.action.*$/i},{key:"C-SPACE",pattern:/^\/wiki\/display\/\w+(\?.*|#.*)?$/i},{key:"C-PAGE",pattern:/^\/wiki\/display\/\w+\/.*/i},{key:"C-PAGE",pattern:/^\/wiki\/pages\/viewpage\.action.*/i},{key:"C-BLOG",pattern:/^\/wiki\/display\/~\w+\/\d+\/\d+\/\d+\/.*/i},{key:"C-EDITOR",pattern:/^\/wiki\/pages\/editpage\.action.*/i},{key:"C-CREATE",pattern:/^\/wiki\/pages\/createpage\.action.*/i}];return function n(){var r=h(k.location.href).path;for(var p=0;p<o.length;++p){var q=o[p];if(r.match(q.pattern)){return q.key}}return null}}());function j(){var n=g();if(n){i(function(p,r){var o="browser.metrics."+p,q={version:f,page:n,value:r>e?"x":Math.ceil((r)/100),rawValue:c(r)};AJS.Analytics?AJS.Analytics.triggerPrivacyPolicySafeEvent(o,q):AJS.trigger("analyticsEvent",{name:o,data:q})})}}function m(){try{j()}catch(n){if(window.console){window.console.log("Error reporting browser metrics: "+n)}}}function l(){if(k.performance.timing.loadEventEnd){m()}else{setTimeout(l,1000)}}if(k.performance&&k.performance.timing){l()}};if(!window.ATL_PERF){window.ATL_PERF={}}window.ATL_PERF.initPageLoad=d}}());(function(){var b=window.BrowserMetrics||{};if(b.isEnabled()){var e=5;var d=12000;var a=function(f){return Math.round(f*100)/100};var c=function(g){var l={};function h(){return g.performance&&g.performance.now?g.performance.now():new Date().getTime()}function n(o){return o===Object(o)}function k(o){if(n(o)){return o.eventName+"."+o.eventType}else{return o}}function m(o){if(n(o)){return o.eventName}else{return o}}function j(o){if(n(o)){return o.eventType}else{return""}}function f(o){var p=k(o);l[p]=h()}function i(r,u){var v=k(r);if(!l[v]){throw ("Error logging browser metrics event end: no start event for key '"+v+"'")}var t=h()-l[v];l[v]=null;var o=m(r),q=j(r);var p="browser.metrics.e."+o+(u?"."+u:""),s={version:e,value:t>d?"x":Math.ceil((t)/100),rawValue:a(t),eventType:q};g.AJS.Analytics?g.AJS.Analytics.triggerPrivacyPolicySafeEvent(p,s):g.AJS.trigger("analyticsEvent",{name:p,data:s})}return{start:f,end:i}};if(!window.ATL_PERF){window.ATL_PERF={}}window.ATL_PERF.initEvents=c}}());(function(){var a=window.BrowserMetrics||{};if(a.isEnabled()){if(Math.random()<0.1){window.ATL_PERF&&window.ATL_PERF.initPageLoad&&window.ATL_PERF.initPageLoad(window)}window.ATL_PERF&&window.ATL_PERF.initEvents&&(function(){window.BrowserMetrics=window.ATL_PERF.initEvents(window)}())}}());;
;/* module-key = 'com.atlassian.jira.plugins.jira-browser-metrics:jira-browser-metrics', location = '/js/analytics/dialog-ids.js' */
define("jira/analytics/browser-metrics/dialog-checker",[],function(){allowedIdsArray=["about-dialog","add-basicuser-dialog","add-developer-dialog","add-field-configuration-dialog","add-field-configuration-scheme-dialog","add-field-dialog","add-field-screen-dialog","add-field-screen-scheme-dialog","add-incoming-mail-handler-dialog","add-issue-type-dialog","add-issue-type-field-configuration-association-dialog","add-issue-type-screen-scheme-configuration-association-dialog","add-issue-type-screen-scheme-dialog","add-new-issue-type-to-scheme-dialog","add-screen-scheme-item-dialog","add-subtask-type-dialog","add-workflow-dialog","add_workflowscheme-dialog","assign-dialog","assign-issue-types-dialog","assign-to-me-link-handler","attach-file-dialog","attach-screenshot-dialog","auditing-settings-dialog","clone-issue-dialog","comment-add-dialog","configure_wallboard_dialog","confluence-page-search-dialog","copy_classic default workflow-dialog","copy-filter-dialog","copy_jira-dialog","create-issue-dialog","create-issue-dialog.issueType","create-issue-dialog.projectId","create-request-dialog","create-service-desk-dialog","create-status-dialog","create-story-dialog","create-story-dialog.issueType","create-story-dialog.projectId","create-subtask-dialog","create-subtask-dialog.issueType","create-team-dialog","create_user-dialog","credits-dialog","delete-attachment-dialog","delete-comment-dialog","delete-dshboard","delete-filter-dialog","delete-issue-dialog","delete-issue-link-dialog","delete-log-work-dialog","delete-metric","delete-queue","delete-status-dialog","deleteuser_link-dialog","devstatus-branch-detail-dialog","devstatus-build-detail-dialog","devstatus-commit-detail-dialog","devstatus-cta-dialog","devstatus-deployment-detail-dialog","devstatus-pullrequest-detail-dialog","devstatus-review-detail-dialog","discard-draft-dialog","discard_draft_workflow-dialog","edit-attachments-dialog","edit-comment","editgroups_admin-dialog","editgroups_link-dialog","editgroups_sysadmin-dialog","edit-issue-dialog","edit-labels-dialog","edit-log-work-dialog","edit-status-dialog","edituser_link_admin-dialog","edit-workflow-dialog","gh-rapidboard-dialog","inline-issue-create-dialog","invite_user-dialog","issue-actions-dialog","issue-tab-error-dialog","jim-create-project-dialog","keyboard-shortcuts-dialog","link-issue-dialog","log-work-dialog","manage-attachment-dialog","metric-pre-save-dialog","modal-field-view","permission-helper-dialog","project-avatar-cropper","project-avatar-picker","project-config-details-project-category-dialog","project-config-project-edit-dialog","project-config-project-edit-lead-and-default-assignee-dialog","project-email-dialog","publish_draft_workflow-dialog","queue-dirty-edits","QuickCreateIssue.error","QuickCreateIssue.success","QuickCreateSubtask.error","QuickCreateSubtask.success","QuickEdit.error","QuickEdit.success","remote-jira-search-dialog","rename-filter-dialog","report-dirty-edits","save-filter-dialog","sd-add-default-value","sd-add-remove-agent-dialog","sd-remove-field-dialog","server-error-dialog","report-delete-confirm","tempo-add-hours-issue-dialog","tempo-add-internal-activity-form","tempo-core-medium-form","tempo-delete-form-dialog","tempo-grace-form","tempo-large-form","tempo-medium-form","tempo-move-form-dialog","tempo-pdf-form","tempo-small-form","tempo-split-form-dialog","tempo-user-settings-dialog","user-avatar-picker","user-defaults-edit-dialog","versionsMergeDialog","view-workflow-dialog","view-workflow-dialog-project-admin","view-workflow-dialog-workflow-schemes","wait-migrate-dialog","whereismycf-dialog","workflow-text-view"];var a={};allowedIdsArray.forEach(function(c){a[c]=true});var b=[{key:"component-delete-dialog",pattern:/^component-\d+-delete-dialog$/i},{key:"version-delete-dialog",pattern:/^version-\d+-delete-dialog$/i},{key:"workflow-transition-dialog",pattern:/^workflow-transition-\d+-dialog$/i}];return{transformDialogId:function(c){if(!c){return undefined}if(a[c]){return c}for(var d=0;d<b.length;++d){var e=b[d];if(c.match(e.pattern)){return e.key}}return undefined}}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-browser-metrics:jira-browser-metrics', location = '/js/analytics/browser-metrics.js' */
require(["jira/analytics/browser-metrics/dialog-checker","jira/util/events","jquery"],function(c,a,b){b(function(){var e={startEvent:function(g){try{window.BrowserMetrics&&BrowserMetrics.start(g)}catch(h){console.log(h)}},endEvent:function(g,i){try{window.BrowserMetrics&&BrowserMetrics.end(g,i)}catch(h){console.log(h)}}};var f={openDialogs:{},start:function(){a.bind("dialogContentReady",function(k,i){var h=c.transformDialogId(i.options.id);if(!h){return}var j=f.openDialogs[h];if(j){if(!j.initialized){e.endEvent("jira.dialog.open."+h);j.initialized=true}else{if(j.action){e.endEvent("jira.dialog.change."+h+"."+j.action);j.action=undefined}}}});a.bind("beforeShow",function(j,h){var i=c.transformDialogId(h);if(!i){return}if(f.openDialogs[i]===undefined){f.openDialogs[i]={initialized:false};e.startEvent("jira.dialog.open."+i)}});a.bind("Dialog.hide",function(l,j,k,h){var i=c.transformDialogId(h);if(!i){return}delete f.openDialogs[i]});a.bind("dialogBeforeContentChange",function(l,k,j,h){var i=c.transformDialogId(h);if(!i){return}if(f.openDialogs[i]){f.openDialogs[i].action=k;e.startEvent("jira.dialog.change."+i+"."+k)}});function g(i,j){var h=c.transformDialogId(i);if(!h){return}a.bind(i+".submitting",function(){e.startEvent("jira.dialog."+h)});a.bind(i+"."+j,function(){e.endEvent("jira.dialog."+h,"success")});a.bind(i+".validationError",function(){e.endEvent("jira.dialog."+h,"error")})}["QuickCreateIssue","QuickCreateSubtask"].forEach(function(h){g(h,"issueCreated")});g("QuickEdit","issueEdited")}};var d={start:function(){a.bind("aui-dropdown2-show-before",function(g,h){e.startEvent("jira.header.menu."+h)});a.bind("aui-dropdown2-show-after",function(g,h){e.endEvent("jira.header.menu."+h)})}};if(window.BrowserMetrics!==undefined&&AJS.BrowserMetrics===undefined){[f,d].forEach(function(g){g.start()})}})});;
;/* module-key = 'com.atlassian.jira.jira-invite-user-plugin:inviteuser-signup-resources', location = 'js/inviteuser-signup.js' */
(function(a){JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(c,b){a("#consolation-login-link").click(function(){AJS.EventQueue&&AJS.EventQueue.push({name:"invitationsignupconsolationlogin",properties:{}})})})})(AJS.$);;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/IssuePicker.js' */
if(AJS.Meta.get("is-admin")){AJS.namespace("JIRA.AdminHelper");JIRA.AdminHelper.IssuePicker=AJS.SingleSelect.extend({init:function(a){function b(c){if(!c.sections){return[]}var d=[];AJS.$(c.sections).each(function(e,g){var f=new AJS.GroupDescriptor({weight:e,label:g.label});AJS.$(g.issues).each(function(j,h){f.addItem(new AJS.ItemDescriptor({value:h.key,label:h.key+" - "+h.summaryText,html:h.keyHtml+" - "+h.summary,icon:contextPath+h.img}))});d.push(f)});return d}AJS.$.extend(a,{errorMessage:"Please select an issue",ajaxOptions:{url:contextPath+"/rest/api/1.0/issues/picker?currentJQL=project!=null",query:true,formatResponse:b}});this._super(a)}})};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'templates/common.soy' */
// This file was automatically generated from common.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.AdminHelper == 'undefined') { JIRA.Templates.AdminHelper = {}; }
if (typeof JIRA.Templates.AdminHelper.Common == 'undefined') { JIRA.Templates.AdminHelper.Common = {}; }


JIRA.Templates.AdminHelper.Common.statusImage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.status == 'green') ? '<span class="icon adminhelper-icon-tick"></span> ' : '<span class="icon adminhelper-icon-cross"></span> ');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.AdminHelper.Common.warningImage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="icon adminhelper-icon-warning"></span> ');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.AdminHelper.Common.loadingStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="status-loading" />');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.AdminHelper.Common.statusLineRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<tr class="statusRow ', (opt_data.hideFailedStatuses && opt_data.statusLine.status == 'red') ? 'hidden' : '', '" data-status="', soy.$$escapeHtml(opt_data.statusLine.status), '"><td>');
  JIRA.Templates.AdminHelper.Common.statusImage({status: opt_data.statusLine.status}, output);
  output.append('</td><td>');
  var summaryList23 = opt_data.statusLine.summary;
  var summaryListLen23 = summaryList23.length;
  for (var summaryIndex23 = 0; summaryIndex23 < summaryListLen23; summaryIndex23++) {
    var summaryData23 = summaryList23[summaryIndex23];
    output.append('<p>', summaryData23, '</p>');
  }
  output.append('</td><td>');
  if (opt_data.statusLine.details.length == 1) {
    var detailList32 = opt_data.statusLine.details;
    var detailListLen32 = detailList32.length;
    for (var detailIndex32 = 0; detailIndex32 < detailListLen32; detailIndex32++) {
      var detailData32 = detailList32[detailIndex32];
      output.append(detailData32);
    }
  } else {
    var detailList37 = opt_data.statusLine.details;
    var detailListLen37 = detailList37.length;
    for (var detailIndex37 = 0; detailIndex37 < detailListLen37; detailIndex37++) {
      var detailData37 = detailList37[detailIndex37];
      output.append('<p>', detailData37, '</p>');
    }
  }
  output.append('</td></tr>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'templates/whereismycf-dialog.soy' */
// This file was automatically generated from whereismycf-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Dialogs == 'undefined') { JIRA.Templates.Dialogs = {}; }
if (typeof JIRA.Templates.Dialogs.WhereIsMyCf == 'undefined') { JIRA.Templates.Dialogs.WhereIsMyCf = {}; }


JIRA.Templates.Dialogs.WhereIsMyCf.searchPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui ajs-dirty-warning-exempt"><div class="form-body"><div id="whereismycf-suggestions" class="aui-list" /><div class=\'description\'>', soy.$$escapeHtml("Begin typing to find your field"), '</div><div class="field-status-placeholder"></div></div><div class="buttons-container form-footer"><div class="buttons"><a href="#" class="cancel" id="aui-dialog-close">', soy.$$escapeHtml("Close"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.WhereIsMyCf.resultPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="field-status-results"><div class="aui-message"><ul class="item-details"><li><dl><dt>', soy.$$escapeHtml("Project"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.project), '">', soy.$$escapeHtml(opt_data.project), '</dd></dl><dl><dt>', soy.$$escapeHtml("Issue type"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.issueType), '">', soy.$$escapeHtml(opt_data.issueType), '</dd></dl><dl><dt>', soy.$$escapeHtml("Screen"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.operation), '">', soy.$$escapeHtml(opt_data.operation), '</dd></dl><dl><dt>', soy.$$escapeHtml("Field"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.fieldName), '">', soy.$$escapeHtml(opt_data.fieldName), '</dd></dl><dl><dt>', soy.$$escapeHtml("Status"), ': </dt><dd>');
  JIRA.Templates.AdminHelper.Common.statusImage(opt_data, output);
  output.append((opt_data.status == 'green') ? soy.$$escapeHtml(AJS.format("The \x27\x27{0}\x27\x27 field should be present on the form you are viewing",opt_data.fieldName)) : soy.$$escapeHtml(AJS.format("The \x27\x27{0}\x27\x27 field is not present on the form you are viewing",opt_data.fieldName)), '</dd></dl></li></ul></div>');
  if (opt_data.statusLines.length == 0) {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml(AJS.format("There are no details available about the \x27\x27{0}\x27\x27 field status",opt_data.fieldName)), '</p></div>');
  } else {
    output.append('<table class="status-table aui"><thead><tr><th width="10%">', soy.$$escapeHtml("Status"), '</th><th width="30%">', soy.$$escapeHtml("Summary"), '</th><th width="60%">', soy.$$escapeHtml("Details"), '</th></tr></thead><tbody>');
    var statusLineList57 = opt_data.statusLines;
    var statusLineListLen57 = statusLineList57.length;
    for (var statusLineIndex57 = 0; statusLineIndex57 < statusLineListLen57; statusLineIndex57++) {
      var statusLineData57 = statusLineList57[statusLineIndex57];
      JIRA.Templates.AdminHelper.Common.statusLineRow({statusLine: statusLineData57}, output);
    }
    output.append('<tbody></table>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.WhereIsMyCf.errorPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ajaxerror"><div class="aui-message ', soy.$$escapeHtml(opt_data.errorClass), '">');
  if (opt_data.errorMessages.length == 1) {
    var msgList69 = opt_data.errorMessages;
    var msgListLen69 = msgList69.length;
    for (var msgIndex69 = 0; msgIndex69 < msgListLen69; msgIndex69++) {
      var msgData69 = msgList69[msgIndex69];
      output.append('<p>', soy.$$escapeHtml(msgData69), '</p>');
    }
  } else {
    output.append('<ul>');
    var msgList76 = opt_data.errorMessages;
    var msgListLen76 = msgList76.length;
    for (var msgIndex76 = 0; msgIndex76 < msgListLen76; msgIndex76++) {
      var msgData76 = msgList76[msgIndex76];
      output.append('<li>', soy.$$escapeHtml(msgData76), '</li>');
    }
    output.append('</ul>');
  }
  output.append('</div></div>', (! opt_data.noCloseLink) ? '<div class="buttons-container form-footer"><div class="buttons"><a href="#" class="cancel" id="aui-dialog-close">' + soy.$$escapeHtml("Close") + '</a></div></div>' : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/whereismycf-dialog.js' */
if(AJS.Meta.get("is-admin")){AJS.namespace("JIRA.WhereIsMyCf");JIRA.WhereIsMyCf.WhereIsMyCfDialog=JIRA.Dialog.extend({OPERATION_CREATE:0,OPERATION_EDIT:1,OPERATION_VIEW:2,_getDefaultOptions:function(){return AJS.$.extend(this._super(),{cached:false,id:"whereismycf-dialog",widthClass:"large",stacked:true})},_setContent:function(b,d){var a=this;if(b){this._super(b,d)}else{this._super(AJS.$(JIRA.Templates.Dialogs.WhereIsMyCf.searchPage()),true)}this.get$popupContent().find(".cancel").click(function(f){a.hide();f.preventDefault()});if(JIRA.Dialog.current===this){var c=new JIRA.setFocus.FocusConfiguration();c.context=this.get$popup()[0];c.parentElementSelectors=[".form-body"];JIRA.setFocus.pushConfiguration(c);JIRA.setFocus.triggerFocus()}},_formatActionsResponse:function(a){var b=[];if(a){var c=new AJS.GroupDescriptor({showLabel:false,label:"Fields"});AJS.$(a).each(function(){var d=new AJS.ItemDescriptor({label:this.customFieldName});d.properties.cfId=this.customFieldId;c.addItem(d)});b.push(c)}return b},decorateContent:function(){var b=this,a=JIRA.Meta.getIssueKey();this.addHeading("Where is my field?");this.queryControl=new AJS.QueryableDropdownSelect({id:"whereismycf",element:this.$content.find("#whereismycf-suggestions"),ajaxOptions:{minQueryLength:1,dataType:"json",url:contextPath+"/rest/whereismycf/1.0/fields/all",formatResponse:this._formatActionsResponse},showDropdownButton:true,loadOnInit:true});this.queryControl._handleServerError=function(g){var h=JIRA.SmartAjax.buildSimpleErrorContent(g);var f=g.status===401?"warning":"error";b._setContent(AJS.$(JIRA.Templates.Dialogs.WhereIsMyCf.errorPage({errrorMessage:h,errorClass:f})),false)};var c=this.queryControl.listController.options.selectionHandler;this.queryControl.listController.options.selectionHandler=function(f){c.call(this,f);b.get$popupContent().find(".field-status-results").remove();b.get$popupContent().find(".field-status-placeholder").append(AJS.$(JIRA.Templates.AdminHelper.Common.loadingStatus()));var g=this.getFocused().data("descriptor");AJS.trigger("analyticsEvent",{name:"adminhelper.whereismycf.field.select"});JIRA.SmartAjax.makeRequest({url:contextPath+AJS.format("/rest/whereismycf/1.0/fields/{0}?{1}",g.properties.cfId,b.options.context.asRequestParams()),complete:function(j,k,i){if(i.successful){b.queryControl.$field.val("").css("color","black");b.get$popupContent().find(".status-loading").remove();var h=i.data;b.get$popupContent().find(".field-status-placeholder").append(AJS.$(JIRA.Templates.Dialogs.WhereIsMyCf.resultPage({fieldName:g.label(),issueType:h.issueType,issueKey:h.issueKey,project:h.projectName,operation:h.operation,status:h.status,statusLines:d(h.statusLines),baseUrl:contextPath})))}else{e(b,i)}b._positionInCenter()}});return false};function d(i){if(i.length==0){return i}function g(l){var k=[];AJS.$.each(l,function(m,n){k.push(h(n))});return k}function h(l){if(l.parameters.length==0){return AJS.escapeHTML(l.message)}else{var k=f(l.parameters);k.splice(0,0,AJS.escapeHTML(l.message));return AJS.format.apply(this,k)}}function f(l){var k=[];AJS.$.each(l,function(m,n){if(n.type=="plain"){k.push(AJS.escapeHTML(n.value))}else{if(n.type=="link"){k.push(AJS.format("<a href=''{0}'' target=''_blank''>{1}</a>",AJS.escapeHTML(n.href),AJS.escapeHTML(n.text)))}else{if(n.type=="newline"){k.push("<br/>")}else{if(n.type=="tagstart"){k.push("<"+n.tagName+">")}else{if(n.type=="tagend"){k.push("</"+n.tagName+">")}else{throw"Unrecognized parameter type: "+n.type}}}}}});return k}var j=[];AJS.$.each(i,function(m,k){var l={};l.status=k.status;l.summary=g(k.summary);l.details=g(k.details);j.push(l)});return j}function e(g,h){var j=[];var i=JIRA.SmartAjax.buildSimpleErrorContent(h);if(i){j.push(i)}else{if(h.data&&h.data.errorMessages){j.push(h.data.errorMessages)}if(h.data&&h.data.errors){j.push(h.data.errors)}}var f=h.status===401?"warning":"error";g._setContent(AJS.$(JIRA.Templates.Dialogs.WhereIsMyCf.errorPage({errorMessages:j,errorClass:f})),false)}},show:function(a){if(a){this.context(a)}if(!this.options.context){throw"This class must be initialized with 'context' parameter before calling show()"}this._super()},context:function(a){if(a){this.options.context=a}else{return this.options.context}},hide:function(a){if(this._super(a)===false){return false}JIRA.setFocus.popConfiguration()}});JIRA.WhereIsMyCf.IssueContext=Class.extend({init:function(a){this.options=a||{}},issueKey:function(a){if(a){this.options.issueKey=a}else{return this.options.issueKey}},asRequestParams:function(){function a(c){return typeof(c)!="undefined"}var b="atl_token="+atl_token();if(a(this.options.issueKey)){b+="&issueKey="+this.options.issueKey}if(a(this.options.projectKey)){b+="&projectKey="+this.options.projectKey}if(a(this.options.projectId)){b+="&projectId="+this.options.projectId}if(a(this.options.issueOperation!==undefined)){b+="&issueOperation="+this.options.issueOperation}if(a(this.options.issueTypeId)){b+="&issueTypeId="+this.options.issueTypeId}return b}})};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/whereismycf.js' */
if(AJS.Meta.get("is-admin")){(function(g){var d="Where is my field?";JIRA.WhereIsMyCf.dialog=new JIRA.WhereIsMyCf.WhereIsMyCfDialog;g(document).delegate(".whereismycf-trigger","click",function(i){i.preventDefault();AJS.trigger("analyticsEvent",{name:"adminhelper.whereismycf.dialog.open"});JIRA.WhereIsMyCf.dialog.show(c())});g(document).bind("showLayer",function(j,l,k){if(l=="inlineDialog"&&k.popup.attr("id")=="inline-dialog-field_picker_popup"){if(k.popup.find(".whereismycf-qfpicker-link").length==0){var i=g("<a href='#' class='whereismycf-qfpicker-link'>"+d+"</a>").appendTo(k.popup.find(".qf-picker-header dl"));i.click(function(m){m.preventDefault();k.hide();h();JIRA.WhereIsMyCf.dialog.show(b())})}}});function h(){AJS.InlineDialog.current=null}function f(){var i=JIRA.Issue.getIssueKey();if(!i&&JIRA.IssueNavigator){i=JIRA.IssueNavigator.getSelectedIssueKey()}return i}function c(){return new JIRA.WhereIsMyCf.IssueContext({issueKey:f(),issueOperation:JIRA.WhereIsMyCf.dialog.OPERATION_VIEW})}function b(){var i=JIRA.Dialog.current;if(i.options.id=="create-issue-dialog"){return a(i)}else{if(i.options.id=="edit-issue-dialog"){return e(i)}else{throw"Uknown current dialog ID: "+i.options.id}}}function a(i){var j=i.get$popupContent();return new JIRA.WhereIsMyCf.IssueContext({projectId:j.find("#project").val(),issueTypeId:j.find("#issuetype").val(),issueOperation:JIRA.WhereIsMyCf.dialog.OPERATION_CREATE})}function e(i){var j=i.get$popupContent();return new JIRA.WhereIsMyCf.IssueContext({issueKey:f(),issueTypeId:j.find("#issuetype").val(),issueOperation:JIRA.WhereIsMyCf.dialog.OPERATION_EDIT})}})(AJS.$)};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'templates/permission-helper-dialog.soy' */
// This file was automatically generated from permission-helper-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Dialogs == 'undefined') { JIRA.Templates.Dialogs = {}; }
if (typeof JIRA.Templates.Dialogs.PermissionHelper == 'undefined') { JIRA.Templates.Dialogs.PermissionHelper = {}; }


JIRA.Templates.Dialogs.PermissionHelper.searchPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="permissionhelper-search-form aui ajs-dirty-warning-exempt"><div class="content-area-container"><div class="form-body"><div id="error-message-placeholder"></div><div class="action-description">', soy.$$escapeHtml("Discover why a user does or does not have certain permissions..."), '</div><div class="field-group"><label for="permissionhelper-user">', soy.$$escapeHtml("User"), '</label><select id="permissionhelper-user" name="permissionhelper-user" class="single-user-picker js-default-user-picker" data-container-class="long-field"></select><div class=\'description\'>', soy.$$escapeHtml("Begin typing to find a user, leave blank for Anonymous user"), '</div></div><div class="field-group ', (opt_data.currentIssueKey) ? 'hidden' : '', '"><label for="permissionhelper-issue">', soy.$$escapeHtml("Issue"), '</label><select class="aui-field-select select" name="permissionhelper-issue" id="permissionhelper-issue"></select><div class="description">', soy.$$escapeHtml("Begin typing to find an issue"), '</div></div><div class="field-group"><label for="permissionhelper-permission">', soy.$$escapeHtml("Permission"), '</label><select class="aui-field-select select" name="permissionhelper-permission" id="permissionhelper-permission">');
  var permissionGroupList20 = opt_data.permissionGroups;
  var permissionGroupListLen20 = permissionGroupList20.length;
  for (var permissionGroupIndex20 = 0; permissionGroupIndex20 < permissionGroupListLen20; permissionGroupIndex20++) {
    var permissionGroupData20 = permissionGroupList20[permissionGroupIndex20];
    output.append('<optgroup label="', soy.$$escapeHtml(permissionGroupData20.name), '">');
    var permissionList24 = permissionGroupData20.permissions;
    var permissionListLen24 = permissionList24.length;
    for (var permissionIndex24 = 0; permissionIndex24 < permissionListLen24; permissionIndex24++) {
      var permissionData24 = permissionList24[permissionIndex24];
      output.append('<option ', (permissionData24.id == 10) ? 'selected="selected"' : '', ' value="', soy.$$escapeHtml(permissionData24.id), '">', soy.$$escapeHtml(permissionData24.name), '</option>');
    }
    output.append('</optgroup>');
  }
  output.append('</select><div class=\'description\'>', soy.$$escapeHtml("Begin typing to find a permission or press down to see all"), '</div></div></div><div class="form-body field-status-placeholder" /></div><div class="buttons-container form-footer"><div class="buttons"><input class="button search" type="submit" id="permission-helper-submit" value="', soy.$$escapeHtml("Submit"), '">', (! opt_data.noCloseLink) ? '<a href="#" class="cancel" id="aui-dialog-close">' + soy.$$escapeHtml("Close") + '</a>' : '', '</div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.PermissionHelper.resultPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="field-status-results"><div class="aui-message"><ul class="item-details"><li><dl><dt>', soy.$$escapeHtml("Permission name"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.permissionName), '">', soy.$$escapeHtml(opt_data.permissionName), '</dd></dl><dl><dt>', soy.$$escapeHtml("User"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.userDisplayName), '">', (opt_data.username != '') ? '<a href="' + soy.$$escapeHtml(opt_data.baseUrl) + '/secure/admin/user/ViewUser.jspa?name=' + soy.$$escapeHtml(opt_data.username) + '">' + soy.$$escapeHtml(opt_data.userDisplayName) + '</a>' : soy.$$escapeHtml(opt_data.userDisplayName), '</dd></dl><dl><dt>', soy.$$escapeHtml("Project"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.projectName), '"><a href="', soy.$$escapeHtml(opt_data.baseUrl), '/browse/', soy.$$escapeHtml(opt_data.projectKey), '">', soy.$$escapeHtml(opt_data.projectName), '</a></dd></dl><dl><dt>', soy.$$escapeHtml("Permission scheme"), ': </dt><dd title="blah"><a href="', soy.$$escapeHtml(opt_data.baseUrl), '/plugins/servlet/project-config/', soy.$$escapeHtml(opt_data.projectKey), '/permissions">', soy.$$escapeHtml(opt_data.permissionSchemeName), '</a></dd></dl>', (opt_data.issueKey) ? '<dl><dt>' + soy.$$escapeHtml("Issue") + ': </dt><dd title="' + soy.$$escapeHtml(opt_data.issueKey) + '"><a href="' + soy.$$escapeHtml(opt_data.baseUrl) + '/browse/' + soy.$$escapeHtml(opt_data.issueKey) + '">' + soy.$$escapeHtml(opt_data.issueKey) + '</a></dd></dl>' : '', '<dl><dt>', soy.$$escapeHtml("Status"), ': </dt><dd>');
  JIRA.Templates.AdminHelper.Common.statusImage(opt_data, output);
  output.append((opt_data.status == 'green') ? soy.$$escapeHtml(AJS.format("{0} has the \x27\x27{1}\x27\x27 permission",opt_data.userDisplayName,opt_data.permissionName)) : soy.$$escapeHtml(AJS.format("{0} does not have the \x27\x27{1}\x27\x27 permission",opt_data.userDisplayName,opt_data.permissionName)), '</dd></dl></li></ul></div>');
  if (opt_data.statusLines.length == 0) {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml(AJS.format("There are no details available about the \x27\x27{0}\x27\x27 permission",opt_data.permissionName)), '</p></div>');
  } else {
    output.append('<table class="status-table aui"><thead><tr><th width="10%">', soy.$$escapeHtml("Status"), '</th><th width="30%">', soy.$$escapeHtml("Summary"), '</th><th width="60%">', soy.$$escapeHtml("Details"), '</th></tr></thead><tbody>');
    var statusLineList127 = opt_data.statusLines;
    var statusLineListLen127 = statusLineList127.length;
    for (var statusLineIndex127 = 0; statusLineIndex127 < statusLineListLen127; statusLineIndex127++) {
      var statusLineData127 = statusLineList127[statusLineIndex127];
      JIRA.Templates.AdminHelper.Common.statusLineRow({statusLine: statusLineData127, hideFailedStatuses: opt_data.hideFailedStatuses}, output);
    }
    output.append('<tbody></table><div class="toggle-conditions-container"><a class="show-failed-conditions" ', (opt_data.hideFailedStatuses == false || opt_data.allGreenStatuses == true) ? 'style="display: none"' : '', '>', soy.$$escapeHtml("Show failed conditions"), '</a><a class="hide-failed-conditions" ', (opt_data.hideFailedStatuses == true || opt_data.allFailedStatuses == true) ? 'style="display: none"' : '', '>', soy.$$escapeHtml("Hide failed conditions"), '</a></div>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.PermissionHelper.errorPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ajaxerror"><div class="aui-message ', soy.$$escapeHtml(opt_data.errorClass), '">');
  if (opt_data.errorMessages.length == 1) {
    var msgList152 = opt_data.errorMessages;
    var msgListLen152 = msgList152.length;
    for (var msgIndex152 = 0; msgIndex152 < msgListLen152; msgIndex152++) {
      var msgData152 = msgList152[msgIndex152];
      output.append('<p>', soy.$$escapeHtml(msgData152), '</p>');
    }
  } else {
    output.append('<ul>');
    var msgList159 = opt_data.errorMessages;
    var msgListLen159 = msgList159.length;
    for (var msgIndex159 = 0; msgIndex159 < msgListLen159; msgIndex159++) {
      var msgData159 = msgList159[msgIndex159];
      output.append('<li>', soy.$$escapeHtml(msgData159), '</li>');
    }
    output.append('</ul>');
  }
  output.append('</div></div><div class="buttons-container form-footer"><div class="buttons"><a href="#" class="cancel" id="aui-dialog-close">', soy.$$escapeHtml("Close"), '</a></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/permission-helper-ui.js' */
if(AJS.Meta.get("is-admin")){AJS.namespace("JIRA.PermissionHelper");JIRA.PermissionHelper.PERMISSIONS=WRM.data.claim("com.atlassian.jira.plugins.jira-admin-helper-plugin:permissions-provider.permissions-data");JIRA.PermissionHelper.PermissionHelperUi={initUi:function(d,b,c){i();var l={};l.searchButton=d.find("input.search");l.searchForm=d.find("form.permissionhelper-search-form");var k=function(o){o.preventDefault();var m=h(d,b);d.find(".error").remove();var n=false;if(!m.params().issueKey){e(AJS.$("#permissionhelper-issue",d),"Please select an issue");n=true}if(!m.params().permissionId){e(AJS.$("#permissionhelper-permission"),"Please select a valid permission");n=true}if(n){return}d.find("#error-message-placeholder").empty();d.find(".field-status-results").remove();d.find(".field-status-placeholder").append(AJS.$(JIRA.Templates.AdminHelper.Common.loadingStatus()));AJS.trigger("analyticsEvent",{name:"adminhelper.permhelper.check",data:{permissionId:m.params().permissionId}});JIRA.SmartAjax.makeRequest({url:contextPath+AJS.format("/rest/whereismycf/1.0/permissions?username={0}&issueKey={1}&permissionId={2}",m.params().username,m.params().issueKey,m.params().permissionId),complete:function(s,u,q){d.find(".status-loading").remove();if(q.successful){var t=q.data;var r=j(t.statusLines);var p=AJS.$(JIRA.Templates.Dialogs.PermissionHelper.resultPage({permissionName:t.permissionName,username:t.username,userDisplayName:t.userDisplayName,issueKey:t.issueKey,projectKey:t.projectKey,projectName:t.projectName,status:t.status,statusLines:r,hideFailedStatuses:g(r),allFailedStatuses:!g(r),allGreenStatuses:a(r),baseUrl:contextPath,permissionSchemeName:t.permissionSchemeName}));d.find(".field-status-placeholder").append(p);if(c){c()}p.delegate(".show-failed-conditions","click",function(v){console.log("SHOWING");v.preventDefault();AJS.$(".statusRow[data-status='red']").show();AJS.$(".show-failed-conditions").hide();AJS.$(".hide-failed-conditions").show();JIRA.PermissionHelper.dialog._positionInCenter()});p.delegate(".hide-failed-conditions","click",function(v){console.log("HIDING");v.preventDefault();AJS.$(".statusRow[data-status='red']").hide();AJS.$(".hide-failed-conditions").hide();AJS.$(".show-failed-conditions").show();JIRA.PermissionHelper.dialog._positionInCenter()})}else{f(d,q)}}})};l.searchForm.submit(k);l.searchButton.click(k);function e(m,n){m.parent().append(AJS.$("<div>").addClass("error").text(n))}function h(m,n){return{permissionId:function(){var o=m.find("#permissionhelper-permission option:selected");if(o.length>0){return o.val()}else{return 10}},paramsForRequest:function(){return n.asRequestParams(this._paramsFromContents())},params:function(){return n.params(this._paramsFromContents())},_paramsFromContents:function(){var r={};var q=m.find("#permissionhelper-user option:selected");if(q.length==1){r.username=q.val()}else{r.username=""}var p=m.find("#permissionhelper-issue option:selected");if(p.length>0){r.issueKey=p.val()}var o=m.find("#permissionhelper-permission option:selected");if(o.length>0){r.permissionId=o.val()}return r}}}function j(p){if(p.length==0){return p}function n(s){var r=[];AJS.$.each(s,function(t,u){r.push(o(u))});return r}function o(s){if(s.parameters.length==0){return AJS.escapeHTML(s.message)}else{var r=m(s.parameters);r.splice(0,0,AJS.escapeHTML(s.message));return AJS.format.apply(this,r)}}function m(s){var r=[];AJS.$.each(s,function(t,u){if(u.type=="plain"){r.push(AJS.escapeHTML(u.value))}else{if(u.type=="link"){r.push(AJS.format("<a href=''{0}'' target=''_blank''>{1}</a>",AJS.escapeHTML(u.href),AJS.escapeHTML(u.text)))}else{if(u.type=="newline"){r.push("<br/>")}else{if(u.type=="tagstart"){r.push("<"+u.tagName+">")}else{if(u.type=="tagend"){r.push("</"+u.tagName+">")}else{throw"Unrecognized parameter type: "+u.type}}}}}});return r}var q=[];AJS.$.each(p,function(t,r){var s={};s.status=r.status;s.required=r.required;s.summary=n(r.summary);s.details=n(r.details);q.push(s)});return q}function g(o){var m=false;var n=false;AJS.$.each(o,function(q,p){if(p.status=="green"){m=true}else{if(p.required){n=true}}});return n?false:m}function a(n){var m=false;AJS.$.each(n,function(p,o){if(o.status=="red"){m=true}});return !m}function f(p,o){var m=false;var r=[];if(o.data){var q=JSON.parse(o.data);if(q.errorMessages&&q.errorMessages.length){r.push(q.errorMessages);m=true}if(q.errors){if(q.errors.issue){e(AJS.$("#permissionhelper-issue",p),q.errors.issue);m=true}if(q.errors.user){e(AJS.$("#permissionhelper-user",p),q.errors.user);m=true}if(q.errors.permission){e(AJS.$("#permissionhelper-permission",p),q.errors.permission);m=true}}}if(!m){r.push(JIRA.SmartAjax.buildSimpleErrorContent(o))}var n=l.searchForm.find("#error-message-placeholder");AJS.$.each(r,function(s,t){AJS.messages.error(n,{body:t,closeable:false})})}function i(){new JIRA.AdminHelper.IssuePicker({element:AJS.$("#permissionhelper-issue"),itemAttrDisplayed:"label",width:500});new AJS.SingleSelect({element:AJS.$("#permissionhelper-permission"),itemAttrDisplayed:"label",width:500})}return l}}};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/permission-helper-dialog.js' */
if(AJS.Meta.get("is-admin")){JIRA.PermissionHelper.PermissionHelperDialog=JIRA.Dialog.extend({_getDefaultOptions:function(){return AJS.$.extend(this._super(),{cached:false,id:"permission-helper-dialog",widthClass:"large",stacked:true})},_setContent:function(c,f){var a=this;if(c){this._super(c,f)}else{var e=this.context().issueKey()||"";var b=this.context().permissionId()||"";this._super(AJS.$(JIRA.Templates.Dialogs.PermissionHelper.searchPage({currentIssueKey:e,currentPermissionId:b,permissionGroups:JIRA.PermissionHelper.PERMISSIONS})),true)}this.get$popupContent().find(".cancel").click(function(g){a.hide();g.preventDefault()});if(JIRA.Dialog.current===this){var d=new JIRA.setFocus.FocusConfiguration();d.context=this.get$popup()[0];d.parentElementSelectors=[".form-body"];JIRA.setFocus.pushConfiguration(d);JIRA.setFocus.triggerFocus()}},decorateContent:function(){var a=this;this.addHeading("Permission Helper");JIRA.PermissionHelper.PermissionHelperUi.initUi(this.get$popupContent(),this.context(),function(){a._positionInCenter()})},show:function(a){if(a){this.context(a)}if(!this.options.context){throw"This class must be initialized with 'context' parameter before calling show()"}this._super()},context:function(a){if(a){this.options.context=a}else{return this.options.context}},hide:function(a){if(this._super(a)===false){return false}JIRA.setFocus.popConfiguration()}});JIRA.PermissionHelper.Context=Class.extend({init:function(a){this.options=a||{}},issueKey:function(a){if(a){this.options.issueKey=a}else{return this.options.issueKey}},permissionId:function(a){if(a){this.options.permissionId=a}else{return this.options.permissionId}},params:function(a){var b=AJS.$.extend({},this.options);if(this._exists(a)){AJS.$.extend(b,a)}return b},asRequestParams:function(a){var c=this.params(a);var b="atl_token="+atl_token();if(this._exists(c.username)){b+="&username="+c.username}if(this._exists(c.issueKey)){b+="&issueKey="+c.issueKey}if(this._exists(c.projectKey)){b+="&projectKey="+c.projectKey}if(this._exists(c.projectId)){b+="&projectId="+c.projectId}if(this._exists(c.issueOperation!==undefined)){b+="&issueOperation="+c.issueOperation}if(this._exists(c.issueTypeId)){b+="&issueTypeId="+c.issueTypeId}return b},_exists:function(a){return typeof(a)!="undefined"}})};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/permission-helper.js' */
if(AJS.Meta.get("is-admin")){(function(d){var c="Permission Helper";JIRA.PermissionHelper.dialog=new JIRA.PermissionHelper.PermissionHelperDialog;d(document).delegate(".permissionhelper-trigger","click",function(e){e.preventDefault();AJS.trigger("analyticsEvent",{name:"adminhelper.permhelper.dialog.open"});JIRA.PermissionHelper.dialog.show(a())});d(function(){var e=d("#permission-helper-admin-page");if(e.length==1){b();AJS.trigger("analyticsEvent",{name:"adminhelper.permhelper.adminpage.open"});e.append(d(JIRA.Templates.Dialogs.PermissionHelper.searchPage({noCloseLink:true,permissionGroups:JIRA.PermissionHelper.PERMISSIONS})));e.trigger(JIRA.Events.NEW_CONTENT_ADDED,[e]);JIRA.PermissionHelper.PermissionHelperUi.initUi(e,new JIRA.PermissionHelper.Context());d("#permissionhelper-user-field").focus()}});function a(){var e=JIRA.Issue.getIssueKey();if(!e&&JIRA.IssueNavigator){e=JIRA.IssueNavigator.getSelectedIssueKey()}return new JIRA.PermissionHelper.Context({issueKey:e,issueOperation:JIRA.PermissionHelper.dialog.OPERATION_VIEW})}function b(){var e=d("#permission-helper-admin-page");e.prepend(d("<h2>").attr("id","admin-page-heading").text(c))}})(AJS.$)};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'templates/notification-helper.soy' */
// This file was automatically generated from notification-helper.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Dialogs == 'undefined') { JIRA.Templates.Dialogs = {}; }
if (typeof JIRA.Templates.Dialogs.NotificationHelper == 'undefined') { JIRA.Templates.Dialogs.NotificationHelper = {}; }


JIRA.Templates.Dialogs.NotificationHelper.searchPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="notificationhelper-search-form aui ajs-dirty-warning-exempt"><div class="content-area-container"><div class="form-body"><div id="error-message-placeholder"></div><div class="action-description">', soy.$$escapeHtml("Find out why users receive, or do not receive notifications for this issue"), '</div><div class="field-group"><label for="notificationhelper-user">', soy.$$escapeHtml("User"), '</label><select id="notificationhelper-user" name="notificationhelper-user" class="single-user-picker js-default-user-picker" data-container-class="long-field"></select><div class=\'description\'>', soy.$$escapeHtml("Begin typing to find a user"), '</div></div><div class="field-group ', (opt_data.currentIssueKey) ? 'hidden' : '', '"><label for="notificationhelper-issue">', soy.$$escapeHtml("Issue"), '</label><select class="aui-field-select select" name="notificationhelper-issue" id="notificationhelper-issue"></select><div class="description">', soy.$$escapeHtml("Begin typing to find an issue"), '</div></div><div class="field-group"><label for="notificationhelper-event">', soy.$$escapeHtml("Notification Event"), '</label><select class="aui-field-select select" name="notificationhelper-event" id="notificationhelper-event">');
  var eventList20 = opt_data.events;
  var eventListLen20 = eventList20.length;
  for (var eventIndex20 = 0; eventIndex20 < eventListLen20; eventIndex20++) {
    var eventData20 = eventList20[eventIndex20];
    output.append('<option ', (eventData20.id == opt_data.defaultEventId) ? 'selected="selected"' : '', ' value="', soy.$$escapeHtml(eventData20.id), '">', soy.$$escapeHtml(eventData20.name), '</option>');
  }
  output.append('</select><div class=\'description\'>', soy.$$escapeHtml("Begin typing to find a notification event or press down to see all"), '</div></div></div><div class="form-body field-status-placeholder" /></div><div class="buttons-container form-footer"><div class="buttons"><input class="button search" type="submit" id="permission-helper-submit" value="', soy.$$escapeHtml("Submit"), '">', (! opt_data.noCloseLink) ? '<a href="#" class="cancel" id="aui-dialog-close">' + soy.$$escapeHtml("Close") + '</a>' : '', '</div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.NotificationHelper.resultPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="field-status-results"><div class="aui-message"><ul class="item-details"><li><dl><dt>', soy.$$escapeHtml("Event"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.eventName), '">', soy.$$escapeHtml(opt_data.eventName), '</dd></dl><dl><dt>', soy.$$escapeHtml("User"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.userDisplayName), '">', (opt_data.username != '') ? '<a href="' + soy.$$escapeHtml(opt_data.baseUrl) + '/secure/admin/user/ViewUser.jspa?name=' + soy.$$escapeHtml(opt_data.username) + '">' + soy.$$escapeHtml(opt_data.userDisplayName) + '</a>' : soy.$$escapeHtml(opt_data.userDisplayName), '</dd></dl><dl><dt>', soy.$$escapeHtml("Project"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.projectName), '"><a href="', soy.$$escapeHtml(opt_data.baseUrl), '/browse/', soy.$$escapeHtml(opt_data.projectKey), '">', soy.$$escapeHtml(opt_data.projectName), '</a></dd></dl><dl><dt>', soy.$$escapeHtml("Scheme"), ': </dt><dd title="blah"><a href="', soy.$$escapeHtml(opt_data.baseUrl), '/plugins/servlet/project-config/', soy.$$escapeHtml(opt_data.projectKey), '/notifications">', soy.$$escapeHtml(opt_data.notificationSchemeName), '</a></dd></dl>', (opt_data.issueKey) ? '<dl><dt>' + soy.$$escapeHtml("Issue") + ': </dt><dd title="' + soy.$$escapeHtml(opt_data.issueKey) + '"><a href="' + soy.$$escapeHtml(opt_data.baseUrl) + '/browse/' + soy.$$escapeHtml(opt_data.issueKey) + '">' + soy.$$escapeHtml(opt_data.issueKey) + '</a></dd></dl>' : '', '<dl><dt>', soy.$$escapeHtml("Status"), ': </dt><dd>');
  JIRA.Templates.AdminHelper.Common.statusImage(opt_data, output);
  if (opt_data.status == 'green') {
    output.append(soy.$$escapeHtml(AJS.format("{0} receives notifications for the \x27\x27{1}\x27\x27 event",opt_data.userDisplayName,opt_data.eventName)));
    if (opt_data.userNotifyOwnChanges == false) {
      output.append('<br>');
      JIRA.Templates.AdminHelper.Common.warningImage(null, output);
      output.append(soy.$$escapeHtml(AJS.format("{0} does not get notified of their own changes.",opt_data.userDisplayName)), ' <a target="_blank" href="https://confluence.atlassian.com/display/JIRA/Managing+your+User+Profile#ManagingyourUserProfile-Preferences">', soy.$$escapeHtml("Learn more"), '</a>.');
    }
  } else {
    output.append(soy.$$escapeHtml(AJS.format("{0} does not receive notifications for the \x27\x27{1}\x27\x27 event",opt_data.userDisplayName,opt_data.eventName)));
  }
  output.append('</dd></dl></li></ul></div>');
  if (opt_data.statusLines.length == 0) {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml(AJS.format("There are no details available about the notifications for the \x27\x27{0}\x27\x27 event",opt_data.eventName)), '</p></div>');
  } else {
    output.append('<table class="status-table aui"><thead><tr><th width="10%">', soy.$$escapeHtml("Status"), '</th><th width="30%">', soy.$$escapeHtml("Summary"), '</th><th width="60%">', soy.$$escapeHtml("Details"), '</th></tr></thead><tbody>');
    var statusLineList129 = opt_data.statusLines;
    var statusLineListLen129 = statusLineList129.length;
    for (var statusLineIndex129 = 0; statusLineIndex129 < statusLineListLen129; statusLineIndex129++) {
      var statusLineData129 = statusLineList129[statusLineIndex129];
      JIRA.Templates.AdminHelper.Common.statusLineRow({statusLine: statusLineData129, hideFailedStatuses: opt_data.hideFailedStatuses}, output);
    }
    output.append('<tbody></table><div class="toggle-conditions-container"><a class="show-failed-conditions" ', (opt_data.hideFailedStatuses == false || opt_data.allGreenStatuses == true) ? 'style="display: none"' : '', '>', soy.$$escapeHtml("Show failed conditions"), '</a><a class="hide-failed-conditions" ', (opt_data.hideFailedStatuses == true || opt_data.allFailedStatuses == true) ? 'style="display: none"' : '', '>', soy.$$escapeHtml("Hide failed conditions"), '</a></div>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/notification-helper-ui.js' */
if(AJS.Meta.get("is-admin")){AJS.namespace("JIRA.NotificationHelper");JIRA.NotificationHelper.NOTIFICATION_EVENTS=WRM.data.claim("com.atlassian.jira.plugins.jira-admin-helper-plugin:notification-event-provider.notification-event-data");JIRA.NotificationHelper.defaultEventId=function(){var a;AJS.$(JIRA.NotificationHelper.NOTIFICATION_EVENTS).each(function(){if(this.isDefault){a=this.id}});return a};JIRA.NotificationHelper.NotificationHelperUi={initUi:function(c,k,b){g();var l={};l.searchButton=c.find("input.search");l.searchForm=c.find("form.notificationhelper-search-form");var i=function(o){o.preventDefault();var m=f(c,k);c.find(".error").remove();var n=false;if(!m.params().username){d(AJS.$("#notificationhelper-user",c),"Please select a user");n=true}if(!m.params().issueKey){d(AJS.$("#notificationhelper-issue",c),"Please select an issue");n=true}if(!m.params().eventId){d(AJS.$("#notificationhelper-event",c),"Please select a valid notification event");n=true}if(n){return}c.find("#error-message-placeholder").empty();c.find(".field-status-results").remove();c.find(".field-status-placeholder").append(AJS.$(JIRA.Templates.AdminHelper.Common.loadingStatus()));AJS.trigger("analyticsEvent",{name:"adminhelper.notihelper.check",data:{eventId:m.params().eventId}});JIRA.SmartAjax.makeRequest({url:contextPath+AJS.format("/rest/whereismycf/1.0/notifications?username={0}&issueKey={1}&eventId={2}",m.params().username,m.params().issueKey,m.params().eventId),complete:function(t,u,r){c.find(".status-loading").remove();if(r.successful){var p=r.data;var s=h(p.statusLines);var q=AJS.$(JIRA.Templates.Dialogs.NotificationHelper.resultPage({eventName:p.eventName,username:p.username,userDisplayName:p.userDisplayName,userNotifyOwnChanges:p.userNotifyOwnChanges,issueKey:p.issueKey,projectKey:p.projectKey,projectName:p.projectName,status:p.status,statusLines:s,notificationSchemeName:p.notificationSchemeName,hideFailedStatuses:j(s),allFailedStatuses:!j(s),allGreenStatuses:a(s),baseUrl:contextPath}));c.find(".field-status-placeholder").append(q);if(b){b()}q.delegate(".show-failed-conditions","click",function(v){v.preventDefault();AJS.$(".statusRow[data-status='red']").show();AJS.$(".show-failed-conditions").hide();AJS.$(".hide-failed-conditions").show();if(b){b()}});q.delegate(".hide-failed-conditions","click",function(v){v.preventDefault();AJS.$(".statusRow[data-status='red']").hide();AJS.$(".hide-failed-conditions").hide();AJS.$(".show-failed-conditions").show();if(b){b()}})}else{e(c,r)}}})};l.searchForm.submit(i);l.searchButton.click(i);function d(m,n){m.parent().append(AJS.$("<div>").addClass("error").text(n))}function f(m,n){return{eventId:function(){var o=m.find("#notificationhelper-event option:selected");if(eventId.length>0){return o.val()}else{return JIRA.NotificationHelper.defaultEventId()}},paramsForRequest:function(){return n.asRequestParams(this._paramsFromContents())},params:function(){return n.params(this._paramsFromContents())},_paramsFromContents:function(){var r={};var p=m.find("#notificationhelper-user option:selected");if(p.length==1){r.username=p.val()}var o=m.find("#notificationhelper-issue option:selected");if(o.length>0){r.issueKey=o.val()}var q=m.find("#notificationhelper-event option:selected");if(q.length>0){r.eventId=q.val()}return r}}}function h(p){if(p.length==0){return p}function n(s){var r=[];AJS.$.each(s,function(t,u){r.push(o(u))});return r}function o(s){if(s.parameters.length==0){return AJS.escapeHTML(s.message)}else{var r=m(s.parameters);r.splice(0,0,AJS.escapeHTML(s.message));return AJS.format.apply(this,r)}}function m(s){var r=[];AJS.$.each(s,function(t,u){if(u.type=="plain"){r.push(AJS.escapeHTML(u.value))}else{if(u.type=="link"){r.push(AJS.format("<a href=''{0}'' target=''_blank''>{1}</a>",AJS.escapeHTML(u.href),AJS.escapeHTML(u.text)))}else{if(u.type=="newline"){r.push("<br/>")}else{if(u.type=="tagstart"){r.push("<"+u.tagName+">")}else{if(u.type=="tagend"){r.push("</"+u.tagName+">")}else{throw"Unrecognized parameter type: "+u.type}}}}}});return r}var q=[];AJS.$.each(p,function(t,r){var s={};s.status=r.status;s.summary=n(r.summary);s.details=n(r.details);q.push(s)});return q}function j(n){var m=false;AJS.$.each(n,function(p,o){if(o.status=="green"){m=true;return false}});return m}function a(n){var m=false;AJS.$.each(n,function(p,o){if(o.status=="red"){m=true}});return !m}function e(p,o){var m=false;var r=[];if(o.data){var q=JSON.parse(o.data);if(q.errorMessages&&q.errorMessages.length){r.push(q.errorMessages);m=true}if(q.errors){if(q.errors.issue){d(AJS.$("#notificationhelper-issue",p),q.errors.issue);m=true}if(q.errors.user){d(AJS.$("#notificationhelper-user",p),q.errors.user);m=true}if(q.errors.event){d(AJS.$("#notificationhelper-event",p),q.errors.event);m=true}}}if(!m){r.push(JIRA.SmartAjax.buildSimpleErrorContent(o))}var n=l.searchForm.find("#error-message-placeholder");AJS.$.each(r,function(s,t){AJS.messages.error(n,{body:t,closeable:false})})}function g(){new JIRA.AdminHelper.IssuePicker({element:AJS.$("#notificationhelper-issue"),itemAttrDisplayed:"label",width:500});new AJS.SingleSelect({element:AJS.$("#notificationhelper-event"),itemAttrDisplayed:"label",width:500})}return l}}};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/notification-helper-dialog.js' */
if(AJS.Meta.get("is-admin")){JIRA.NotificationHelper.NotificationHelperDialog=JIRA.Dialog.extend({_getDefaultOptions:function(){return AJS.$.extend(this._super(),{cached:false,id:"permission-helper-dialog",widthClass:"large",stacked:true})},_setContent:function(b,e){var a=this;if(b){this._super(b,e)}else{var d=this.context().issueKey()||"";this._super(AJS.$(JIRA.Templates.Dialogs.NotificationHelper.searchPage({currentIssueKey:d,events:JIRA.NotificationHelper.NOTIFICATION_EVENTS,defaultEventId:JIRA.NotificationHelper.defaultEventId()})),true)}this.get$popupContent().find(".cancel").click(function(f){a.hide();f.preventDefault()});if(JIRA.Dialog.current===this){var c=new JIRA.setFocus.FocusConfiguration();c.context=this.get$popup()[0];c.parentElementSelectors=[".form-body"];JIRA.setFocus.pushConfiguration(c);JIRA.setFocus.triggerFocus()}},decorateContent:function(){var a=this;this.addHeading("Notification Helper");JIRA.NotificationHelper.NotificationHelperUi.initUi(this.get$popupContent(),this.context(),function(){a._positionInCenter()})},show:function(a){if(a){this.context(a)}if(!this.options.context){throw"This class must be initialized with 'context' parameter before calling show()"}this._super()},context:function(a){if(a){this.options.context=a}else{return this.options.context}},hide:function(a){if(this._super(a)===false){return false}JIRA.setFocus.popConfiguration()}});JIRA.NotificationHelper.Context=Class.extend({init:function(a){this.options=a||{}},issueKey:function(a){if(a){this.options.issueKey=a}else{return this.options.issueKey}},eventId:function(a){if(a){this.options.permissionId=a}else{return this.options.eventId}},params:function(a){var b=AJS.$.extend({},this.options);if(this._exists(a)){AJS.$.extend(b,a)}return b},asRequestParams:function(a){var c=this.params(a);var b="atl_token="+atl_token();if(this._exists(c.username)){b+="&username="+c.username}if(this._exists(c.issueKey)){b+="&issueKey="+c.issueKey}if(this._exists(c.projectKey)){b+="&projectKey="+c.projectKey}if(this._exists(c.projectId)){b+="&projectId="+c.projectId}if(this._exists(c.issueOperation!==undefined)){b+="&issueOperation="+c.issueOperation}if(this._exists(c.issueTypeId)){b+="&issueTypeId="+c.issueTypeId}return b},_exists:function(a){return typeof(a)!="undefined"}})};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/notification-helper.js' */
if(AJS.Meta.get("is-admin")){(function(d){var c="Notification Helper";JIRA.NotificationHelper.dialog=new JIRA.NotificationHelper.NotificationHelperDialog;d(document).delegate(".notificationhelper-trigger","click",function(e){e.preventDefault();AJS.trigger("analyticsEvent",{name:"adminhelper.notihelper.dialog.open"});JIRA.NotificationHelper.dialog.show(a())});d(function(){var e=d("#notification-helper-admin-page");if(e.length==1){b();AJS.trigger("analyticsEvent",{name:"adminhelper.notihelper.adminpage.open"});e.append(d(JIRA.Templates.Dialogs.NotificationHelper.searchPage({noCloseLink:true,events:JIRA.NotificationHelper.NOTIFICATION_EVENTS,defaultEventId:JIRA.NotificationHelper.defaultEventId()})));e.trigger(JIRA.Events.NEW_CONTENT_ADDED,[e]);JIRA.NotificationHelper.NotificationHelperUi.initUi(e,new JIRA.NotificationHelper.Context());d("#notificationhelper-user-field").focus()}});function a(){var e=JIRA.Issue.getIssueKey();if(!e&&JIRA.IssueNavigator){e=JIRA.IssueNavigator.getSelectedIssueKey()}return new JIRA.NotificationHelper.Context({issueKey:e,issueOperation:JIRA.NotificationHelper.dialog.OPERATION_VIEW})}function b(){var e=d("#notification-helper-admin-page");e.prepend(d("<h2>").attr("id","admin-page-heading").text(c))}})(AJS.$)};;
;/* module-key = 'com.atlassian.administration.atlassian-admin-quicksearch-jira:admin-quicksearch-webresources', location = 'com/atlassian/administration/quicksearch/jira/js/adminQuickNav.js' */
/**
 * Shifter group for admin search
 */
JIRA.Shifter && JIRA.Shifter.register(function() {
    var suggestionsDeferred = jQuery.Deferred();

    function formatItem(item) {
        return {
            label: item.label,
            value: item.linkUrl,
            keywords: item.aliases
        };
    }

    function getItemsInSection(section) {
        return _.map(section.items, formatItem).concat(_.map(section.sections, getItemsInSection));
    }

    function formatResponse(data) {
        return _.flatten(getItemsInSection(data));
    }

    JIRA.SmartAjax.makeRequest({
        dataType: 'json',
        url: AJS.contextPath() + '/rest/adminquicksearch/latest/links/default'
    })
    .pipe(formatResponse)
    .done(function(suggestions) {
        suggestionsDeferred.resolve(suggestions);
    })
    .fail(function() {
        suggestionsDeferred.reject();
    });

    return {
        id: 'admin',
        name: "Administration",
        weight: 500,
        getSuggestions: function() {
            return suggestionsDeferred;
        },
        onSelection: function(value) {
            window.location = value;
            return jQuery.Deferred();
        }
    };
});
;
;/* module-key = 'com.atlassian.support.stp:stp-license-status-resources', location = 'js/stp-licenseStatus.js' */
;
;/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/js/DemoProjectTemplate.js' */
JPT.DemoProjectTemplate={};JPT.DemoProjectTemplate.init=function init(){AJS.$("body").on("com.atlassian.jira-core-project-templates:jira-sample-item",function(b,a){JPT.DemoProjectTemplate.createDemoProject(a)})};JPT.DemoProjectTemplate.createDemoProject=function createDemoProject(a){a.addPanel("DemoProjectTemplate",JIRA.Templates.ProjectTemplates.CoreTemplates.renderLoadingSampleProject(),"");$demoProjectForm=AJS.$("<form></form>");$demoProjectForm.attr("action",contextPath+"/secure/CreateDemoProject.jspa");$demoProjectAtlTokenField=AJS.$("<input type='hidden' name='atl_token' value='' />");$demoProjectAtlTokenField.val(atl_token());$demoProjectForm.append($demoProjectAtlTokenField);$demoProjectForm.appendTo(JPT.DialogController.$dialogElement);$demoProjectForm.submit()};AJS.$(JPT.DemoProjectTemplate.init);;
;/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/soy/CoreProjectTemplates.soy' */
// This file was automatically generated from CoreProjectTemplates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }
if (typeof JIRA.Templates.ProjectTemplates.CoreTemplates == 'undefined') { JIRA.Templates.ProjectTemplates.CoreTemplates = {}; }


JIRA.Templates.ProjectTemplates.CoreTemplates.renderLoadingSampleProject = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'demo-loading-container\'><span class=\'icon throbber loading\'/><span class=\'demo-loading-message\'>', soy.$$escapeHtml("Loading Demo Project"), '</span></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/soy/IssueTrackingTemplates.soy' */
// This file was automatically generated from IssueTrackingTemplates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }
if (typeof JIRA.Templates.ProjectTemplates.CoreTemplates == 'undefined') { JIRA.Templates.ProjectTemplates.CoreTemplates = {}; }


JIRA.Templates.ProjectTemplates.CoreTemplates.renderIssueTrackingExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.ProjectTemplates.CoreTemplates.renderExplanation({description: "This project provides you with a quick and easy way to get JIRA up and running for simple issue tracking. Select this project to keep things simple. You can optionally configure these later."}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.CoreTemplates.renderProjectManagementExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.ProjectTemplates.CoreTemplates.renderExplanation({description: "This project provides you with a quick and easy way to get JIRA up and running for project management. You can optionally configure these later."}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.CoreTemplates.renderExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-tracking-info"><div class="left-info"><p>', soy.$$escapeHtml(opt_data.description), '</p><h3>', soy.$$escapeHtml("Issue Types"), '</h3><ul class="project-template-issuetype-list"><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li></ul></div><div class="right-info issue-tracking-screenshot"></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:application-header-administration-cog-resource', location = 'header/cog.js' */
var NavLinks=(function(a){a.ApplicationHeader=function(b){b.Cog=(function(){var c=function(){var d=AJS.$("#system-admin-menu-content");if(d.length>0){return d}var e=AJS.$("#admin-menu-link-content");if(e.length>0){return e}return AJS.$("#bamboo\\.global\\.header-admin\\.menu")};return{getDropdown:c}}());return b}(a.ApplicationHeader||{});return a}(NavLinks||{}));;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:administration-shortcuts-resources', location = 'adminshortcuts/adminshortcuts.soy' */
// This file was automatically generated from adminshortcuts.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.adminshortcuts == 'undefined') { navlinks.templates.adminshortcuts = {}; }


navlinks.templates.adminshortcuts.section = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param5 = new soy.StringBuilder('<ul class="aui-list-truncate">');
  var linkList7 = opt_data.links;
  var linkListLen7 = linkList7.length;
  for (var linkIndex7 = 0; linkIndex7 < linkListLen7; linkIndex7++) {
    var linkData7 = linkList7[linkIndex7];
    param5.append('<li><a href="', soy.$$escapeHtml(linkData7.link), '">', soy.$$escapeHtml(linkData7.label), '</a></li>');
  }
  param5.append('</ul>');
  aui.dropdown2.section({id: 'nl-remote-admin-section', label: "Other applications", content: param5.toString()}, output);
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:administration-shortcuts-resources', location = 'adminshortcuts/adminnavlinks.js' */
var NavLinks=(function(a){a.AdminShortcuts=(function(){var c=function(){return AJS.$.ajax({url:AJS.contextPath()+"/rest/menu/latest/admin",cache:false,dataType:"json"})};var b=function(){AJS.$("#nl-remote-admin-section").on("click","a",function(){NL.trackEvent("remoteAdminItemSelected",NL.getCurrentApplication(),$(this).attr("href"))})};return{render:function(){c().done(function(e){e=_.reject(e,function(f){return f.local===true});if(e.length){var d=navlinks.templates.adminshortcuts.section({links:e});a.ApplicationHeader.Cog.getDropdown().append(d);b()}})}}}());return a}(NavLinks||{}));;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:administration-shortcuts', location = 'adminshortcuts/adminshortcuts-cdn.js' */
AJS.toInit(function(){if(AJS.DarkFeatures&&AJS.DarkFeatures.isEnabled("rotp.admin.shortcuts")){NavLinks.AdminShortcuts.render()}});;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-projectshortcuts', location = 'projectshortcuts/projectshortcuts.soy' */
// This file was automatically generated from projectshortcuts.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.projectshortcuts == 'undefined') { navlinks.templates.projectshortcuts = {}; }


navlinks.templates.projectshortcuts.dialogContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.localShortcuts && opt_data.localShortcuts.length > 0) {
    navlinks.templates.projectshortcuts.dialogContentShortcuts({shortcuts: opt_data.localShortcuts, listClass: 'projectshortcut-links'}, output);
  }
  if (opt_data.remoteShortcuts != null) {
    if (opt_data.remoteShortcuts.length > 0) {
      output.append('<h2 class="projectshortcuts-heading">Related Links</h2>');
      navlinks.templates.projectshortcuts.dialogContentShortcuts(soy.$$augmentData(opt_data.remoteShortcuts, {shortcuts: opt_data.remoteShortcuts, listClass: 'projectshortcut-links'}), output);
    }
  } else {
    navlinks.templates.projectshortcuts.dialogLoading(null, output);
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.headingWrapper = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-dialog-header-wrapper"><div class="project-header"><img class="project-img" src="', soy.$$escapeHtml(opt_data.logoUrl), '"><h2 class="dialog-title">', soy.$$escapeHtml(opt_data.title), '</h2></div><div class="project-content-wrapper">', opt_data.contentHtml, '</div></div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogContentShortcuts = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul', (opt_data.listClass) ? ' class="' + soy.$$escapeHtml(opt_data.listClass) + '"' : '', '>');
  var shortcutList35 = opt_data.shortcuts;
  var shortcutListLen35 = shortcutList35.length;
  for (var shortcutIndex35 = 0; shortcutIndex35 < shortcutListLen35; shortcutIndex35++) {
    var shortcutData35 = shortcutList35[shortcutIndex35];
    output.append('<li', (shortcutIndex35 == shortcutListLen35 - 1) ? ' class="last"' : '', '>');
    navlinks.templates.projectshortcuts.dialogContentShortcut(shortcutData35, output);
    output.append('</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogContentShortcut = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtml(opt_data.link), '"', (opt_data.tooltip) ? ' title="' + soy.$$escapeHtml(opt_data.tooltip) + '"' : '', '>', soy.$$escapeHtml(opt_data.label), '</a>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="projectshortcuts-loading">', (opt_data != null && opt_data.text) ? soy.$$escapeHtml(opt_data.text) : '', '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-projectshortcuts', location = 'projectshortcuts/projectshortcuts.js' */
(function(e,g){var i,k={},m="key",b="name",j="entity-type";function f(s){var n=e(this),o=n.data(m),q=n.data(b),p=n.data(j);if(typeof o==="undefined"){return}s.preventDefault();i=new AJS.Dialog({width:600,keypressListener:function(u){if(u.which==jQuery.ui.keyCode.ESCAPE){i.remove()}},id:"project-shortcuts-dialog"}).addCancel("Close",function(){i.remove()}).addPanel("",navlinks.templates.projectshortcuts.headingWrapper({title:q,logoUrl:h(),contentHtml:navlinks.templates.projectshortcuts.dialogLoading({text:"Retrieving links…"})})).show();c(i);if(!k[o]){k[o]={entity:{title:q},localShortcuts:null,remoteShortcuts:null};d(AJS.contextPath()+"/rest/project-shortcuts/1.0/local/"+o,{entityType:p}).done(t);d(AJS.contextPath()+"/rest/project-shortcuts/1.0/remote/"+o,{entityType:p}).done(r).fail(function(){var u=i.getCurrentPanel().body.find(".project-content-wrapper");u.find(".projectshortcuts-loading").remove();AJS.messages.error(u,{body:"Could not retrieve remote project shortcuts",closeable:false});c(i)})}else{l(k[o])}function t(u){k[o].localShortcuts=u.shortcuts;l(k[o])}function r(u){k[o].remoteShortcuts=u.shortcuts;l(k[o])}}function h(){return e(".project-shortcut-dialog-trigger img").attr("src")}function l(n){if(n.localShortcuts){i.getCurrentPanel().html(navlinks.templates.projectshortcuts.headingWrapper({title:n.entity.title,logoUrl:h(),contentHtml:navlinks.templates.projectshortcuts.dialogContent(n)}));c(i)}}function a(p){var o=210;if(!p||p.length<=o){return p}var n=o;while(n>0&&p.charAt(n)!=" "){n--}if(n==0){n=o}p=p.substring(0,n);if(p.length>=n){p=p+"..."}return p}function c(n){var q=n.popup.element,p=q.find(".dialog-panel-body"),o=q.find(".dialog-components");p.height("auto");q.height(o.outerHeight()-1);e(".aui-shadow").remove()}function d(n,o){return e.ajax({url:n,cache:false,data:o,dataType:"json"})}e(document).on("click",".project-shortcut-dialog-trigger",f)}(jQuery,window.NL=(window.NL||{})));;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:atlassian-ui-popup-display-controller', location = 'popups/DisplayController.js' */
AJS.Popups=AJS.Popups||{};AJS.Popups.DisplayController=function(){var c=[];var a=false;var b=false;AJS.toInit(function(){setTimeout(function(){AJS.Popups.DisplayController.render()},0)});return{request:function(d){c.push(d);if(a&&b===false){this.render()}},render:function(){c.sort(function(e,d){return e.weight-d.weight});a=true;if(c.length!==0){b=true;c[0].show()}}}}();;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'path.js' */
(function(a){a.basename=function(b){return b.split(/\//).pop()};a.dirname=function(b){var c=JIRA.AttachImagesPlugin.basename(b);return b.substring(0,b.length-c.length)}})(AJS.namespace("JIRA.AttachImagesPlugin"));;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'resource-uris.js' */
(function(a){var b=null,c="com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources.resource-uris";a.resourceUris={_resetForTesting:function(){b=null},get:function(d){if(b===null){b=WRM.data.claim(c)||{}}return b[d]}}})(AJS.namespace("JIRA.AttachImagesPlugin"));;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'templates/soy/attach-screenshot-form.soy' */
// This file was automatically generated from attach-screenshot-form.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Html5Screenshot == 'undefined') { JIRA.Templates.Html5Screenshot = {}; }


JIRA.Templates.Html5Screenshot.attachScreenshotForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2 class="dialog-title">', soy.$$escapeHtml("Attach Screenshot"), '</h2><form action="ShowAttachScreenshotFormAction.jspa" class="aui" method="post" id="attach-screenshot-form" data-attach-secure-token="', soy.$$escapeHtml(opt_data.attachUserToken), '" data-submit-secure-token="', soy.$$escapeHtml(opt_data.submitUserToken), '"><input type="hidden" name="id" value="', soy.$$escapeHtml(opt_data.id), '"/><input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '"><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '"><input type="hidden" name="filetoconvert" value=""><div class="attach-screenshot-padding"><div class="attach-screenshot-container"><div id="attach-screenshot-inner-container"><div class="mod-content"><ul class="item-details"><li><dl><dt>', soy.$$escapeHtml("Take a screenshot:"), '</dt>', (opt_data.userPlatform == 'pc') ? '<dd>' + "\x3ckbd\x3ePrtScn\x3c/kbd\x3e" + '</dd>' : '<dd>' + "\x3ckbd\x3e\x26#8963; Ctrl\x3c/kbd\x3e + \x3ckbd\x3e\x26#8984; Cmd\x3c/kbd\x3e + \x3ckbd\x3e\x26#8679; Shift\x3c/kbd\x3e + \x3ckbd\x3e3\x3c/kbd\x3e" + '</dd>', '</dl></li><li><dl><dt>', soy.$$escapeHtml("Paste the image:"), '</dt>', (opt_data.userPlatform == 'pc') ? '<dd>' + "\x3ckbd\x3eCtrl\x3c/kbd\x3e + \x3ckbd\x3ev\x3c/kbd\x3e" + '</dd>' : '<dd>' + "\x3ckbd\x3e\x26#8984; Cmd\x3c/kbd\x3e + \x3ckbd\x3ev\x3c/kbd\x3e" + '</dd>', '</dl></li></ul></div><input type="text" id="attach-screenshot-fake-input"><div class="attach-screenshot-padding attach-screenshot-padding-inner"><div id="attach-screenshot-image-container" class="attach-screenshot-image-container"><div class="attach-screenshot-placeholder"><div class="mod-content"><ul class="item-details"><li><dl><dt id="attach-screenshot-placeholder-message">', soy.$$escapeHtml("Your image will be pasted here"), '</dt></dl></li></ul></div></div></div></div><div id=\'attach-max-size\' class="hidden">', soy.$$escapeHtml(opt_data.maxSize), '</div></div></div></div><fieldset><div><legend><span>', soy.$$escapeHtml("Attach Screenshot"), '</span></legend><div id="attach-screenshot-filename-group" class="field-group"><div id="attach-screenshot-progress-container"></div><label for="attachscreenshotname">', soy.$$escapeHtml("File name"), ' <span class="aui-icon icon-required">', soy.$$escapeHtml("Required"), '</span></label><input class="text" type="text" id="attachscreenshotname" name="attachscreenshotname" title="File Name" value="', soy.$$escapeHtml(opt_data.nextScreenshotName), '"><div class="description">', soy.$$escapeHtml("A file name to be used as attached image name"), '</div></div></div></fieldset><div class="buttons-container form-footer"><div class="buttons"><button class="aui-button aui-button-primary" id="attach-screenshot-html5-upload">', soy.$$escapeHtml("Upload"), '</button><a href="#" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'base64decode.js' */
(function(a){function b(c){return c>64&&c<91?c-65:c>96&&c<123?c-71:c>47&&c<58?c+4:c===43?62:c===47?63:0}a.base64decode=function(e){var l=e.replace(/[^A-Za-z0-9\+\/]/g,""),f=l.length,c=f*3+1>>2,j=new Uint8Array(c);for(var i,g,h=0,d=0,k=0;k<f;k++){g=k&3;h|=b(l.charCodeAt(k))<<18-6*g;if(g===3||f-k===1){for(i=0;i<3&&d<c;i++,d++){j[d]=h>>>(16>>>i&24)&255}h=0}}return j}})(AJS.namespace("JIRA.AttachImagesPlugin"));;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'utility.js' */
(function(b,a){a.isKeyPasteEvent=function(f,c){var d=86,e=(c||navigator.platform).indexOf("Mac")!==-1;return f.which===d&&(e?f.metaKey:f.ctrlKey)};a.isImagePasteEvent=function(c){if(c&&c.clipboardData){return _.union(_.toArray(c.clipboardData.items),_.toArray(c.clipboardData.files)).some(function(d){return d.type.indexOf("image")!==-1})}};a.isHtmlImagePasteEvent=function(c){return a.getHtmlImagePaste(c)!=null};a.isTextPasteEvent=function(c){return c.clipboardData.types&&(_.contains(c.clipboardData.types,"text/plain")||_.contains(c.clipboardData.types,"text/html"))};a.isContentEditable=function(c){return c.contentEditable=="true"||c.contentEditable==""||(c.contentEditable=="inherit"&&b(c).parents().is("[contenteditable=true]"))};a.isValidFileName=function(c){return !_(["\\","/",'"',":","?","*","<","|",">","!"]).any(function(d){return c.indexOf(d)>-1})};a.getHtmlImagePaste=function(c){if(!c.clipboardData||!c.clipboardData.types||!_.contains(c.clipboardData.types,"text/html")){return}var d=c.clipboardData.getData("text/html");return(d.match(/^(?:|<meta (?:[^>]+)>)<img src="([^"]+)"(?:[^/^>]+)(?:[^>]+)(?:|\/)>(?:|.)$/)||[])[1]};a.getTextPasteContent=function(c){return c.clipboardData.types&&_.contains(c.clipboardData.types,"text/plain")&&c.clipboardData.getData("text/plain")||""};a.normalizePasteEvent=function(c){if(c&&c.originalEvent&&c.originalEvent.clipboardData){c.clipboardData=c.originalEvent.clipboardData}if(c&&!c.clipboardData&&window.clipboardData){c.clipboardData={files:window.clipboardData.files,types:{contains:function(d){if(d=="text/plain"){return !!window.clipboardData.getData("Text")}}},getData:function(d){if(d=="text/plain"){return window.clipboardData.getData("Text")}}}}return c};a.browserIsSupported=function(c){var e=document.documentElement.className.split(/\s+/),f=(c||navigator.platform).indexOf("Mac")!==-1,d=b.inArray("safari",e)!==-1;return !(f&&d)};a.insertWikiMarkup=function(g,d,e,f){var c="!"+g+".png!";a.insertToInput(c,d,e,f)};a.insertToInput=function(d,c,e,f){if(!b(c).is(":input")){return}b(c).one("focus",function(){var h=b(c).val();var g=h.substring(0,e);var i=h.substring(f,h.length);b(c).val(g+d+i);b(c).trigger("input");c.selectionStart=c.selectionEnd=e+d.length;var j=b(c).data("wikiEditor");if(j&&j.undoRedoEl&&_.isFunction(j.undoRedoEl.recordHistoryItem)){j.undoRedoEl.recordHistoryItem()}})};a.loadImage=function(e){var c=new b.Deferred();var d=new Image();d.setAttribute("crossOrigin","anonymous");d.onload=function(){c.resolve(d)};d.onerror=c.reject.bind(c);d.src=e;if(d.width>0&&d.height>0){c.resolve(d)}return c};a.convertImageToBlob=function(f){var c=b("<canvas>").attr("width",f.width).attr("height",f.height)[0];c.getContext("2d").drawImage(f,0,0);try{if(c.mozGetAsFile){return c.mozGetAsFile("image/png")}if(c.toDataURL){return new Blob([a.handler.decodeBase64DataUri(c.toDataURL("image/png"))],{type:"image/png"})}}catch(d){return null}}})(jQuery,AJS.namespace("JIRA.AttachImagesPlugin"));;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'requireDeployJava.js' */
(function(c,b){var a=null;b.requireDeployJava=function(){var d;if(a!==null){return a}d=c.Deferred();a=d.promise();c('<iframe style="display: none !important; visibility: hidden !important; opacity: 0"/>').attr("src",b.resourceUris.get("deployJava.html")).one("load",function(){d.resolve(this.contentWindow.deployJava,this.contentWindow)}).one("error",d.reject.bind(d)).appendTo("body");return a};b.requireDeployJava._resetForTesting=function(){a=null}})(AJS.$,AJS.namespace("JIRA.AttachImagesPlugin"));;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'polyfill.js' */
(function(f,b,c){var g,e,h,d;function a(){var i=f.Deferred();return i.reject.apply(i,arguments)}(function(){var k=document.documentElement.className.split(/\s+/),m=f.inArray("msie",k)>-1,n=f.inArray("msie-gt-7",k)>-1,l=f.inArray("msie-gt-8",k)>-1,j=f.inArray("msie-gt-9",k)>-1,i=f.inArray("msie-gt-10",k)>-1;g=m&&n&&!l;e=m&&l&&!j;h=m&&j&&!i})();c.polyfill=new (function(){var j;var k=b.bind(function(n){if(c.isKeyPasteEvent(n)){d.reload();var m=d.getClipboardData();if(m){var l=d.getClipboardData(this.pasteImageWidth,this.pasteImageHeight);if(l.length>this.dataURILimit){var o=this.dataURILimit/l.length;l=d.getClipboardData(this.pasteImageWidth*o,this.pasteImageHeight*o)}j.trigger("polyPaste",[m,l])}}},this);this.install=b.once(function(l){j=f(l);return c.requireDeployJava().pipe(function(p,m){var o,s,n,q="1.7.0_06",r;if(p.getJREs().length===0){return a("java-absent")}else{if(!p.versionCheck(q+"+")){return a("java-version")}}n=!p.versionCheck("1.7.0_45+");r=c.resourceUris.get(n?"clipboard-legacy.jar":"clipboard.jar");o={id:"JIRA HTML5 Images Applet",codebase:c.dirname(r),code:"com.atlassian.plugins.jira.screenshot.applet.ScreenshotApplet.class",archive:c.basename(r),width:0,height:0};s={permissions:"all-permissions"};p.runApplet(o,s,q);d=m.document.getElementById(o.id);try{if(!d||!d.isSecurityOk()){return a("java-security")}}catch(t){return a("java-security")}j.on("keydown",k);return i},function(){return a("unknown")}).pipe(null,function(n){var m;if(n==="unknown"){m="A problem occurred while running Java."}else{if(n==="java-version"){m=AJS.format("You need to {0}upgrade Java{1}.",'<a href="//java.com">',"</a>")}else{if(n==="java-absent"){m=AJS.format("You need to install {0}Java{1}.",'<a href="//java.com">',"</a>")}else{if(n==="java-security"){m=AJS.format("Your Java security settings are blocking this feature. Please upgrade to the latest {0}Java{1}.",'<a href="//java.com">',"</a>")}}}}return a(n,m)})});this.isRequired=function(){return g||e||h};this.isRequiredForBinaryAjax=function(){return g||e};this.pasteImageWidth=510;this.pasteImageHeight=280;this.dataURILimit=g?32000:Number.MAX_VALUE;function i(p,n){var o=document.cookies,l=f.Deferred();var q={getResponseHeader:function(r){return responseHeaders[r]}};var m=new f.Deferred().progress(b.bind(l.notify,l)).done(b.bind(l.resolve,l)).fail(function(t,r){var s=r||JSON.stringify({errorMessage:s});l.reject(null,null,null,new JIRA.SmartAjax.SmartAjaxResult(q,0,"error",s,true))});d.doMultipartRequest(n,"UTF-8",window.navigator.userAgent,m);l.always(function(){document.cookies=o});return l}this.proxyAjaxRequest=function(l,m){return function(){var n=JIRA.SmartAjax.makeRequest;JIRA.SmartAjax.makeRequest=function(o){var p=b.reduce(b.keys(o.data),function(t,s){t.push(s,o.data[s]);return t},[]);p.push("secureToken",m());var q=d.doAjaxRequest(o.url,"UTF-8",window.navigator.userAgent,f.Deferred(),p);q.abort=f.noop;q.then(function(t){var s=b.filter(arguments,function(x,w){return w>0});s[0]="Status";s=b.reduce(b.reduce(s,function(z,y,w){var x=(w/2)<<0;(z[x]||(z[x]=[])).push(y);return z},[]),function(x,w){x[w[0]]=w[1];return x},{});var u={getResponseHeader:function(w){return s[w]}};var v="success";var r=new JIRA.SmartAjax.SmartAjaxResult(u,0,"success",t,true);o.complete(u,v,r)});return q};l.apply(this,arguments);JIRA.SmartAjax.makeRequest=n}}})})(AJS.$,_,AJS.namespace("JIRA.AttachImagesPlugin"));;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'html5.js' */
AJS.namespace("JIRA.AttachImagesPlugin");JIRA.AttachImagesPlugin.handler=(function(e,b,d){var a;a={REQUEST_TIMEOUT_MILLIS:5*60*1000,screenshotFileUpload:{},screenshotFileUploadUri:null,$document:undefined,$window:undefined,$container:undefined,$fakeInput:undefined,uploadError:false,uploadErrorMsg:"",progressView:{hidden:false,progress:0,old:0,progressBarContainer:undefined,progressEl:undefined,container:undefined,options:undefined,staticProgress:undefined,initProgress:function(){this.container=this.buildContainer();this.progressEl=this.buildProgress();this.container.append(this.progressEl);this.options={showPercentage:false,height:"5px"};this.progressBarContainer=e("#attach-screenshot-progress-container");this.progressBarContainer.empty();this.progressBarContainer.append(this.container);this.staticProgress=this.container;this.hidden=true},finish:function(){this.value(100)},progressHandler:function(g){var f=Math.round(g.loaded*100/g.total);a.progressView.value(f)},value:function(f){if(f>100){f=100}else{if(f<0){f=0}}if(this.hidden){this.progressEl.show();this.hidden=false}if(this.old!==f){this.progressEl.progressBar(f,this.options);if(f>=100){this.progressEl.fadeOut()}this.old=f}},buildContainer:function(){return e("<div>").addClass("file-progress")},buildProgress:function(){return e("<div>").attr("id","attach-screenshot-upload-progress")}},dialogView:{pasteCatcher:{},presenter:undefined,getMaxSize:function(){return e("#attach-max-size").text()},getFileSize:function(){if(e.isPlainObject(this.presenter.screenshotFileUpload)&&b.isEmpty(this.presenter.screenshotFileUpload)){return 0}return this.presenter.screenshotFileUpload.size||this.presenter.screenshotFileUpload.byteLength||this.presenter.screenshotFileUpload.length},cleanGeneralErrors:function(){e("#error-attach-screenshot-image").closest(".field-group").remove()},cleanFileErrors:function(){e("#error-attach-screenshot-filename").remove()},displayErrors:function(f){a.dialogView.cleanFileErrors();a.dialogView.cleanGeneralErrors();if("compatibility" in f){e("#attach-screenshot-inner-container").before(aui.message.error({content:f.compatibility}))}if("fileName" in f){e("#attach-screenshot-filename-group").append('<div class="error" id="error-attach-screenshot-filename" data-field="attachscreenshotname"></div>').find(".error").text(f.fileName)}if("fileUpload" in f){e("#attach-screenshot-inner-container").append('<div class="field-group attach-screenshot-image-error"><div class="error" id="error-attach-screenshot-image"></div></div>').find(".error").text(f.fileUpload)}},appendBlobImage:function(f){var h=window.URL||window.webkitURL;var g=h.createObjectURL(f);this.presenter.screenshotFileUpload=f;this.createImage(g)},createImage:function(i){var g=new Image();g.onload=function(){};g.src=i;this.presenter.screenshotToUpload=g;var h=e(g);h.addClass("attach-screenshot-pasted-image");var f=e("#attach-screenshot-image-container");f.empty();f.append(h);this.presenter.$fakeInput.focus();b.defer(function(){a.imageCreatedHandler()})},checkInput:function(){var g,f=a.dialogView.pasteCatcher.childNodes[0];if(f){if("IMG"===f.tagName){if(f.src.startsWith("data:")){g=f.src}else{}}a.dialogView.pasteCatcher.innerHTML=""}if(!g){a.$fakeInput.focus()}return g},onPaste:function(f){a.dialogView.cleanFileErrors();a.dialogView.cleanGeneralErrors();if(d.isImagePasteEvent(f)){a.getFileFromEvent(f).then(function(g){this.appendBlobImage(g)}.bind(this))}else{setTimeout(function(){var g=this.checkInput();if(g){a.screenshotFileUpload=a.decodeBase64DataUri(g);a.dialogView.createImage(g)}}.bind(this),0)}},getFakeInput:function(){return e("#attach-screenshot-fake-input")},getContainer:function(){return e("#attach-screenshot-image-container")},getIssueKey:function(){return e("input[name='id']").val()},getDocument:function(){return e(document)},getWindow:function(){return e(window)},getFileNameInput:function(){return e("#attachscreenshotname")},hasPngExtension:function(g){var f=/\.png$/i;return f.test(g)},setFileToConvert:function(f){e("input[name='filetoconvert']").val(f)},buildPasteCatcher:function(){if(!document.getElementById("attach-screenshot-form")){return}var f=document.createElement("div");f.setAttribute("contenteditable","true");f.style.width=0;f.style.height=0;f.style.position="absolute";f.style.top="-5000px";document.getElementById("attach-screenshot-form").appendChild(f);return f},_getFormSubmits:function(){return e("#attach-screenshot-form").find("button.aui-button")},disable:function(){this._getFormSubmits().attr("disabled","disabled");return this},enable:function(){this._getFormSubmits().removeAttr("disabled");return this},isEnabled:function(){return this.isVisible()&&!this._getFormSubmits().attr("disabled")},isVisible:function(){return e("#attach-screenshot-form").length>0},initDialog:function(f){this.pasteCatcher={};this.presenter=f;if(!d.polyfill.isRequired()){this.pasteCatcher=this.buildPasteCatcher()}}},initScreenshotPasteHandler:function(){var f=a.dialogView;a.screenshotFileUpload={};a.resetUploadErrors();a.dialogView.initDialog(a.getPresenter());a.$document=f.getDocument();a.$window=f.getWindow();a.$container=f.getContainer();a.$fakeInput=f.getFakeInput();a.bindOnce(a.$container,"click",a.setFocusOnClickHandler);a.bindOnce(a.$fakeInput,"focus",a.showFocusOnFieldHandler);a.bindOnce(a.$fakeInput,"blur",a.hideFocusOnFieldHandler);a.bindOnce(a.$fakeInput,"keydown",a.keyDownHandler);if(!d.browserIsSupported()){f.displayErrors({compatibility:AJS.format("Your browser is not supported. Consider using an alternative supported browser such as {0}Google Chrome{1} or {2}Firefox{3}.",'<a href="//www.google.com/chrome/browser/">',"</a>",'<a href="//www.mozilla.org/firefox/">',"</a>")})}else{if(d.polyfill.isRequired()){d.polyfill.install(document).done(function(g){a.bindOnce(a.$document,"polyPaste",a.polyPasteHandler);if(d.polyfill.isRequiredForBinaryAjax()){a.executeAjaxUpload=g}}).fail(function(h,g){f.displayErrors({compatibility:g})})}else{a.bindOnce(a.$window,"paste",a.pasteHandler)}}},resetUploadErrors:function(){a.uploadError=false;a.uploadErrorMsg=undefined},setUploadError:function(f){a.uploadError=true;a.uploadErrorMsg=f},bindOnce:function(h,f,g){h.unbind(f,g);h.bind(f,g)},showFocusOnFieldHandler:function(){a.$container.addClass("focus")},hideFocusOnFieldHandler:function(){a.$container.addClass("focus")},setFocusOnClickHandler:function(){a.$fakeInput.focus()},pasteHandler:function(f){f=d.normalizePasteEvent(f);if(!a.dialogView.isEnabled()){return}a.dialogView.onPaste(f)},polyPasteHandler:function(g,f,h){if(!a.dialogView.isEnabled()){return}a.screenshotFileUpload={length:-1};a.screenshotFileUploadUri=f;a.dialogView.createImage(h)},keyDownHandler:function(f){if(d.isKeyPasteEvent(f)){if(a.dialogView.pasteCatcher.focus){a.dialogView.pasteCatcher.focus()}}},getPresenter:function(){return a},imageCreatedHandler:function(){a.doAjaxUpload(this.dialogView.getIssueKey(),this.dialogView.getFileNameInput().val())},getMimeType:function(){if(a.screenshotFileUploadUri){return"image/jpeg"}return"image/png"},createData:function(){if(d.polyfill.isRequired()&&!d.polyfill.isRequiredForBinaryAjax()){return this.decodeBase64DataUri(a.screenshotFileUploadUri)}return a.screenshotFileUpload},decodeBase64DataUri:function(g){var i=";base64,",h=g.slice(0,g.indexOf(i))+i,f=g.substring(h.length);return d.base64decode(f)},getFileFromEvent:function(g){var f=new e.Deferred();if(d.isImagePasteEvent(g)){f.resolve(b(g.clipboardData.items).filter(function(h){return h.type.indexOf("image")!==-1}).map(function(h){return h.getAsFile()})[0]||b(g.clipboardData.files).filter(function(h){return h.type.indexOf("image")!==-1})[0])}else{f.reject()}return f.promise()},clipboardDataIsEmpty:function(f){if(window.clipboardData!=null){return false}return !(f&&f.clipboardData&&f.clipboardData.types&&f.clipboardData.types.length>0)},validateFileSize:function(i){var f=a.dialogView.getFileSize();var h=a.dialogView.getMaxSize();if(f>h){var g=AJS.InlineAttach.Text.fileSize(h,f);i.fileUpload=AJS.format("Screenshot is too large to attach. Attachment is {0} but the largest allowed attachment is {1}.",g[1],g[0])}},validateFormData:function(f,h){var g={};if(e.isPlainObject(f)&&b.isEmpty(f)){g.fileUpload="Please paste the image you wish to upload"}a.validateFileSize(g);if(a.uploadError){g.fileUpload="The error occurred during image upload - you will need to try the pasting image again. Sorry for the inconvenience."}if(""==h){g.fileName="You must specify a filename of the image."}if(!d.isValidFileName(h)){g.fileName="Filename must not contain the characters \'\\\', \'/\', \'\"\', \':\', \'?\', \'*\', \'\u003c\', \'|\', \'\u003e\', \'!\'"}return g},doAjaxUpload:function(f,m){a.dialogView.disable();var l={};a.validateFileSize(l);if(!b.isEmpty(l)){a.dialogView.displayErrors(l);a.dialogView.enable();return}var j=a.createData(),k=a.getMimeType(),h=e("#attach-screenshot-form").data("attach-secure-token"),g=e("#attach-screenshot-form").find("input[name='formToken']").attr("value");var i=AJS.contextPath()+"/rest/internal/1.0/AttachTemporaryFile"+(d.polyfill.isRequired()?"/secure?":"?")+"size="+this.dialogView.getFileSize()+"&filename="+encodeURIComponent(m)+"&atl_token="+encodeURIComponent(atl_token())+"&issueId="+encodeURIComponent(this.dialogView.getIssueKey())+(h?("&secureToken="+encodeURIComponent(h)):"")+(g?("&formToken="+encodeURIComponent(g)):"");a.resetUploadErrors();a.executeAjaxUpload(j,i,k).progress(function(n){if(n=="init"){a.progressView.initProgress()}}).done(function(n){if(typeof n=="string"){n=JSON.parse(n)}a.dialogView.setFileToConvert(n.id)}).fail(function(p,s,r,n){var o;if(n.statusText=="abort"){o="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."}else{if(n.hasData){var q=JSON.parse(n.data);if(q.errorMessage){o=q.errorMessage}else{o=JIRA.SmartAjax.buildSimpleErrorContent(n,{alert:false})}}}a.setUploadError(o);a.dialogView.displayErrors({fileUpload:o})}).always(function(){var n=e.Deferred();if(d.polyfill.isRequired()){a.reloadSecureToken(n)}else{n.resolve()}n.then(function(){a.dialogView.enable();a.progressView.finish()})}).progress(function(n){if(n!="init"){a.progressView.progressHandler(n)}})},executeAjaxUpload:function(h,g,j){var f=e.Deferred();var i=JIRA.SmartAjax.makeRequest({type:"POST",url:g,contentType:j,processData:false,data:h,timeout:a.REQUEST_TIMEOUT_MILLIS,success:f.resolve.bind(f),error:f.reject.bind(f),xhr:function(){var k=e.ajaxSettings.xhr();f.notify("init");k.upload.addEventListener("progress",f.notify.bind(f));return k}});f.always(function(){e.ajaxSettings.xhr().removeEventListener("progress",a.progressView.progressHandler);e(JIRA.Dialogs.attachScreenshotDialog).off("Dialog.hide",i.abort)});e(JIRA.Dialogs.attachScreenshotDialog).one("Dialog.hide",i.abort);return f.promise()},reloadSecureToken:function(f){var g=AJS.contextPath()+"/secure/ShowAttachScreenshotFormAction!default.jspa?id="+encodeURIComponent(this.dialogView.getIssueKey())+"&inline=true&decorator=dialog&_="+(new Date().getTime());e.get(g).then(function(h){var i=e(h).find("#attach-screenshot-form").data("attach-secure-token");if(i){e("#attach-screenshot-form").data("attach-secure-token",i);f.resolve(i)}else{f.reject()}},b.bind(f.reject,f))},show:function(){var f=new e.Deferred();var g=e(".issueaction-attach-screenshot-html5.aui-list-item-link");if(JIRA.Dialog.current!=null){return f.reject().promise()}if(g.length==0){return f.reject().promise()}b.defer(function(){g.trigger("click")});e(document).on("dialogContentReady",function(i,h){if(h===JIRA.Dialogs.attachScreenshotDialog&&a.dialogView.isEnabled()){f.resolve(h)}else{f.reject()}});e(document).on("ajaxComplete.jira.screenshot.dialog",function(j,i,h){if(h.url.indexOf(g.attr("href"))>-1){setTimeout(function(){if(!f.isResolved()){f.reject()}},1000)}});f.always(function(){e(document).off("ajaxComplete.jira.screenshot.dialog")});return f.promise()}};var c=JIRA.FormDialog.extend({options:{}});JIRA.ScreenshotDialog=c;e(document).ready(function(){var g=e.Deferred();if(!d.browserIsSupported()||!d.polyfill.isRequired()){g.resolve()}JIRA.Dialogs.attachScreenshotDialog=new c({id:"attach-screenshot-dialog",trigger:"a.issueaction-attach-screenshot-html5",isIssueDialog:true,onContentRefresh:function f(){this.$form.bind("before-submit",function h(i){var j=a.validateFormData(a.screenshotFileUpload,e.trim(a.dialogView.getFileNameInput().val()));if(a.dialogView.getFileSize()==0){i.preventDefault();return false}else{if(!b.isEmpty(j)){a.dialogView.displayErrors(j);i.preventDefault();return false}}return true})},delayShowUntil:function(){if(d.polyfill.isRequired()){d.polyfill.install(document).done(function(){c.prototype._submitForm=d.polyfill.proxyAjaxRequest(c.prototype._submitForm,function(){return e("#attach-screenshot-form").data("submit-secure-token")})}).always(function(){g.resolve()})}return g}});e(document).bind("dialogContentReady",function(i,h){if(h===JIRA.Dialogs.attachScreenshotDialog&&document.getElementById("attach-screenshot-form")!==null){AJS.trigger("analytics",{name:"attach.screenshot.html5.contentReady",data:{}});a.initScreenshotPasteHandler()}});e(document).ready(function(){e(document).on("click","#attach-screenshot-html5",function(){AJS.trigger("analytics",{name:"attach.screenshot.html5.display",data:{}})})})});return a})(AJS.$,_,JIRA.AttachImagesPlugin);;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'issue-paste.js' */
(function(c,f,w,g){var v=0;var k=1;var d=2;var t=3;var n=4;var q=5;var i=7;var s=8;var o=9;var m=10;function j(A,z){z.stateName=A;var y=function(){var B=z.apply(null,arguments);B.stateName=A;return B};y.stateName=A;return y}function b(z,y,A){return j(z,function(){var D=setTimeout(function(){a(m)},A);var C=y.apply(null,arguments);var B=function(G,F){var E=C(G,F);if(E){clearTimeout(D);return E}};B.stateName=z;return B})}var l=j("idle",function(){function y(z){if(f(z.target).is(":input:not(.wiki-textfield)")||c.isContentEditable(z.target)){return}return true}return function(A,z){if(w.Dialog.current){return}if(g.DarkFeatures.isEnabled("com.atlassian.plugins.jira.screenshot.issuePasteDisabled")){w.trace("JIRA.AttachImagesPlugin.issuePasteDisabled");return}if(A==v&&c.isKeyPasteEvent(z)){if(f("html").is(".chrome, .safari")||!y(z)||!c.browserIsSupported()){return}g.trigger("analytics",{name:"attach.screenshot.html5.catchClipboard"});return new r(z)}if(A==k){if(c.isImagePasteEvent(z)){g.trigger("analytics",{name:"attach.screenshot.html5.handlePaste"});if(!y(z)){w.trace("JIRA.AttachImagesPlugin.pasteIgnored");return}if(f(z.target).is(":input.wiki-textfield")){z.preventDefault()}return new p(z)}}}});var r=b("catchClipboard",function(A){var y=document.activeElement;A.selectionStart=A.target.selectionStart;A.selectionEnd=A.target.selectionEnd;var B=f('<div contenteditable="true" class="attach-screenshot-paste-catcher"></div>').appendTo("body");B.focus();if(f(y).is(":focusable:input")){setTimeout(function(){y.focus()})}function z(){B.remove()}return function(F,C){if(F==k){if(c.isImagePasteEvent(C)){z();C.target=y;return new p(C)}if(c.isHtmlImagePasteEvent(C)){z();C.target=y;return new u(C)}if(c.isTextPasteEvent(C)){z();var G=c.getTextPasteContent(C);c.insertToInput(G,A.target,A.selectionStart,A.selectionEnd);C.preventDefault();return new l()}}if(F==m){z();var E=B.find(">img");if(E.is(":only-child")){var H=c.handler.decodeBase64DataUri(E.attr("src"));var D=new Blob([H],{type:"image/png"});return new e(D,A)}else{var G=B.text();c.insertToInput(G,A.target,A.selectionStart,A.selectionEnd);return l()}}}});var u=j("imageLoading",function(y){var z=c.getHtmlImagePaste(y);if(!z){a(q)}else{c.loadImage(z).then(function(A){a(n,A)},a.bind(null,q))}return function(C,A){if(C==n){var B=c.convertImageToBlob(A);if(B){return new e(B,y)}else{return new l()}}if(C==m||C==q){return new l()}}});var p=b("fileLoading",function(y){c.handler.getFileFromEvent(y).done(function(z){a(d,z)}).fail(function(){a(t)});return function(A,z){if(A==d){return new e(z,y)}else{if(A==t||A==m){return new l()}}}},1000);var e=b("dialogLoading",function(z,y){y.selectionStart=y.target.selectionStart;y.selectionEnd=y.target.selectionEnd;c.handler.show().done(function(A){a(i,A)}).fail(function(){a(s)});return function(B,A){if(B==i){return new h(z,A,y)}else{if(B==s||B==m){return new l()}}}},20000);var h=b("dialog",function(A,z,y){c.handler.dialogView.appendBlobImage(A);return function(C,B){if(C==o){return new l()}else{if(C==s){var E=B.find("#attachscreenshotname").val();var D=y.target;g.trigger("analytics",{name:"attach.screenshot.html5.dialogClosed"});if(E&&f(D).is(".wiki-textfield")){c.insertWikiMarkup(E,D,y.selectionStart,y.selectionEnd);setTimeout(function(){D.focus()});g.trigger("analytics",{name:"attach.screenshot.html5.insertWikiMarkup",data:{targetId:D.id}})}return new l()}else{if(C==m){if(!w.Dialog.current){return l()}}}}}});var x=new l();function a(z,y){if(a.eventQueue){a.eventQueue.push({type:z,object:y});return}a.eventQueue=[{type:z,object:y}];while(a.eventQueue.length>0){var A=a.eventQueue.splice(0,1)[0];var B=x(A.type,A.object);if(B){x=B}}delete a.eventQueue}f(document).ready(function(){f(window).on("keydown",function(y){a(v,y)});f(window).on("paste",function(y){a(k,c.normalizePasteEvent(y))});w.bind("Dialog.hide",function(y,A,z){if(z){a(o,A)}else{a(s,A)}})});c._getStateMap=function(){return{events:{EVENT_WINDOW_KEYDOWN:v,EVENT_WINDOW_PASTE:k,EVENT_FILE_LOADED:d,EVENT_FILE_LOAD_ERROR:t,EVENT_IMAGE_LOADED:n,EVENT_IMAGE_LOAD_ERROR:q,EVENT_DIALOG_LOADED:i,EVENT_DIALOG_CLOSED:s,EVENT_DIALOG_CANCELED:o,EVENT_TIMEOUT:m},states:{StateIdle:l,StateCatchClipboard:r,StateImageLoading:u,StateFileLoading:p,StateDialogLoading:e,StateDialog:h}}}})(AJS.namespace("JIRA.AttachImagesPlugin"),AJS.$,JIRA,AJS);;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'applet/deployJava.js' */
var deployJava=function(){var l={core:["id","class","title","style"],i18n:["lang","dir"],events:["onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmousemove","onmouseout","onkeypress","onkeydown","onkeyup"],applet:["codebase","code","name","archive","object","width","height","alt","align","hspace","vspace"],object:["classid","codebase","codetype","data","type","archive","declare","standby","height","width","usemap","name","tabindex","align","border","hspace","vspace"]};var b=l.object.concat(l.core,l.i18n,l.events);var m=l.applet.concat(l.core);function g(o){if(!d.debug){return}if(console.log){console.log(o)}else{alert(o)}}function k(p,o){if(p==null||p.length==0){return true}var r=p.charAt(p.length-1);if(r!="+"&&r!="*"&&(p.indexOf("_")!=-1&&r!="_")){p=p+"*";r="*"}p=p.substring(0,p.length-1);if(p.length>0){var q=p.charAt(p.length-1);if(q=="."||q=="_"){p=p.substring(0,p.length-1)}}if(r=="*"){return(o.indexOf(p)==0)}else{if(r=="+"){return p<=o}}return false}function e(){var o="//java.com/js/webstart.png";try{return document.location.protocol.indexOf("http")!=-1?o:"http:"+o}catch(p){return"http:"+o}}function n(p){var o="http://java.com/dt-redirect";if(p==null||p.length==0){return o}if(p.charAt(0)=="&"){p=p.substring(1,p.length)}return o+"?"+p}function j(q,p){var o=q.length;for(var r=0;r<o;r++){if(q[r]===p){return true}}return false}function c(o){return j(m,o.toLowerCase())}function i(o){return j(b,o.toLowerCase())}function a(o){if("MSIE"!=deployJava.browserName){return true}if(deployJava.compareVersionToPattern(deployJava.getPlugin().version,["10","0","0"],false,true)){return true}if(o==null){return false}return !k("1.6.0_33+",o)}var d={debug:null,version:"20120801",firefoxJavaVersion:null,myInterval:null,preInstallJREList:null,returnPage:null,brand:null,locale:null,installType:null,EAInstallEnabled:false,EarlyAccessURL:null,oldMimeType:"application/npruntime-scriptable-plugin;DeploymentToolkit",mimeType:"application/java-deployment-toolkit",launchButtonPNG:e(),browserName:null,browserName2:null,getJREs:function(){var t=new Array();if(this.isPluginInstalled()){var r=this.getPlugin();var o=r.jvms;for(var q=0;q<o.getLength();q++){t[q]=o.get(q).version}}else{var p=this.getBrowser();if(p=="MSIE"){if(this.testUsingActiveX("1.7.0")){t[0]="1.7.0"}else{if(this.testUsingActiveX("1.6.0")){t[0]="1.6.0"}else{if(this.testUsingActiveX("1.5.0")){t[0]="1.5.0"}else{if(this.testUsingActiveX("1.4.2")){t[0]="1.4.2"}else{if(this.testForMSVM()){t[0]="1.1"}}}}}}else{if(p=="Netscape Family"){this.getJPIVersionUsingMimeType();if(this.firefoxJavaVersion!=null){t[0]=this.firefoxJavaVersion}else{if(this.testUsingMimeTypes("1.7")){t[0]="1.7.0"}else{if(this.testUsingMimeTypes("1.6")){t[0]="1.6.0"}else{if(this.testUsingMimeTypes("1.5")){t[0]="1.5.0"}else{if(this.testUsingMimeTypes("1.4.2")){t[0]="1.4.2"}else{if(this.browserName2=="Safari"){if(this.testUsingPluginsArray("1.7.0")){t[0]="1.7.0"}else{if(this.testUsingPluginsArray("1.6")){t[0]="1.6.0"}else{if(this.testUsingPluginsArray("1.5")){t[0]="1.5.0"}else{if(this.testUsingPluginsArray("1.4.2")){t[0]="1.4.2"}}}}}}}}}}}}}if(this.debug){for(var q=0;q<t.length;++q){g("[getJREs()] We claim to have detected Java SE "+t[q])}}return t},installJRE:function(r,p){var o=false;if(this.isPluginInstalled()&&this.isAutoInstallEnabled(r)){var q=false;if(this.isCallbackSupported()){q=this.getPlugin().installJRE(r,p)}else{q=this.getPlugin().installJRE(r)}if(q){this.refresh();if(this.returnPage!=null){document.location=this.returnPage}}return q}else{return this.installLatestJRE()}},isAutoInstallEnabled:function(o){if(!this.isPluginInstalled()){return false}if(typeof o=="undefined"){o=null}return a(o)},isCallbackSupported:function(){return this.isPluginInstalled()&&this.compareVersionToPattern(this.getPlugin().version,["10","2","0"],false,true)},installLatestJRE:function(q){if(this.isPluginInstalled()&&this.isAutoInstallEnabled()){var r=false;if(this.isCallbackSupported()){r=this.getPlugin().installLatestJRE(q)}else{r=this.getPlugin().installLatestJRE()}if(r){this.refresh();if(this.returnPage!=null){document.location=this.returnPage}}return r}else{var p=this.getBrowser();var o=navigator.platform.toLowerCase();if((this.EAInstallEnabled=="true")&&(o.indexOf("win")!=-1)&&(this.EarlyAccessURL!=null)){this.preInstallJREList=this.getJREs();if(this.returnPage!=null){this.myInterval=setInterval("deployJava.poll()",3000)}location.href=this.EarlyAccessURL;return false}else{if(p=="MSIE"){return this.IEInstall()}else{if((p=="Netscape Family")&&(o.indexOf("win32")!=-1)){return this.FFInstall()}else{location.href=n(((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):""))}}return false}}},runApplet:function(p,u,r){if(r=="undefined"||r==null){r="1.1"}var t="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var o=r.match(t);if(this.returnPage==null){this.returnPage=document.location}if(o!=null){var q=this.getBrowser();if(q!="?"){if(this.versionCheck(r+"+")){this.writeAppletTag(p,u)}else{if(this.installJRE(r+"+")){this.refresh();location.href=document.location;this.writeAppletTag(p,u)}}}else{this.writeAppletTag(p,u)}}else{g("[runApplet()] Invalid minimumVersion argument to runApplet():"+r)}},writeAppletTag:function(r,w){var o="<applet ";var q="";var t="</applet>";var x=true;if(null==w||typeof w!="object"){w=new Object()}for(var p in r){if(!c(p)){w[p]=r[p]}else{o+=(" "+p+'="'+r[p]+'"');if(p=="code"){x=false}}}var v=false;for(var u in w){if(u=="codebase_lookup"){v=true}if(u=="object"||u=="java_object"||u=="java_code"){x=false}q+='<param name="'+u+'" value="'+w[u]+'"/>'}if(!v){q+='<param name="codebase_lookup" value="false"/>'}if(x){o+=(' code="dummy"')}o+=">";document.write(o+"\n"+q+"\n"+t)},versionCheck:function(p){var v=0;var x="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?(\\*|\\+)?$";var y=p.match(x);if(y!=null){var r=false;var u=false;var q=new Array();for(var t=1;t<y.length;++t){if((typeof y[t]=="string")&&(y[t]!="")){q[v]=y[t];v++}}if(q[q.length-1]=="+"){u=true;r=false;q.length--}else{if(q[q.length-1]=="*"){u=false;r=true;q.length--}else{if(q.length<4){u=false;r=true}}}var w=this.getJREs();for(var t=0;t<w.length;++t){if(this.compareVersionToPattern(w[t],q,r,u)){return true}}return false}else{var o="Invalid versionPattern passed to versionCheck: "+p;g("[versionCheck()] "+o);alert(o);return false}},isWebStartInstalled:function(r){var q=this.getBrowser();if(q=="?"){return true}if(r=="undefined"||r==null){r="1.4.2"}var p=false;var t="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var o=r.match(t);if(o!=null){p=this.versionCheck(r+"+")}else{g("[isWebStartInstaller()] Invalid minimumVersion argument to isWebStartInstalled(): "+r);p=this.versionCheck("1.4.2+")}return p},getJPIVersionUsingMimeType:function(){for(var p=0;p<navigator.mimeTypes.length;++p){var q=navigator.mimeTypes[p].type;var o=q.match(/^application\/x-java-applet;jpi-version=(.*)$/);if(o!=null){this.firefoxJavaVersion=o[1];if("Opera"!=this.browserName2){break}}}},launchWebStartApplication:function(r){var o=navigator.userAgent.toLowerCase();this.getJPIVersionUsingMimeType();if(this.isWebStartInstalled("1.7.0")==false){if((this.installJRE("1.7.0+")==false)||((this.isWebStartInstalled("1.7.0")==false))){return false}}var u=null;if(document.documentURI){u=document.documentURI}if(u==null){u=document.URL}var p=this.getBrowser();var q;if(p=="MSIE"){q='<object classid="clsid:8AD9C840-044E-11D1-B3E9-00805F499D93" width="0" height="0"><PARAM name="launchjnlp" value="'+r+'"><PARAM name="docbase" value="'+u+'"></object>'}else{if(p=="Netscape Family"){q='<embed type="application/x-java-applet;jpi-version='+this.firefoxJavaVersion+'" width="0" height="0" launchjnlp="'+r+'"docbase="'+u+'" />'}}if(document.body=="undefined"||document.body==null){document.write(q);document.location=u}else{var t=document.createElement("div");t.id="div1";t.style.position="relative";t.style.left="-10000px";t.style.margin="0px auto";t.className="dynamicDiv";t.innerHTML=q;document.body.appendChild(t)}},createWebStartLaunchButtonEx:function(q,p){if(this.returnPage==null){this.returnPage=q}var o="javascript:deployJava.launchWebStartApplication('"+q+"');";document.write('<a href="'+o+'" onMouseOver="window.status=\'\'; return true;"><img src="'+this.launchButtonPNG+'" border="0" /></a>')},createWebStartLaunchButton:function(q,p){if(this.returnPage==null){this.returnPage=q}var o="javascript:if (!deployJava.isWebStartInstalled(&quot;"+p+"&quot;)) {if (deployJava.installLatestJRE()) {if (deployJava.launch(&quot;"+q+"&quot;)) {}}} else {if (deployJava.launch(&quot;"+q+"&quot;)) {}}";document.write('<a href="'+o+'" onMouseOver="window.status=\'\'; return true;"><img src="'+this.launchButtonPNG+'" border="0" /></a>')},launch:function(o){document.location=o;return true},isPluginInstalled:function(){var o=this.getPlugin();if(o&&o.jvms){return true}else{return false}},isAutoUpdateEnabled:function(){if(this.isPluginInstalled()){return this.getPlugin().isAutoUpdateEnabled()}return false},setAutoUpdateEnabled:function(){if(this.isPluginInstalled()){return this.getPlugin().setAutoUpdateEnabled()}return false},setInstallerType:function(o){this.installType=o;if(this.isPluginInstalled()){return this.getPlugin().setInstallerType(o)}return false},setAdditionalPackages:function(o){if(this.isPluginInstalled()){return this.getPlugin().setAdditionalPackages(o)}return false},setEarlyAccess:function(o){this.EAInstallEnabled=o},isPlugin2:function(){if(this.isPluginInstalled()){if(this.versionCheck("1.6.0_10+")){try{return this.getPlugin().isPlugin2()}catch(o){}}}return false},allowPlugin:function(){this.getBrowser();var o=("Safari"!=this.browserName2&&"Opera"!=this.browserName2);return o},getPlugin:function(){this.refresh();var o=null;if(this.allowPlugin()){o=document.getElementById("deployJavaPlugin")}return o},compareVersionToPattern:function(v,p,r,t){if(v==undefined||p==undefined){return false}var w="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var x=v.match(w);if(x!=null){var u=0;var y=new Array();for(var q=1;q<x.length;++q){if((typeof x[q]=="string")&&(x[q]!="")){y[u]=x[q];u++}}var o=Math.min(y.length,p.length);if(t){for(var q=0;q<o;++q){if(y[q]<p[q]){return false}else{if(y[q]>p[q]){return true}}}return true}else{for(var q=0;q<o;++q){if(y[q]!=p[q]){return false}}if(r){return true}else{return(y.length==p.length)}}}else{return false}},getBrowser:function(){if(this.browserName==null){var o=navigator.userAgent.toLowerCase();g("[getBrowser()] navigator.userAgent.toLowerCase() -> "+o);if((o.indexOf("msie")!=-1)&&(o.indexOf("opera")==-1)){this.browserName="MSIE";this.browserName2="MSIE"}else{if(o.indexOf("trident")!=-1||o.indexOf("Trident")!=-1){this.browserName="MSIE";this.browserName2="MSIE"}else{if(o.indexOf("iphone")!=-1){this.browserName="Netscape Family";this.browserName2="iPhone"}else{if((o.indexOf("firefox")!=-1)&&(o.indexOf("opera")==-1)){this.browserName="Netscape Family";this.browserName2="Firefox"}else{if(o.indexOf("chrome")!=-1){this.browserName="Netscape Family";this.browserName2="Chrome"}else{if(o.indexOf("safari")!=-1){this.browserName="Netscape Family";this.browserName2="Safari"}else{if((o.indexOf("mozilla")!=-1)&&(o.indexOf("opera")==-1)){this.browserName="Netscape Family";this.browserName2="Other"}else{if(o.indexOf("opera")!=-1){this.browserName="Netscape Family";this.browserName2="Opera"}else{this.browserName="?";this.browserName2="unknown"}}}}}}}}g("[getBrowser()] Detected browser name:"+this.browserName+", "+this.browserName2)}return this.browserName},testUsingActiveX:function(o){var q="JavaWebStart.isInstalled."+o+".0";if(typeof ActiveXObject=="undefined"||!ActiveXObject){g("[testUsingActiveX()] Browser claims to be IE, but no ActiveXObject object?");return false}try{return(new ActiveXObject(q)!=null)}catch(p){return false}},testForMSVM:function(){var p="{08B0E5C0-4FCB-11CF-AAA5-00401C608500}";if(typeof oClientCaps!="undefined"){var o=oClientCaps.getComponentVersion(p,"ComponentID");if((o=="")||(o=="5,0,5000,0")){return false}else{return true}}else{return false}},testUsingMimeTypes:function(p){if(!navigator.mimeTypes){g("[testUsingMimeTypes()] Browser claims to be Netscape family, but no mimeTypes[] array?");return false}for(var q=0;q<navigator.mimeTypes.length;++q){s=navigator.mimeTypes[q].type;var o=s.match(/^application\/x-java-applet\x3Bversion=(1\.8|1\.7|1\.6|1\.5|1\.4\.2)$/);if(o!=null){if(this.compareVersions(o[1],p)){return true}}}return false},testUsingPluginsArray:function(p){if((!navigator.plugins)||(!navigator.plugins.length)){return false}var o=navigator.platform.toLowerCase();for(var q=0;q<navigator.plugins.length;++q){s=navigator.plugins[q].description;if(s.search(/^Java Switchable Plug-in (Cocoa)/)!=-1){if(this.compareVersions("1.5.0",p)){return true}}else{if(s.search(/^Java/)!=-1){if(o.indexOf("win")!=-1){if(this.compareVersions("1.5.0",p)||this.compareVersions("1.6.0",p)){return true}}}}}if(this.compareVersions("1.5.0",p)){return true}return false},IEInstall:function(){location.href=n(((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):""));return false},done:function(p,o){},FFInstall:function(){location.href=n(((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):"")+((this.installType!=null)?("&type="+this.installType):""));return false},compareVersions:function(r,t){var p=r.split(".");var o=t.split(".");for(var q=0;q<p.length;++q){p[q]=Number(p[q])}for(var q=0;q<o.length;++q){o[q]=Number(o[q])}if(p.length==2){p[2]=0}if(p[0]>o[0]){return true}if(p[0]<o[0]){return false}if(p[1]>o[1]){return true}if(p[1]<o[1]){return false}if(p[2]>o[2]){return true}if(p[2]<o[2]){return false}return true},enableAlerts:function(){this.browserName=null;this.debug=true},poll:function(){this.refresh();var o=this.getJREs();if((this.preInstallJREList.length==0)&&(o.length!=0)){clearInterval(this.myInterval);if(this.returnPage!=null){location.href=this.returnPage}}if((this.preInstallJREList.length!=0)&&(o.length!=0)&&(this.preInstallJREList[0]!=o[0])){clearInterval(this.myInterval);if(this.returnPage!=null){location.href=this.returnPage}}},writePluginTag:function(){var o=this.getBrowser();if(o=="MSIE"){document.write('<object classid="clsid:CAFEEFAC-DEC7-0000-0001-ABCDEFFEDCBA" id="deployJavaPlugin" width="0" height="0" style="position: absolute; top: -5000px;"></object>')}else{if(o=="Netscape Family"&&this.allowPlugin()){this.writeEmbedTag()}}},refresh:function(){navigator.plugins.refresh(false);var o=this.getBrowser();if(o=="Netscape Family"&&this.allowPlugin()){var p=document.getElementById("deployJavaPlugin");if(p==null){this.writeEmbedTag()}}},writeEmbedTag:function(){var o=false;if(navigator.mimeTypes!=null){for(var p=0;p<navigator.mimeTypes.length;p++){if(navigator.mimeTypes[p].type==this.mimeType){if(navigator.mimeTypes[p].enabledPlugin){document.write('<embed id="deployJavaPlugin" type="'+this.mimeType+'" hidden="true" />');o=true}}}if(!o){for(var p=0;p<navigator.mimeTypes.length;p++){if(navigator.mimeTypes[p].type==this.oldMimeType){if(navigator.mimeTypes[p].enabledPlugin){document.write('<embed id="deployJavaPlugin" type="'+this.oldMimeType+'" hidden="true" />')}}}}}}};d.writePluginTag();if(d.locale==null){var h=null;if(h==null){try{h=navigator.userLanguage}catch(f){}}if(h==null){try{h=navigator.systemLanguage}catch(f){}}if(h==null){try{h=navigator.language}catch(f){}}if(h!=null){h.replace("-","_");d.locale=h}}return d}();;
;/* module-key = 'com.atlassian.jira.plugins.jira-software-plugin:jira-software-project-template-resources', location = '/projecttemplates/soy/SoftwareDevelopmentTemplate.soy' */
// This file was automatically generated from SoftwareDevelopmentTemplate.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }
if (typeof JIRA.Templates.ProjectTemplates.SoftwareTemplates == 'undefined') { JIRA.Templates.ProjectTemplates.SoftwareTemplates = {}; }


JIRA.Templates.ProjectTemplates.SoftwareTemplates.renderSoftwareDevelopmentExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="software-development-info"><div class="left-info"><p>', soy.$$escapeHtml("Select this project to work on new features for your product and to also track any bugs. JIRA will provide you with a basic workflow with the following issue types. You can optionally configure these later."), '</p><h3>', soy.$$escapeHtml("Issue Types"), '</h3><ul class="project-template-issuetype-list"><li><span class="issuetype-list-label"><span class="issuetype-icon bug"></span><span class="issuetype-name">', soy.$$escapeHtml("Bug"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon improvement"></span><span class="issuetype-name">', soy.$$escapeHtml("Improvement"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon newfeature"></span><span class="issuetype-name">', soy.$$escapeHtml("New Feature"), '</span></span></li></ul></div><div class="right-info software-development-screenshot"></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/js/lib/ajaxHooks/xdr.js' */
if(window.XDomainRequest){jQuery.ajaxTransport(function(b){if(b.crossDomain&&b.async){if(b.timeout){b.xdrTimeout=b.timeout;delete b.timeout}var a;return{send:function(d,c){function e(f,i,h,g){a.onload=a.onerror=a.ontimeout=jQuery.noop;a=undefined;c(f,i,h,g)}a=new XDomainRequest();a.onload=function(){e(200,"OK",{text:a.responseText},"Content-Type: "+a.contentType)};a.onerror=function(){e(404,"Not Found")};a.onprogress=jQuery.noop;a.ontimeout=function(){e(0,"timeout")};a.timeout=b.xdrTimeout||Number.MAX_VALUE;a.open(b.type,b.url);a.send((b.hasContent&&b.data)||null)},abort:function(){if(a){a.onerror=jQuery.noop;a.abort()}}}}})};;
;/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/js/project-creation.js' */
ATLAS_PROJECT_CREATE={};(function(x){AJS.EventQueue=AJS.EventQueue||[];var u="jira.project";var G={"confluence.space":30,"bamboo.project":20,"ondemand.svn-repository":10};ATLAS_PROJECT_CREATE.getFilteredRootTypes=function C(L){var N={};for(var M in L.types){if(M!==u){N[M]=L.types[M]}}return N};ATLAS_PROJECT_CREATE.loadRemoteRoots=function p(L){var N=jQuery.Deferred(),O=[],M=[];t(L,function(P){var Q=P.capabilitiesUrl;return AJS.$.ajax(Q+"/aggregate-root",{success:function(R){var S=ATLAS_PROJECT_CREATE.getFilteredRootTypes(R);O=O.concat(_.map(S,function(U,T){return AJS.$.ajax(U.href,{xhrFields:{withCredentials:true},success:function(V){M.push(ATLAS_PROJECT_CREATE.constructFullRootType(V,U.label,T,Q,P.id))},error:function(X,V,W){AJS.log("Got "+W+" from aggregate root type "+U.href)}}).promise()}))},error:function(T,R,S){AJS.log("Got "+S+" from aggregate roots capapbility for "+Q)}}).promise()}).done(function(){o(O).done(function(){N.resolve(M)})});return N.promise()};ATLAS_PROJECT_CREATE.constructFullRootType=function n(L,M,P,O,N){return{keys:L.keys,url:L.links.self,label:M,capabilityKey:P,baseUrl:O,instanceId:N}};ATLAS_PROJECT_CREATE.createLink=function v(M,L){console.log("creating link from "+M.entityType+" to "+M.remoteEntityType);var N=JSON.stringify({local:M.baseUrl+"/aggregate-root/"+M.entityType+"/"+M.entityKey,target:M.remoteInstanceBaseUrl+"/aggregate-root/"+M.remoteEntityType+"/"+M.remoteEntityKey});AJS.$.ajax(M.baseUrl+"/aggregate-root-link",{type:"POST",contentType:"application/json",data:N,timeout:8000,complete:L})};ATLAS_PROJECT_CREATE.linkAllTheThings=function r(O,R,L,T,S){var N=[];x.each(R,function Q(U,V){N.push({baseUrl:V.type.baseUrl,entityType:V.type.capabilityKey,entityKey:V.data.key,remoteInstanceBaseUrl:h()+"/rest/capabilities",remoteEntityType:u,remoteEntityKey:L});N.push({baseUrl:h()+"/rest/capabilities",entityType:u,entityKey:L,remoteInstanceBaseUrl:V.type.baseUrl,remoteEntityType:V.type.capabilityKey,remoteEntityKey:V.data.key});AJS.$.each(R,function W(Y,X){if(X!==V){N.push({baseUrl:V.type.baseUrl,entityType:V.type.capabilityKey,entityKey:V.data.key,remoteInstanceBaseUrl:X.type.baseUrl,remoteEntityType:X.type.capabilityKey,remoteEntityKey:X.data.key})}})});var P=0;function M(Y,U){if(U!=="success"){P++;var V=Y.statusText;try{var X=JSON.parse(Y.responseText);if(X&&X.message){V=X.message}}catch(W){}AJS.messages.error(".li-linking-status",{title:"Could not create links between created projects",body:V});O.updateHeight()}if(N.length>0){ATLAS_PROJECT_CREATE.createLink(N.pop(),M)}else{if(P>0){T.find(".linking-status").html('<span class="aui-icon aui-icon-small aui-iconfont-error">'+"Error"+"</span>")}else{T.find(".linking-status").html('<span class="aui-icon aui-icon-small aui-iconfont-success">'+"Success"+"</span>")}S.prop("disabled",false);S.attr("aria-disabled","false")}}M(null,"success")};var k;function I(O,L,M){var N=L();x.when(O).then(function(P){N.getCurPanel().body.find(".field-group.loading").remove();P.sort(d);if(P.length!==0){var Q=N.getCurPanel().body.find("form");Q.append(project.creation.remoteRootsCheckboxes({rootTypes:P}));if(M){Q.find('input[type="checkbox"]').filter(".remote-root").change(M)}N.updateHeight()}f(N,true)},function(){N.getCurPanel().body.find(".field-group.loading").remove();f(N,true);N.updateHeight()})}var j;function E(L,M){var N=L();j=N.getCurPanel();j.body.find("form").append(project.creation.remoteRootsLoading({}));f(N,false);N.updateHeight();j.page.element.find(".add-project-back-button").click(function(){N.updateHeight()});b(I,L,M)}function B(M){var N=_.filter(j.body.find("input.remote-root.checkbox"),function(O){return O.checked===true});var L=_.map(N,function(O){return O.id});return _.filter(M,function(O){return _.contains(L,"capability_"+O.capabilityKey)})}var F=AJS.$('meta[name="ajs-remote-user"]');if(!F||!F[0]||!F[0].content){console.log("Project create didn't get a user META tag, or it had no content.  Bailing out");return}if(!AJS.DarkFeatures.isEnabled("rotp.project.create")){return}var w=function w(Q,N,P,M,O){var L=function L(R,S){S.prop("disabled",true);S.attr("aria-disabled","true");S.before('<span class="aui-icon aui-icon-wait project-creation-acknowledge-spinner">'+"Loading, please wait"+"</span>");R()};x.when(k).then(function(S){var R=B(S);H(R);if(R.length===0){Q.prevPage();N();return}c(Q,L,N);var T=[];var U=[];t(R,function(V){var W="creation_status_"+V.capabilityKey.replace(".","_")+"_"+V.instanceId;T.push({statusId:W,label:V.label});return AJS.$.ajax(V.url+"/"+M,{type:"PUT",data:JSON.stringify({label:O}),xhrFields:{withCredentials:true},success:function(X){U=U.concat(D(X,V));i(X,W)},error:function(Y,Z,X){l(W,V,Y,X)},contentType:"application/json",dataType:"json"}).promise()}).always(function(){s(Q);console.log("about to begin linking created objects");ATLAS_PROJECT_CREATE.linkAllTheThings(Q,U,M,AJS.$(".post-project-created-page-content"),AJS.$(".project-create-acknowledge-button"))});AJS.$(".post-project-created-page-content").append(project.creation.remoteRootsSuccess({rootTypes:T}))})};var e=function e(M){var L;x.when(k).then(function(P){var O=B(P);_.each(O,function(R){if(R.keys){for(var Q in R.keys){if(R.keys.hasOwnProperty(Q)){if(M.toUpperCase()===Q.toUpperCase()){L=R}}}}})});var N={errors:{}};if(L){N.errors.projectKey=AJS.format("{0} with that key already exists in the remote instance",L.label)}return N};function m(){return window.location.origin?window.location.origin:(window.location.protocol+"//"+window.location.host)}function h(){var L=m();return L+AJS.contextPath()}function z(M){var L=document.createElement("a");L.href=M;return{host:L.hostname,port:L.port,protocol:L.protocol.replace(":","")}}function K(M,L){var O=z(M);var N=z(L);return O.protocol==="https"&&N.protocol==="http"}function b(O,M,N){AJS.$.ajax(h()+"/rest/capabilities/awareness",{type:"GET",success:function L(Q){var R=_.partial(K,m());var P=_.chain(Q.applications).map(function(T,S){return _.extend(T,{capabilitiesUrl:S})}).filter(function(S){return R(S.capabilitiesUrl)===false}).value();P.push({id:Q.links.selfInstanceId,capabilitiesUrl:Q.links.collection});k=ATLAS_PROJECT_CREATE.loadRemoteRoots(P);A=Q.links.selfInstanceId;if(typeof O==="function"){O(k,M,N)}},error:function(R,P,Q){console.log("Project create error - error gathering roots from awareness capability");if(M){x(M().getCurPanel().page.element).find(".pt-submit-button").attr("aria-disabled","false")}}})}var A;var g=null;function t(N,M){var L=_.map(N,M);return o(L)}function o(M){var L=x.Deferred();var N=0;if(M.length===0){L.resolve()}else{_.each(M,function(O){O.always(function(){N++;if(N===M.length){L.resolve()}})})}return L.promise()}function c(N,L,M){N.addPanel("title","","post-project-created-page-content");N.addHeader("Creating and linking companions for your JIRA project");N.addButton("All done!",function(){L(M,AJS.$(this))},"project-create-acknowledge-button");AJS.$(".project-create-acknowledge-button").removeClass("button-panel-button").addClass("aui-button aui-button-primary").attr("aria-disabled","true").prop("disabled",true)}function D(M,L){var N=[];if(L.capabilityKey==="ondemand.svn-repository"){console.log("got back created SVN repository");N.push({type:{capabilityKey:"fecru.repository",instanceId:g.id,baseUrl:g.capabilitiesUrl},data:{key:M.key}});N.push({type:{capabilityKey:"fecru.project",instanceId:g.id,baseUrl:g.capabilitiesUrl},data:{key:"CR-"+M.key}})}else{console.log("got back created thing "+L.capabilityKey);var O={type:L,data:M};N.push(O)}return N}function i(N,O){var M=AJS.$("."+O);M.empty();M.append('<span class="aui-icon aui-icon-small aui-iconfont-success">'+"Success"+"</span>");if(N.links.resource){var L=AJS.$("<a target='_blank'></a>");L.text(N.label);L.attr("href",N.links.resource);L.attr("title",N.label);M.closest("li").append(L)}}function l(S,M,R,Q){var O=AJS.$("."+S);O.empty();O.append('<span class="aui-icon aui-icon-small aui-iconfont-error">'+"Error"+"</span>");var L=Q;if(R&&R.responseText){try{var P=JSON.parse(R.responseText);if(P&&P.message){L=P.message}}catch(N){L=R.responseText}}AJS.messages.error(".li-"+S,{title:AJS.format("Could not create {0}",M.label),body:L})}function s(L){var M=L.getCurrentPanel();if(M.body.find(".aui-message.error").size()!==0){AJS.messages.warning(".project-creation-success",{title:"We were unable to create everything you requested",body:"<p>"+"However, you can create them yourself and manually set up links."+"</p>"});L.updateHeight()}}function H(L){var M=_.map(L,function(O){return O.capabilityKey});var N=(M.length==0)?"none":M.sort().join("_");AJS.EventQueue.push({name:"project.create.aggregateroots.selected",properties:{capabilitykeys:N}})}function f(M,L){x(M.getCurPanel().page.element).find(".pt-submit-button").attr("aria-disabled",!L)}function d(M,L){return J(L.capabilityKey)-J(M.capabilityKey)}function J(L){return _.has(G,L)?G[L]:0}JPT.AddProjectController.registerProjectKeyValidationCallback(e);var y=function y(){return JPT.DialogView.dialog||JPT.DialogView._dialog};var a=function a(){if(JPT.AddProjectView.getKey().length>=2){JPT.AddProjectController._performKeyValidationChecks(JPT.AddProjectView.getKey())}};JPT.AddProjectView.addPostDrawCallback(function(){E(y,a)});JPT.AddProjectController.registerPostProjectCreationCallback(function(P,Q,O,M,N){var L=function(){window.location=AJS.contextPath()+Q};w(P,L,O,M,N)});var q=function q(){var N="projectCreation";GH.StartWizardView.registerWizardStepPreRenderCallback(function M(Q){if(Q==N){b();GH.StartWizardView.registerWizardStepOnCreateCallbacks(function P(S,T,R){console.log("creating external entities");S.addPage("post-project-created-page");w(S,T,null,R.project.key,R.project.name)})}});GH.StartWizardView.registerWizardStepPostRenderCallback(function O(R,P){if(R==N){E(function Q(){return P});P.updateHeight()}});GH.StartWizardView.registerWizardStepOnValidateCallback(function L(U,R){if(U==N){var T=R.getCurPanel().body.find("#ghx-wizard-project-projectkey");var Q=e(T.val());if(Q.errors.projectKey){var P=AJS.$("<div class='error project-creation-error'></div>");var S=T.parent();S.find(".project-creation-error").remove();S.append(P);P.text(Q.errors.projectKey);P.show();return false}}return true})};x(function(){AJS.$(".add-project-trigger").live("click",b);if(typeof GH!=="undefined"){if(GH.StartWizardView&&GH.StartWizardView.registerWizardStepPreRenderCallback){q()}}});x(function(){AJS.$(".add-project-trigger").live("click",b)})})(jQuery);;
;/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/templates/project-creation.soy' */
// This file was automatically generated from project-creation.soy.
// Please don't edit this file by hand.

if (typeof project == 'undefined') { var project = {}; }
if (typeof project.creation == 'undefined') { project.creation = {}; }


project.creation.remoteRootsLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="field-group loading"><span class="aui-icon aui-icon-wait"/>', soy.$$escapeHtml("Retrieving additional project types you might want to create"), '</div>');
  return opt_sb ? '' : output.toString();
};


project.creation.remoteRootsCheckboxes = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<fieldset class="group remote-root-checkboxes"><h4>', soy.$$escapeHtml("Create a linked:"), '</h4><div class=\'field-group\'>');
  var rootTypeList10 = opt_data.rootTypes;
  var rootTypeListLen10 = rootTypeList10.length;
  for (var rootTypeIndex10 = 0; rootTypeIndex10 < rootTypeListLen10; rootTypeIndex10++) {
    var rootTypeData10 = rootTypeList10[rootTypeIndex10];
    output.append('<div class="checkbox"><input class="checkbox remote-root" type="checkbox" id="capability_', soy.$$escapeHtml(rootTypeData10.capabilityKey), '" checked="true" data-url="', soy.$$escapeHtml(rootTypeData10.url), '"></input><label for="capability_', soy.$$escapeHtml(rootTypeData10.capabilityKey), '">', soy.$$escapeHtml(rootTypeData10.label), '</label></div>');
  }
  output.append('</div></fieldset>');
  return opt_sb ? '' : output.toString();
};


project.creation.remoteRootsSuccess = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-creation-success"><ul>');
  var rootTypeList24 = opt_data.rootTypes;
  var rootTypeListLen24 = rootTypeList24.length;
  for (var rootTypeIndex24 = 0; rootTypeIndex24 < rootTypeListLen24; rootTypeIndex24++) {
    var rootTypeData24 = rootTypeList24[rootTypeIndex24];
    output.append('<li class="li-', soy.$$escapeHtml(rootTypeData24.statusId), '"><div class="', soy.$$escapeHtml(rootTypeData24.statusId), ' created-entity-status"><span class="aui-icon aui-icon-wait">', soy.$$escapeHtml("Loading, please wait"), '</span></div><div class="created-entity-status">', soy.$$escapeHtml(rootTypeData24.label), '</div></li>');
  }
  output.append('<li class="li-linking-status"><div class="linking-status created-entity-status"><span class="aui-icon aui-icon-wait">', soy.$$escapeHtml("Loading, please wait"), '</span></div><div class="created-entity-status">', soy.$$escapeHtml("Creating links"), '</div></li></ul></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:bamboo-soy-resources', location = 'templates/plugins/bamboo/components.soy' */
// This file was automatically generated from components.soy.
// Please don't edit this file by hand.

if (typeof bamboo == 'undefined') { var bamboo = {}; }
if (typeof bamboo.components == 'undefined') { bamboo.components = {}; }


bamboo.components.pageHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param3 = new soy.StringBuilder();
  if (opt_data.headerImageContent) {
    aui.page.pageHeaderImage({content: opt_data.headerImageContent}, param3);
  }
  aui.page.pageHeaderMain({content: opt_data.headerMainContent}, param3);
  if (opt_data.headerActionsContent) {
    aui.page.pageHeaderActions({content: opt_data.headerActionsContent}, param3);
  }
  aui.page.pageHeader({content: param3.toString()}, output);
  return opt_sb ? '' : output.toString();
};


bamboo.components.icon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="bamboo-icon bamboo-icon-', soy.$$escapeHtml(opt_data.type), '"', (opt_data.text && opt_data.showTitle) ? ' title="' + soy.$$escapeHtml(opt_data.text) + '"' : '', '>', (opt_data.text) ? '<span>' + soy.$$escapeHtml(opt_data.text) + '</span>' : '', '</span>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.buildDetail = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt class="', soy.$$escapeHtml(opt_data.keyClass), '">', soy.$$escapeHtml(opt_data.key), '</dt><dd>', opt_data.value, '</dd></dl>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.artifacts = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul id="shared-artifacts">');
  var artifactList42 = opt_data.artifacts;
  var artifactListLen42 = artifactList42.length;
  for (var artifactIndex42 = 0; artifactIndex42 < artifactListLen42; artifactIndex42++) {
    var artifactData42 = artifactList42[artifactIndex42];
    bamboo.components.artifactItem(soy.$$augmentData(artifactData42, {id: artifactData42.name, url: artifactData42.link.href}), output);
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.artifactItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li>');
  bamboo.components.icon({type: 'artifact-shared'}, output);
  output.append(' <a class="artifact-link" id="artifact-', soy.$$escapeHtml(opt_data.id), '" href="', soy.$$escapeHtml(opt_data.url), '" title="', soy.$$escapeHtml(opt_data.name), '">', soy.$$escapeHtml(opt_data.name), '</a><span class="filesize">(', soy.$$escapeHtml(opt_data.prettySizeDescription), ')</span></li>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.labels = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="labels">');
  var labelList65 = opt_data.labels;
  var labelListLen65 = labelList65.length;
  for (var labelIndex65 = 0; labelIndex65 < labelListLen65; labelIndex65++) {
    var labelData65 = labelList65[labelIndex65];
    bamboo.components.labelItem(soy.$$augmentData(labelData65, {url: opt_data.baseBambooUrl + '/browse/label/' + labelData65.name}), output);
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.labelItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li><a class="lozenge" href="', soy.$$escapeHtml(opt_data.url), '" title="', soy.$$escapeHtml(opt_data.name), '"><span>', soy.$$escapeHtml(opt_data.name), '</span></a></li>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.errorResponseMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  bamboo.components.auiWarning({body: (opt_data.errorMessage.messageBody) ? '<p>' + soy.$$escapeHtml(opt_data.errorMessage.messageBody) + '</p>' : (opt_data.errorMessage.oauthCallback) ? '<p><a href="' + opt_data.errorMessage.oauthCallback + '&amp;redirectUrl=' + opt_data.oAuthDanceReturnUrl + '">' + soy.$$escapeHtml("Log in \x26 approve") + '</a></p>' : '<p>' + soy.$$escapeHtml(opt_data.errorMessage.message) + '</p>'}, output);
  return opt_sb ? '' : output.toString();
};


bamboo.components.auiWarning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message warning"><span class="aui-icon icon-warning"></span>', opt_data.body, '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/store-1.3.1.js' */
(function(){var l={},h=window,k=h.document,c="localStorage",n="globalStorage",d="__storejs__",g;l.disabled=false;l.set=function(e,o){};l.get=function(e){};l.remove=function(e){};l.clear=function(){};l.transact=function(e,o){var p=l.get(e);if(typeof p=="undefined"){p={}}o(p);l.set(e,p)};l.serialize=function(e){return JSON.stringify(e)};l.deserialize=function(e){if(typeof e!="string"){return undefined}return JSON.parse(e)};function b(){try{return(c in h&&h[c])}catch(e){return false}}function m(){try{return(n in h&&h[n]&&h[n][h.location.hostname])}catch(e){return false}}if(b()){g=h[c];l.set=function(e,o){if(o===undefined){return l.remove(e)}g.setItem(e,l.serialize(o))};l.get=function(e){return l.deserialize(g.getItem(e))};l.remove=function(e){g.removeItem(e)};l.clear=function(){g.clear()}}else{if(m()){g=h[n][h.location.hostname];l.set=function(e,o){if(o===undefined){return l.remove(e)}g[e]=l.serialize(o)};l.get=function(e){return l.deserialize(g[e]&&g[e].value)};l.remove=function(e){delete g[e]};l.clear=function(){for(var e in g){delete g[e]}}}else{if(k.documentElement.addBehavior){var j,f;try{f=new ActiveXObject("htmlfile");f.open();f.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></frame>');f.close();j=f.w.frames[0].document;g=j.createElement("div")}catch(i){g=k.createElement("div");j=k.body}function a(e){return function(){var p=Array.prototype.slice.call(arguments,0);p.unshift(g);j.appendChild(g);g.addBehavior("#default#userData");g.load(c);var o=e.apply(l,p);j.removeChild(g);return o}}l.set=a(function(p,e,o){if(o===undefined){return l.remove(e)}p.setAttribute(e,l.serialize(o));p.save(c)});l.get=a(function(o,e){return l.deserialize(o.getAttribute(e))});l.remove=a(function(o,e){o.removeAttribute(e);o.save(c)});l.clear=a(function(q){var o=q.XMLDocument.documentElement.attributes;q.load(c);for(var p=0,e;e=o[p];p++){q.removeAttribute(e.name)}q.save(c)})}}}try{l.set(d,d);if(l.get(d)!=d){l.disabled=true}l.remove(d)}catch(i){l.disabled=true}if(typeof module!="undefined"){module.exports=l}else{if(typeof define==="function"&&define.amd){define(l)}else{this.store=l}}})();;
;/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/atlassian-analytics.js' */
(function(f){var j=AJS.$.ajax;var h="atlassian-analytics";var e=typeof AJS.contextPath=="function"?AJS.contextPath():typeof AJS.Confluence!="undefined"?AJS.Confluence.getContextPath():window.contextPath!=null?window.contextPath:"";var d=null;var m=null;var c=null;var b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var s=Math.random()*16|0,q=t=="x"?s:(s&3|8);return q.toString(16)});var a=function(){var q="unknown";if(document.body.id=="jira"){q="jira"}else{if(document.body.id=="com-atlassian-confluence"){q="confluence"}}m=h+"."+q;c=m+".lock"};var o=function(){if(store.get(c)){return false}store.set(c,b);return(store.get(c)===b)};var k=function(){store.set(c,null)};var g=function(){var r=[],t,u,q,s;if(AJS.EventQueue.length==0){return}r=store.get(m)||r;for(q=0,s=AJS.EventQueue.length;q<s;++q){u=AJS.EventQueue[q];if(u.name){t={name:u.name,properties:u.properties,time:u.time||0};r.push(t)}}AJS.EventQueue.length=0;store.set(m,r)};var l=function(){var r;if(!o()){return}g();r=store.get(m);if(r&&r.length){store.remove(m);k();var s=new Date().getTime();for(var q=0;q<r.length;q++){if(r[q].time>0){r[q].timeDelta=r[q].time-s}else{r[q].timeDelta=q-r.length}delete r[q].time}d=j({type:"POST",url:e+"/rest/analytics/1.0/publish/bulk",data:JSON.stringify(r),contentType:"application/json",dataType:"json"});d.fail(function(){AJS.EventQueue.concat(r);g()})}else{k()}};var n=function(){if(d&&!(d.state()==="resolved"||d.state()==="rejected")){d.abort()}};AJS.EventQueue=AJS.EventQueue||[];var i=Array.prototype.push;AJS.EventQueue.push=function(q){q.time=new Date().getTime();i.call(AJS.EventQueue,q)};AJS.toInit(function(){a();setTimeout(l,500);setInterval(l,5000);p()});f(window).unload(function(){n();g()});AJS.Analytics={triggerPrivacyPolicySafeEvent:function(q,r){AJS.EventQueue.push({name:q,properties:r})}};AJS.bind("analytics",function(q,r){AJS.EventQueue.push({name:r.name,properties:r.data})});AJS.bind("analyticsEvent",function(q,r){AJS.EventQueue.push({name:r.name,properties:r.data})});var p=function(){if(window.location.pathname.indexOf("/secure/admin/ViewApplicationProperties")>-1){AJS.$("[data-property-id='analytics-enabled']").remove()}else{if(window.location.pathname.indexOf("/secure/admin/EditApplicationProperties")>-1){var r=AJS.$(":contains(Enable Atlassian analytics)");if(r.size()>0){var q=r[r.size()-2];if(q){q.remove()}}}}}}(AJS.$));;
;/* module-key = 'com.atlassian.analytics.analytics-client:policy-update', location = 'js/policy-update.js' */
;
;/* module-key = 'com.atlassian.jira.jira-issue-link-web-plugin:issue-link-web-link', location = 'js/issuelink-weblink.js' */
(function(){var $hiddenImg=AJS.$("<img>"),$iconUrlInput,$urlInput,faviconUrl,throbberTimeoutId;$hiddenImg.load(function(){$iconUrlInput.val(faviconUrl);$urlInput.css("background-image",'url("'+faviconUrl+'")');clearTimeout(throbberTimeoutId);$urlInput.removeClass("loading")});$hiddenImg.error(function(){clearTimeout(throbberTimeoutId);$urlInput.removeClass("loading")});function init(context){$iconUrlInput=AJS.$("#web-link-icon-url",context);$urlInput=AJS.$("#web-link-url",context).bind("change",fetchFavicon);if($iconUrlInput.val()){$urlInput.css("background-image","url("+$iconUrlInput.val()+")")}}function fetchFavicon(){$hiddenImg.attr("src","");$iconUrlInput.val("");$urlInput.css("background-image","");faviconUrl=parseFaviconUrl($urlInput.val());if(!faviconUrl){return }setTimeout(function(){$urlInput.addClass("loading")},0);throbberTimeoutId=setTimeout(function(){$urlInput.removeClass("loading")},3000);$hiddenImg.attr("src",faviconUrl)}function parseFaviconUrl(url){var hostUrl=url.match(/^([^/]*\/\/[^/]+)/)[1];if(!hostUrl){return }return hostUrl+"/favicon.ico"}JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(e,context){init(context)})})();;
;/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:issue-link-confluence-js', location = 'js/issuelink-confluence.js' */
(function($){var settings={getCurrentAppId:function(context){return $("#issue-link-confluence-app-id",context).val()},shouldExecute:function(context){return $("#confluence-page-link",context).length!==0},getIssueId:function(context){return $("input[name=id]",context).val()}};JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(e,context){IssueLinkAppLinks.init(settings,context)})})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:confluence-page-resource', location = 'js/ConfluencePageSearch.js' */
AJS.$(function($){var confluenceSearchDialog=new JIRA.FormDialog({id:"confluence-page-search-dialog",trigger:"#confluence-page-link .confluence-search-trigger",widthClass:"large",height:"565px",content:function(render){var dialog=this;JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/confluenceIssueLink/1/confluence/applink",complete:function(xhr,textStatus,smartAjaxResult){if(smartAjaxResult.successful){var appLinks=smartAjaxResult.data.applicationLinks;render(JIRA.Templates.ConfluencePageSearch.result({appLinks:appLinks}));initAppLinks(dialog).done(function(context,helper){initSearchDialog(context,helper);$("#link-search-text",context).focus()})}else{AJS.messages.error("#search-results-table",{body:"The JIRA server could not be contacted. This may be a temporary glitch or the server may be down.",closeable:false});render()}}})},submitHandler:function(e,callback){e.preventDefault();$("#search-panel-button").click().removeAttr("disabled");callback()}});function initSearchDialog($dialog,helper){$("#confluence-app-link",$dialog).change(function(){var authenticationRequired=helper.selectServer($(this).val()).authenticationRequired;if(!authenticationRequired){populateSpaces($dialog,$(this).val(),helper)}$("#search-results-table",$dialog).empty();setSearchControlsEnabled(true,$dialog)});$("#search-panel-button",$dialog).click(function(){$("#search-results-table",$dialog).empty();var searchText=$("#link-search-text",$dialog).val();searchText=$.trim(searchText);if(searchText){doSearch(searchText,$dialog)}else{AJS.messages.info("#search-results-table",{body:"Please enter search value.",closeable:false})}return false})}var spaceAjaxId=0;function populateSpaces($context,appId,helper){$("select#search-panel-space",$context).html(JIRA.Templates.ConfluencePageSearch.allSpacesOption());var myAjaxId=++spaceAjaxId;JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/confluenceIssueLink/1/confluence/space?appId="+appId,complete:function(xhr,textStatus,smartAjaxResult){if(myAjaxId!==spaceAjaxId){return }if(smartAjaxResult.successful){var spaces=smartAjaxResult.data.spaces;$("select#search-panel-space",$context).html(JIRA.Templates.ConfluencePageSearch.spaceOptions({spaces:spaces}))}else{if(smartAjaxResult.status===401){helper.setAuthenticationRequired(appId,true)}else{setSearchControlsEnabled(false,$context);var msg;if(smartAjaxResult.status===403){msg="Content on the Confluence site could not be accessed because the Confluence server\'s \'Remote API\' feature is disabled. The Confluence system administrator must enable this \'Remote API\' feature for JIRA to successfully access this content."}else{msg="Unable to gather information from the selected Confluence instance."}AJS.messages.error("#search-results-table",{body:msg,closeable:false})}}}})}function setSearchControlsEnabled(enabled,$context){if(enabled){$("#link-search-text",$context).removeAttr("disabled");$("#search-panel-space",$context).removeAttr("disabled");$("#search-panel-button",$context).removeAttr("disabled")}else{$("#link-search-text",$context).attr("disabled","disabled");$("#search-panel-space",$context).attr("disabled","disabled");$("#search-panel-button",$context).attr("disabled","disabled")}}function setLoadingIconVisible(visible,$context){$("#link-search-loading",$context).toggleClass("hidden",!visible)}function doSearch(searchText,$context){setLoadingIconVisible(true,$context);var appLinkId=$("#confluence-app-link",$context).val();var spaceKey=$("#search-panel-space option:selected",$context).val();JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/confluenceIssueLink/1/confluence/search?query="+searchText+"&appId="+appLinkId+"&spaceKey="+spaceKey+"&maxResults=10",complete:function(xhr,textStatus,smartAjaxResult){setLoadingIconVisible(false,$context);if(smartAjaxResult.successful){var results=smartAjaxResult.data.result;var resultHtml=JIRA.Templates.ConfluencePageSearch.resultsTable({results:results});$("#search-results-table",$context).html(resultHtml)}else{var msg;if(smartAjaxResult.hasData){msg="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."}else{msg="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down."}AJS.messages.error("#search-results-table",{body:msg,closeable:false})}$("#confluence-searchresult tbody tr",$context).click(function(){var linkUrl=$(this).children().first().data("url");$("#confluence-page-url").val(linkUrl);$("#link-issue-dialog .error").hide();confluenceSearchDialog.hide();$("#link-issue-dialog").show();$("#confluence-page-url").focus().select()})}})}function initAppLinks(dialog){var settings={getCurrentAppId:function(context){return $("#confluence-app-link",context).val()},shouldExecute:function(context){return $("#confluence-app-link",context).length!==0},onAuthenticationSuccessCallback:function(context,currentAppId,helper){populateSpaces(context,currentAppId,helper)},getIssueId:function(context){return $("#confluence-page-link input[name=id]").val()}};return IssueLinkAppLinks.init(settings,dialog.$popup).done(function(context,helper){populateSpaces(context,settings.getCurrentAppId(context),helper)})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:confluence-page-resource', location = 'templates/dialog/searchresult.soy' */
// This file was automatically generated from searchresult.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ConfluencePageSearch == 'undefined') { JIRA.Templates.ConfluencePageSearch = {}; }


JIRA.Templates.ConfluencePageSearch.result = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Find a Confluence page"), '</h2><form class="aui search-form" id="confluence-page-search-form" action="#" method="post"><div class="field-group"><label for="confluence-app-link">', soy.$$escapeHtml("Server"), ':</label>');
  if (opt_data.appLinks.length == 1) {
    output.append('<span class="field-value">', soy.$$escapeHtml(opt_data.appLinks[0].name), '</span><input id="confluence-app-link" class="hidden" type="hidden" name="appId" value="', soy.$$escapeHtml(opt_data.appLinks[0].id), '"/>');
  } else {
    output.append('<select id="confluence-app-link" class="select medium-field" name="appId">');
    var appLinkList17 = opt_data.appLinks;
    var appLinkListLen17 = appLinkList17.length;
    for (var appLinkIndex17 = 0; appLinkIndex17 < appLinkListLen17; appLinkIndex17++) {
      var appLinkData17 = appLinkList17[appLinkIndex17];
      output.append('<option value="', soy.$$escapeHtml(appLinkData17.id), '">', soy.$$escapeHtml(appLinkData17.name), '</option>');
    }
    output.append('</select>');
  }
  output.append('</div><div class="issue-link-applinks-authentication-message applinks-message-bar"></div><div class="hidden"><input class="issue-link-applinks-application-type" type="hidden" value="com.atlassian.applinks.api.application.confluence.ConfluenceApplicationType"/></div><div class="issue-link-oauth-toggle field-group"><label for="link-search-text" id="linkSearch-label">', soy.$$escapeHtml("Search"), ':</label><input id="link-search-text" type="text" tabindex="0" class="text" name="linkSearch" size="50" /> <select tabindex="0" class="search-space select" id="search-panel-space"><option value="">', soy.$$escapeHtml("All Spaces"), '</option></select> <input type="submit" tabindex="0" class="aui-button" id="search-panel-button" value="', soy.$$escapeHtml("Search"), '"/><span id="link-search-loading" class="icon loading throbber hidden"/></div><div class="message-panel hidden"></div><div id="search-results-table" class="data-table"></div><div class="buttons-container form-footer"><div class="buttons"><button class="aui-button aui-button-link cancel" id="confluence-link-cancel" title="', soy.$$escapeHtml("Press Esc to close"), '">', soy.$$escapeHtml("Close"), '</button></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.resultsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.results.length > 0) {
    output.append('<table id="confluence-searchresult" class="aui"><thead><tr><th width="180px">', soy.$$escapeHtml("Title"), '</th><th width="550px">', soy.$$escapeHtml("Excerpt"), '</th></tr></thead><tbody>');
    var resultList44 = opt_data.results;
    var resultListLen44 = resultList44.length;
    for (var resultIndex44 = 0; resultIndex44 < resultListLen44; resultIndex44++) {
      var resultData44 = resultList44[resultIndex44];
      output.append('<tr title="', soy.$$escapeHtml(resultData44.title), '"><td class="title" data-url="', soy.$$escapeHtml(resultData44.url), '">', soy.$$escapeHtml(resultData44.title), '</td><td class="excerpt">', soy.$$escapeHtml(resultData44.excerpt), '</td></tr>');
    }
    output.append('</tbody></table>');
  } else {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml("Search returned no results."), '</p></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.spaceOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option value="">', soy.$$escapeHtml("All Spaces"), '</option>');
  var spaceList64 = opt_data.spaces;
  var spaceListLen64 = spaceList64.length;
  for (var spaceIndex64 = 0; spaceIndex64 < spaceListLen64; spaceIndex64++) {
    var spaceData64 = spaceList64[spaceIndex64];
    output.append('<option value="', soy.$$escapeHtml(spaceData64.key), '">', soy.$$escapeHtml(spaceData64.name), '</option>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.allSpacesOption = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option value="">', soy.$$escapeHtml("All Spaces"), '</option><option value="" disabled="disabled">', soy.$$escapeHtml("Loading..."), '</option>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-analytics-tracker', location = 'includes/js/rapid/AnalyticsTracker.js' */
if(typeof GH==="undefined"){window.GH={}}GH.AnalyticsTracker=function(b,d,a){if(_.isUndefined(b)){throw new Error("You must specify a category")}this.params={};this.params.category=b;var c=0;if(!_.isUndefined(d)){this.params.action=d;c++;if(!_.isUndefined(a)){this.params.label=a;c++}}this.requiredArgumentNames=["action","label","value"].slice(c);this.useAsync=true};GH.AnalyticsTracker.prototype.setAsync=function(a){this.useAsync=a;return this};GH.AnalyticsTracker.prototype.trigger=function(){if(this.requiredArgumentNames.length<arguments.length){AJS.log("Warning: too many arguments passed in. Needed at most "+this.requiredArgumentNames.length+" but got "+arguments.length)}var c=_.clone(this.params);for(var b=0;b<arguments.length&&!_.isUndefined(this.requiredArgumentNames[b]);b++){c[this.requiredArgumentNames[b]]=arguments[b]}this._validateParams(c);var a="gh.analytics.async";AJS.$(AJS).trigger(a,c)};GH.AnalyticsTracker.prototype._validateParams=function(b){var a=["category","action","label"];_.each(a,function(c){if(!_.isUndefined(b[c])&&!_.isString(b[c])){b[c]=b[c].toString()}else{if(_.isUndefined(b[c])){b[c]=""}}});_.each(["category","action"],function(c){b[c]=b[c].replace(/\s+/g,"")});if(!_.isUndefined(b.value)){b.value=parseInt(b.value,10);if(isNaN(b.value)){b.value=undefined}}};;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-help-analytics', location = 'includes/js/rapid/ui/help/HelpAnalytics.js' */
AJS.$(function(){var a=function(c){if(GH&&GH.AnalyticsTracker){return new GH.AnalyticsTracker(c).setAsync(false)}else{return{trigger:function(){}}}};AJS.$("#gh_view_help").click(function(c){a("gh.gethelp").trigger("usermenu","docs");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-enablement").click(function(c){a("gh.myjirahome").trigger("usermenu","enabled");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-enablement-ondemand").click(function(c){a("gh.myjirahome").trigger("usermenu","set");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-disablement-ondemand").click(function(c){a("gh.myjirahome").trigger("usermenu","disable");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-set").click(function(c){a("gh.myjirahome").trigger("usermenu","set");return b(AJS.$(this))});AJS.$("#beta_gh\\.configuration\\.rapid\\.removal").click(function(f){var c=AJS.$(this),d=c.attr("checked")?"on":"off";a("gh.labs.feature").trigger("rapid_removal",d);return true});AJS.$(document).delegate("#js-classic-link_lnk","click",function(c){a("gh.agile.menu").trigger("classic");return true});var b=function(c){if(c.attr("target")=="_blank"){return true}else{setTimeout('document.location = "'+c.attr("href")+'"',100);return false}}});;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-help-analytics', location = 'includes/js/rapid/Analytics.js' */
if(typeof GH==="undefined"){window.GH={}}(function(c,g,e,d){d.AnalyticsEnabled=true;var b="gh.analytics.async";function f(){g(document).on(b,function(i,h){a(h)})}function a(i){var j={};var h=i.category;if(!e.isUndefined(i.action)){h=h+"."+i.action}if(!e.isUndefined(i.label)){j.label=i.label}if(!e.isUndefined(i.value)){j.value=i.value}c.trigger("analytics",{name:h,data:j})}f()})(AJS,AJS.$,_,GH);;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-globalissueoperations', location = 'includes/js/gh-globalissueoperations.js' */
(function(){var c=new GH.AnalyticsTracker("gh.issueaction.gotorapidboard").setAsync(false);var b=JIRA.FormDialog.extend({_performRedirect:function(e){c.trigger("direct");window.location.href=e}});var d=new b({id:"gh-rapidboard-dialog",trigger:"a.issueaction-greenhopper-rapidboard-operation",ajaxOptions:function(){return JIRA.Dialogs.getDefaultAjaxOptions.apply(this,arguments)}});var a=function(f,g){var h="";var e=AJS.$(f);if(e.hasClass("js-rapidboard-operation-sprint")){h="sprint."}else{if(e.hasClass("js-rapidboard-operation-issue")){h="issue."}}h+=g;return h};AJS.$(function(){AJS.$(document).on("simpleClick",".issueaction-greenhopper-rapidboard-operation",function(f){f.preventDefault();var e=a(f.currentTarget,"open");c.trigger(e);d.show()});AJS.$(document).on("simpleClick",".js-select-rapidboard",function(f){var e=a(f.currentTarget,"chosen");c.trigger(e)})})})();;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/gh-namespace.js' */
if(typeof GH!=="object"){window.GH={}}GH.namespace=function(d,c,e){var f=d.split(".");c=c||window;for(var b=0,g=f.length-1;b<g;b++){var a=c[f[b]];c=(a!=null)?a:c[f[b]]={}}c[f[b]]=e||c[f[b]]||{};return c[f[b]]};;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/initFieldPickers.js' */
(function(c){function b(d){c(".js-epic-picker",d).each(function(){var f=c(this);var e=new JIRA.EpicPicker({element:f});c(document).trigger(JIRA.EpicPicker.READY_EVENT,e)})}function a(d){c(".js-sprint-picker",d).each(function(){var f=c(this);var e=new JIRA.SprintPicker({element:f});c(document).trigger(JIRA.SprintPicker.READY_EVENT,e)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(g,d,f){if(f!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){b(d);a(d)}})})(AJS.$);;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/EpicPicker.js' */
JIRA.EpicPicker=AJS.SingleSelect.extend({init:function(n){var f=n.element;var c;var m=this;AJS.$.extend(n,{submitInputVal:true,showDropdownButton:true,removeDuplicates:true,ajaxOptions:{url:contextPath+"/rest/greenhopper/1.0/epics",query:true,data:b,formatResponse:d,error:i}});g();function b(o){return{searchQuery:o,projectKey:AJS.$(f).attr("data-project-key"),maxResults:10}}function k(u,p,r){u=AJS.escapeHTML(String(u));p=AJS.escapeHTML(String(p));r=AJS.escapeHTML(String(r));var v=r.toUpperCase();var q=u.toUpperCase();var w=p.toUpperCase();var v=(v+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1");var o=new RegExp("("+v+")","gi");var s=q.search(o);var t;if(s>-1){t=u.slice(s,s+r.length);u=u.replace(t,"<em>"+t+"</em>")}s=w.search(o);if(s>-1){t=p.slice(s,s+r.length);p=p.replace(t,"<em>"+t+"</em>")}return u+" - ("+p+")"}function d(p){if(!p.epicNames){return[]}var r=[];var q=p.epicNames;var v;var u=m.getQueryVal();var t=a(u.length,q.length,p.total);for(var s=0,o=q.length;s<o;s++){v=q[s];t.addItem(j(v,u))}r.push(t);return r}function j(r,q){var p=r.key;var s=r.name;var o=k(s,p,q);return new AJS.ItemDescriptor({value:"key:"+p,fieldText:s,label:o,html:o,allowDuplicate:false,highlighted:true})}function a(o,q,p){return new AJS.GroupDescriptor({weight:1,id:"epic-names",label:o===0?"Suggestions":AJS.format("Showing {0} of {1} matching epics",q,p),replace:true})}function i(q,r,p){var o=AJS.$(f);o.siblings(".ghx-error").remove();o.before(GH.tpl.rapid.notification.renderAuiMessage({message:("Error"+": "+p),type:"error",className:"ghx-error aui-ss"}))}function h(q){var o="";var p=false;if(q&&q.length>0){o=AJS.format("Epic with key \'\'{0}\'\' does not exist.",q);p=true}return{isError:p,message:o}}function l(p){var o,q;c.apply(m,[p]);p=p||AJS.$.trim(m.$field.val());q=m.model.getDescriptor(p);if(!q&&m.$container.hasClass("aui-ss-editing")){o=h(p);if(o.isError){m.options.errorMessage=o.message;m.showErrorMessage(p)}else{m.hideErrorMessage()}}}function e(){AJS.$(m.$field[0].form).submit()}function g(){m._super(n);c=m.handleFreeInput;m.handleFreeInput=l}}});JIRA.EpicPicker.READY_EVENT="gh.epic-picker.ready";;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintPicker.js' */
JIRA.SprintPicker=AJS.SingleSelect.extend({init:function(f){var n={ACTIVE:"ACTIVE",FUTURE:"FUTURE",CLOSED:"CLOSED"};var j=10;var b=f.element;var l,o;var u=b.data("saved-state"),t=b.data("saved-id");var h,q=this;var e=AJS.SelectSuggestHandler.extend({formatSuggestions:function(x,y){x=this._super(x,y);if(y.length===0){x[x.length-1].footerText("Start typing for sprints.")}return x}});AJS.$.extend(f,{submitInputVal:false,showDropdownButton:true,removeOnUnSelect:false,maxInlineResultsDisplayed:j,ajaxOptions:{url:contextPath+"/rest/greenhopper/1.0/sprint/picker",query:true,formatResponse:v,error:s}});p();function i(y){var x=l.apply(this,arguments);x.find("a").append(GH.tpl.customfields.sprintpicker.renderSuggestionMeta(y.properties));return x}function w(z){var y=this.getSelectedDescriptor(),x;if(!z&&!y){c(null)}k();this.hideErrorMessage();if(!y){x=d(z)}else{x=r(y)}if(x.message){this.options.errorMessage=x.message;o.apply(this,arguments);this.$errorMessage.addClass("inline-edit-error")}if(x.needsScopeChangeWarning){m()}}function d(z){var y=null,x=false;if(z&&z.length>0){if(u){y=AJS.format("{0} is not a valid sprint name. This issue will be returned to the backlog.",z);if(u===n.ACTIVE){x=true}}else{y=AJS.format("{0} is not a valid sprint name.",z)}}else{if(u===n.ACTIVE){x=true}}return{message:y,needsScopeChangeWarning:x}}function r(y){var x=false;if(u===n.ACTIVE){if(t!=y.properties.value){x=true}}else{if(u===n.FUTURE){if(y.properties.stateKey===n.ACTIVE){x=true}}else{if(!u){if(y.properties.stateKey===n.ACTIVE){x=true}}}}return{message:null,needsScopeChangeWarning:x}}function m(){if(!h){h=AJS.$(GH.tpl.rapid.notification.renderAuiMessage({type:"warning",className:"ghx-sprint-picker-scope-warning",icon:true,title:"Sprint scope will be affected by this action."}));var x=q.$container.closest(".inline-edit-fields");if(x.size()>0){x.closest(".editable-field").append(h)}else{q.$container.closest(".field-group").append(h)}}h.show()}function k(){if(h){h.remove();h=null}}function v(x){if(!x.suggestions&&!x.allMatches){return[]}var z=new AJS.GroupDescriptor({weight:0,label:"Suggestions"});var y=new AJS.GroupDescriptor({weight:1,label:"All sprints"});_.each(a(x.suggestions),function(A){z.addItem(g(A,true))});_.each(a(x.allMatches),function(A){y.addItem(g(A,false))});return[z,y]}function g(z,y){var x=AJS.escapeHTML(String(z.name));return new AJS.ItemDescriptor({value:z.id.toString(),label:z.name,html:x,stateKey:z.stateKey,boardName:z.boardName,allowDuplicate:false,isSuggestion:y})}function a(x){return _.sortBy(x,function(y){return y.name.toLowerCase()})}function c(x){if(GH.SprintConfig){AJS.$(GH).trigger("QuickEdit.fieldChange",{fieldId:GH.SprintConfig.getSprintFieldId(),fieldChangeData:{original:t,updated:x?x.properties.value:null}})}}function p(){q._super(f);l=q.listController._renders.suggestion;o=q.showErrorMessage;q.listController._renders.suggestion=i;q.showErrorMessage=w;b.bind("selected",function(z,y,x){x.showErrorMessage(x.getQueryVal());c(y)});q.suggestionsHandler=new e(q.options,q.model)}function s(y,A,z){var x=AJS.$(b);x.siblings(".ghx-error").remove();x.before(GH.tpl.rapid.notification.renderAuiMessage({message:("Error"+": "+z),type:"error",className:"ghx-error aui-ss"}))}}});JIRA.SprintPicker.READY_EVENT="gh.sprint-picker.ready";;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintPicker.soy' */
// This file was automatically generated from SprintPicker.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.customfields == 'undefined') { GH.tpl.customfields = {}; }
if (typeof GH.tpl.customfields.sprintpicker == 'undefined') { GH.tpl.customfields.sprintpicker = {}; }


GH.tpl.customfields.sprintpicker.renderSuggestionMeta = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.boardName && ! opt_data.isSuggestion) {
    output.append('<span class=\'ghx-sprint-picker-meta\'> (');
    GH.tpl.customfields.sprintpicker.renderMetaWithBoardName(opt_data, output);
    output.append(')</span>');
  } else {
    output.append('<span class=\'ghx-sprint-picker-meta\'> (');
    GH.tpl.customfields.sprintpicker.renderMetaWithoutBoardName(opt_data, output);
    output.append(')</span>');
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintpicker.renderMetaWithoutBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml("Active sprint") : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml("Future sprint") : '');
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintpicker.renderMetaWithBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml(AJS.format("Active sprint in {0}",opt_data.boardName)) : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml(AJS.format("Future sprint in {0}",opt_data.boardName)) : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/rapid/ui/notification/Notification.js' */
GH.namespace("GH.Notification");GH.Notification={};GH.Notification.autoHideEnabled=true;GH.Notification.showErrors=function(d,a){var b=GH.Notification.prepareNotificationDiv();var c=GH.tpl.rapid.notification.renderErrorMessages(d);if(typeof a=="undefined"){a=true}AJS.messages.error(b,{title:"Error",body:c,closeable:a});if(GH.Notification._divStyle(b)){b.css(GH.Notification._divStyle(b))}b.show()};GH.Notification.showWarnings=function(f,e){var b={autoHide:true,autoHideDelay:5000,preRendered:false,showTitle:false};e=_.extend({},b,e);var c=GH.Notification.prepareNotificationDiv();var a;if(!e.preRendered){a=GH.tpl.rapid.notification.renderErrorMessages({errors:f})}else{a=f}var d={body:a,closeable:true};if(e.showTitle){d.title="Warning"}AJS.messages.warning(c,d);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();if(e.autoHide&&GH.Notification.autoHideEnabled){setTimeout(function(){c.hide()},e.autoHideDelay)}};GH.Notification.showWarning=function(b){var a=GH.Notification.prepareNotificationDiv();AJS.messages.warning(a,{body:b,closeable:true});if(GH.Notification._divStyle(a)){a.css(GH.Notification._divStyle(a))}a.show()};GH.Notification.clear=function(){GH.Notification.prepareNotificationDiv().hide()};GH.Notification.handleDateFormatMismatchError=function(c){var b='<a href="'+GH.Ajax.CONTEXT_PATH+'/secure/admin/AdvancedApplicationProperties.jspa">';b+="Advanced Settings";b+="</a>";var a=AJS.format("It appears your JIRA date format settings are misconfigured. Please check the {0} and ensure that \'\'jira.date.time.picker.java.format\'\' and \'\'jira.date.time.picker.javascript.format\'\' have matching output.",b);GH.Notification.showWarnings(a,{autoHide:false,preRendered:true})};GH.Notification.auiMessage=function(b){var a=_.extend({type:"generic",icon:true,messageHtml:false},b);return GH.tpl.rapid.notification.renderAuiMessage({type:a.type,title:a.title,icon:a.icon,messageHtml:a.messageHtml,message:a.message})};GH.Notification.Handler={_defaultNotificationHandler:function(){var a=AJS.$("<div/>");AJS.$(".global-msg").remove();a.addClass("global-msg").appendTo("body");return a},_defaultDivStyleHandler:function(a){return{marginLeft:-a.outerWidth()/2,top:20}},setCustomDivStyleHandler:function(a){this._customDivStyleHandler=a;this._useDefault=false},_useDefault:true,setCustomNotificationHandler:function(a){this._customNotificationHandler=a;this._useDefault=false},removeCustomHandlers:function(){this._useDefault=true},getNotificationHandler:function(){if(!this._useDefault&&this._customNotificationHandler!=null){return this._customNotificationHandler}else{return this._defaultNotificationHandler}},getDivStyleHandler:function(){if(!this._useDefault&&this._customDivStyleHandler!=null){return this._customDivStyleHandler}else{return this._defaultDivStyleHandler}}};GH.Notification._divStyle=function(b){var a=GH.Notification.Handler.getDivStyleHandler();return a(b)};GH.Notification.prepareNotificationDiv=function(){var a=GH.Notification.Handler.getNotificationHandler();return a()};GH.Notification.showSuccess=function(d,b){clearTimeout(GH.Notification.current);var a={timeout:5000,closeable:true,shadowed:true};b=_.extend(a,b,{body:d});var c=GH.Notification.prepareNotificationDiv();AJS.messages.success(c,b);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();if(GH.Notification.autoHideEnabled){GH.Notification.current=setTimeout(function(){AJS.$(".global-msg").hide()},b.timeout)}};GH.Notification.showIssueMessage=function(d){var c=JIRA.SessionStorage;var b=null;var a=null;if(!d){d=c.getItem("selectedIssueId")}if(d){a=c.getItem("selectedIssueKey");b=c.getItem("selectedIssueMsg");GH.Notification.showIssueMessageImpl(d,b,a)}c.removeItem("selectedIssueId");c.removeItem("selectedIssueKey");c.removeItem("selectedIssueMsg")};GH.Notification.showIssueMessageImpl=function(d,c,a){if(!c){c="thanks_issue_updated"}var b=AJS.params[c];if(b&&a){b=AJS.format(b,a);GH.Notification.showSuccess(b)}};GH.Notification.addPageLoadMessage=function(c,a){var b=GH.storage.get("gh.pageloadmessages",true)||[];b.push({message:c,type:a||"success"});GH.storage.put("gh.pageloadmessages",b,true)};GH.Notification._displayPageLoadMessages=function(){var c=GH.storage.get("gh.pageloadmessages",true);if(c){var a=c[0].type;var b="";_.each(c,function(d){if(b.length>0){b+="<br>"}b+=d.message});switch(a){case"warning":GH.Notification.showWarning(b);break;case"success":default:GH.Notification.showSuccess(b);break}GH.storage.put("gh.pageloadmessages",null,true)}};GH.Notification.showBoardUpdatedMessage=function(){GH.Notification.clearBoardUpdatedMessage();var b=AJS.$.Deferred();var a=AJS.$(GH.tpl.rapid.notification.renderGHtvMessage()).appendTo("#gh");a.data("deferred",b);a.find(".js-refresh-now").click(function(c){c.preventDefault();a.removeData("deferred");GH.Notification.clearBoardUpdatedMessage();b.resolve()});a.find(".js-ignore-refresh").click(function(c){c.preventDefault();GH.Notification.clearBoardUpdatedMessage()});return b.promise()};GH.Notification.clearBoardUpdatedMessage=function(){var a=AJS.$("#ghx-update-message");if(a.length){var b=a.data("deferred");if(b&&b.reject){b.reject()}a.remove()}};GH.Notification.isBoardUpdatedMessageVisible=function(){var a=AJS.$("#ghx-update-message");return a.length>0};AJS.$(document).ready(function(){GH.Notification.showIssueMessage();if(GH.storage){GH.Notification._displayPageLoadMessages()}});;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/rapid/ui/notification/Notification.soy' */
// This file was automatically generated from Notification.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.rapid == 'undefined') { GH.tpl.rapid = {}; }
if (typeof GH.tpl.rapid.notification == 'undefined') { GH.tpl.rapid.notification = {}; }


GH.tpl.rapid.notification.renderErrorMessages = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.errors.length > 1) {
    output.append('<ul>');
    var errorList6 = opt_data.errors;
    var errorListLen6 = errorList6.length;
    for (var errorIndex6 = 0; errorIndex6 < errorListLen6; errorIndex6++) {
      var errorData6 = errorList6[errorIndex6];
      output.append('<li>', (errorData6.noAutoescape) ? errorData6.message : soy.$$escapeHtml(errorData6.message), '</li>');
    }
    output.append('</ul>');
  } else {
    var errorList18 = opt_data.errors;
    var errorListLen18 = errorList18.length;
    for (var errorIndex18 = 0; errorIndex18 < errorListLen18; errorIndex18++) {
      var errorData18 = errorList18[errorIndex18];
      output.append('<p>', (errorData18.noAutoescape) ? errorData18.message : soy.$$escapeHtml(errorData18.message), '</p>');
    }
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderContextualErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var errorList29 = opt_data.errors;
  var errorListLen29 = errorList29.length;
  for (var errorIndex29 = 0; errorIndex29 < errorListLen29; errorIndex29++) {
    var errorData29 = errorList29[errorIndex29];
    output.append('<div class="ghx-error">', soy.$$escapeHtml(errorData29.message), '</div>');
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderMessageHolder = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ghx-body-warning">', soy.$$escapeHtml(AJS.format("This version of {0} is not a supported browser.",opt_data.browser)), ' <a href="', soy.$$escapeHtml(opt_data.docsUrl), '">', soy.$$escapeHtml("See our documentation for the list of supported browsers."), '</a></div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderAuiMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.type), (opt_data.className) ? ' ' + soy.$$escapeHtml(opt_data.className) : '', '">', (opt_data.title) ? '<p class="title">' + ((opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + '<strong>' + soy.$$escapeHtml(opt_data.title) + '</strong></p>' : '', (opt_data.message) ? '<p>' + ((! opt_data.title && opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + ((opt_data.messageHtml) ? opt_data.message : soy.$$escapeHtml(opt_data.message)) + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderGHtvMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="ghx-update-message" class="ghx-tv-message"><p>', soy.$$escapeHtml("This board has been updated"), ': <a href="" class="js-refresh-now">', soy.$$escapeHtml("Refresh"), '</a><span class="ghx-divider">&bull;</span><a href="" class="js-ignore-refresh">', soy.$$escapeHtml("Ignore"), '</a></p></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintMultiselect.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(f,d){function c(e){var h=new AJS.GroupDescriptor({weight:0,label:"Suggestions",items:_.map(e.suggestions,b)});var g=new AJS.GroupDescriptor({weight:1,label:"All sprints",items:_.map(e.allMatches,b)});return[h,g]}function b(g){g.date=moment(g.date,"YYYY-MM-DDTHH:mm:ssZ").format("LL");var e=GH.tpl.customfields.sprintmultiselect.renderSuggestionMeta(g);return new AJS.ItemDescriptor({value:g.id,label:g.name,html:e,title:GH.tpl.customfields.sprintmultiselect.renderTooltip(g),date:g.date,boardName:g.boardName,stateKey:g.stateKey,highlighted:true,allowDuplicate:false})}function a(e){return _.sortBy(e,"id")}AJS.$(".js-sprint-checkboxmultiselect",d).each(function(){var e=new AJS.CheckboxMultiSelect({element:this,maxInlineResultsDisplayed:5,content:"ajax",removeOnUnSelect:true,ajaxOptions:{url:AJS.contextPath()+"/rest/greenhopper/1.0/sprint/picker",error:function(){e._setSuggestions([])},data:{excludeCompleted:false},query:true,formatResponse:c},suggestionsHandler:GH.SprintSuggestHandler})})});;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintMultiselect.soy' */
// This file was automatically generated from SprintMultiselect.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.customfields == 'undefined') { GH.tpl.customfields = {}; }
if (typeof GH.tpl.customfields.sprintmultiselect == 'undefined') { GH.tpl.customfields.sprintmultiselect = {}; }


GH.tpl.customfields.sprintmultiselect.renderSuggestionMeta = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div>', soy.$$escapeHtml(opt_data.name), '</div><div><span class=\'ghx-sprint-multiselect-meta\'> ');
  if (opt_data.boardName) {
    GH.tpl.customfields.sprintmultiselect.renderMetaWithBoardName(opt_data, output);
  } else {
    GH.tpl.customfields.sprintmultiselect.renderMetaWithoutBoardName(opt_data, output);
  }
  output.append('</span></div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintmultiselect.renderMetaWithoutBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml("Active") : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml("Future") : (opt_data.stateKey == 'CLOSED') ? soy.$$escapeHtml("Closed") : '');
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintmultiselect.renderMetaWithBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml(AJS.format("Active \xb7 {0}",opt_data.boardName)) : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml(AJS.format("Future \xb7 {0}",opt_data.boardName)) : (opt_data.stateKey == 'CLOSED') ? soy.$$escapeHtml(AJS.format("Closed \xb7 {0}",opt_data.boardName)) : '');
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintmultiselect.renderTooltip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml(AJS.format("Started on {0}",opt_data.date)) : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml("Future") : (opt_data.stateKey == 'CLOSED') ? soy.$$escapeHtml(AJS.format("Closed on {0}",opt_data.date)) : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintSuggestHandler.js' */
define("includes/js/field/sprint-suggest-handler",["jira/ajs/select/suggestions/checkbox-multi-select-suggest-handler"],function(a){return a.extend({formatSuggestions:function(c,d){var b=this.model.getDisplayableSelectedDescriptors();prepareSelectedDescriptors(b);var e=function(f){var g;for(g in b){if(b[g].properties.value===f.properties.value.toString()){return false}}return true};c=_.map(c,function(g){var f=_.filter(g.properties.items,e);g.properties.items=f;return g});return this._super(c,d)}})});function prepareSelectedDescriptors(a){_.each(a,function(c){var b=JSON.parse(c.properties.meta);b.date=moment(b.date).format("LL");c.properties.title=GH.tpl.customfields.sprintmultiselect.renderTooltip(b);c.properties.html=GH.tpl.customfields.sprintmultiselect.renderSuggestionMeta(b)})}AJS.namespace("GH.SprintSuggestHandler",null,require("includes/js/field/sprint-suggest-handler"));;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/EpicLinkMultiselect.js' */
require(["require"],function(c){var d=c("jquery");var b=c("underscore");function e(f){if(f.indexOf("project")!==0){return""}return a(f).trim()}function a(f){function g(i){var j=i.match(/\bproject\s*=\s*(\S+)/i);return j?j[1]:null}function h(i){var j=i.match(/\bproject\s+in\s+\((.*?)\)/i);return j?j[1]:null}return g(f)||h(f)}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(h,f){var g=d("#jql",this).val();f.find(".js-epiclink-checkboxmultiselect").each(function(){var i=new AJS.CheckboxMultiSelect({element:this,maxInlineResultsDisplayed:5,content:"ajax",removeOnUnSelect:true,ajaxOptions:{url:AJS.contextPath()+"/rest/greenhopper/1.0/epics",error:function(){i._setSuggestions([])},data:{searchQuery:e(g),projectKey:null,maxResults:100},query:true,minQueryLength:0,formatResponse:function(j){return[new AJS.GroupDescriptor({weight:1,items:[new AJS.ItemDescriptor({highlighted:true,label:"No Epic Link",value:"EMPTY",title:"EMPTY"})]}),new AJS.GroupDescriptor({items:b.map(j.epicNames,function(k){return new AJS.ItemDescriptor({highlighted:true,label:k.name+" - ("+k.key+")",value:k.key,title:k.key})}),label:"Suggestions",weight:0})]}},suggestionsHandler:GH.EpicLinkSuggestHandler})})})});;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/EpicLinkSuggestHandler.js' */
define("includes/js/field/epic-link-suggest-handler",["jira/ajs/select/suggestions/checkbox-multi-select-suggest-handler"],function(a){return a.extend({formatSuggestions:function(c,e){var b=this.model.getDisplayableSelectedDescriptors();var d=function(f){var g;for(g in b){if(b[g].properties.value===f.properties.value.toString()){return false}}return true};c=_.map(c,function(g){var f=_.filter(g.properties.items,d);g.properties.items=f;return g});return this._super(c,e)}})});AJS.namespace("GH.EpicLinkSuggestHandler",null,require("includes/js/field/epic-link-suggest-handler"));;
;/* module-key = 'com.pyxis.greenhopper.jira:sprintmigration-banner', location = 'includes/js/sprintmigration/SprintMigrationBanner.js' */
;
;/* module-key = 'com.pyxis.greenhopper.jira:sprintmigration-banner', location = 'includes/js/sprintmigration/SprintMigrationBanner.soy' */
;
;/* module-key = 'com.pyxis.greenhopper.jira:project-template-resources', location = '/projecttemplates/soy/ProjectTemplates.soy' */
// This file was automatically generated from ProjectTemplates.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.projecttemplates == 'undefined') { GH.tpl.projecttemplates = {}; }


GH.tpl.projecttemplates.kanbanInfoPageLegacy = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.kanbanInfoPage({issueTypeListClass: 'gh-legacy'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.kanbanInfoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.infoPage({description: "Use this project to optimise the flow of work in your development project. Add constraints to work-in-progress, analyze how long it takes to complete issues, find bottlenecks in your process, and more. This project includes a Kanban board, a basic Agile workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">' + soy.$$escapeHtml("Story") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', issueTypeListClass: opt_data.issueTypeListClass, workflowScreenshotClass: 'kanban-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.scrumInfoPageLegacy = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.scrumInfoPage({issueTypeListClass: 'gh-legacy'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.scrumInfoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.infoPage({description: "Use this project to manage your Agile development work. Create a backlog, organise work into sprints, check progress using reports, and more. This project includes a Scrum board, a basic Agile workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">' + soy.$$escapeHtml("Story") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', issueTypeListClass: opt_data.issueTypeListClass, workflowScreenshotClass: 'scrum-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.softwareDevelopmentInfoPageLegacy = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.softwareDevelopmentInfoPage({issueTypeListClass: 'gh-legacy'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.softwareDevelopmentInfoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.infoPage({description: "Use this project to work on new features for your product and also track any bugs. This project provides you with a basic workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon improvement"></span><span class="issuetype-name">' + soy.$$escapeHtml("Improvement") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon newfeature"></span><span class="issuetype-name">' + soy.$$escapeHtml("New Feature") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', issueTypeListClass: opt_data.issueTypeListClass, workflowScreenshotClass: 'basic-development-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.infoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><div class="left-info"><p>', soy.$$escapeHtml(opt_data.description), '</p><h3>', soy.$$escapeHtml("Issue Types"), '</h3><ul class="project-template-issuetype-list ', soy.$$escapeHtml(opt_data.issueTypeListClass), '"><li><span class="issuetype-list-label"><span class="issuetype-icon bug"></span><span class="issuetype-name">', soy.$$escapeHtml("Bug"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li>', opt_data.extraIssueTypes, '</ul></div><div class="right-info ', soy.$$escapeHtml(opt_data.workflowScreenshotClass), '"></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.pyxis.greenhopper.jira:project-template-resources', location = '/projecttemplates/soy/ProjectTemplatesJira7.soy' */
// This file was automatically generated from ProjectTemplatesJira7.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.projecttemplates == 'undefined') { GH.tpl.projecttemplates = {}; }


GH.tpl.projecttemplates.kanbanInfoPageJira7 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.templateInfoDialog({description: "Use this project to optimise the flow of work in your development project. Add constraints to work-in-progress, analyze how long it takes to complete issues, find bottlenecks in your process, and more. This project includes a Kanban board, a basic Agile workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">' + soy.$$escapeHtml("Story") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', workflowScreenshotClass: 'kanban-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.scrumInfoPageJira7 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.templateInfoDialog({description: "Use this project to manage your Agile development work. Create a backlog, organise work into sprints, check progress using reports, and more. This project includes a Scrum board, a basic Agile workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">' + soy.$$escapeHtml("Story") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', workflowScreenshotClass: 'scrum-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.softwareDevelopmentInfoPageJira7 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.templateInfoDialog({description: "Use this project to work on new features for your product and also track any bugs. This project provides you with a basic workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon improvement"></span><span class="issuetype-name">' + soy.$$escapeHtml("Improvement") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon newfeature"></span><span class="issuetype-name">' + soy.$$escapeHtml("New Feature") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', workflowScreenshotClass: 'basic-development-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.templateInfoDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><div class="top-panel"><p>', soy.$$escapeHtml(opt_data.description), '</p></div><div class="left-panel"><h6>', soy.$$escapeHtml("Issue Types"), '</h6><ul class="project-template-issuetype-list" ><li><span class="issuetype-list-label"><span class="issuetype-icon bug"></span><span class="issuetype-name">', soy.$$escapeHtml("Bug"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li>', opt_data.extraIssueTypes, '</ul></div><div class="right-panel"><h6>', soy.$$escapeHtml("workflow"), '</h6><div class="workflow ', soy.$$escapeHtml(opt_data.workflowScreenshotClass), '"></div></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-globalkeyboardshortcuts', location = 'includes/js/gh-globalkeyboardshortcuts.js' */
(function(b){b.namespace("gh.app.globalkeyboardshortcuts");var a=gh.app.globalkeyboardshortcuts;a.findSelectedIssueId=function(){var c;if(jira&&jira.app&&jira.app.issuenavigator&&jira.app.issuenavigator.getSelectedIssueId){c=jira.app.issuenavigator.getSelectedIssueId()}if(!c&&jira&&jira.app&&jira.app.issue&&jira.app.issue.getIssueId){c=jira.app.issue.getIssueId()}return c};a.goToAgile=function(){var c=(contextPath?contextPath:"")+"/secure/GreenHopper.jspa";window.location.href=c};a.followLink=function(c){var d=b(c);if(d.length>0&&(d[0].nodeName.toLowerCase()==="a"||d[0].nodeName.toLowerCase()==="link")){d.click();window.location.href=d.attr("href")}};a.sendToTop=function(d,e){if(window.GH&&GH.RapidBoard&&GH.Shortcut&&GH.Shortcut.sendToTop){GH.Shortcut.sendToTop(d);a.closeDialogAndPopMessage();return}if(d!="Action"){return}var c=e||a.findSelectedIssueId();if(!contextPath){contextPath=""}JIRA.SmartAjax.makeRequest({type:"post",contentType:"application/json",url:contextPath+"/rest/greenhopper/1.0/rank/global/first",data:JSON.stringify({issueId:c}),success:a.handleRankSuccess});AJS.$(AJS).trigger("gh.global.rankissues",{action:"rankToTop"+(d?d:""),count:1})};a.sendToBottom=function(d,e){if(window.GH&&GH.RapidBoard&&GH.Shortcut&&GH.Shortcut.sendToBottom){GH.Shortcut.sendToBottom(d);a.closeDialogAndPopMessage();return}if(d!="Action"){return}var c=e||a.findSelectedIssueId();if(!contextPath){contextPath=""}JIRA.SmartAjax.makeRequest({type:"post",contentType:"application/json",url:contextPath+"/rest/greenhopper/1.0/rank/global/last",data:JSON.stringify({issueId:c}),success:a.handleRankSuccess});AJS.$(AJS).trigger("gh.global.rankissues",{action:"rankToBottom"+(d?d:""),count:1})};a.closeDialogAndPopMessage=function(){if(JIRA.IssueNavigator.isNavigator()){AJS.reloadViaWindowLocation()}else{if(JIRA.Dialog&&JIRA.Dialog.current){JIRA.Dialog.current.hide()}if(window.GH){if(GH.Message&&GH.Message.showIssueMessage){GH.Message.showIssueMessage()}else{if(GH.RapidBoard&&GH.Notification&&GH.Notification.showIssueMessage){GH.Notification.showIssueMessage()}}if(window.Boards){Boards.refreshAll()}}else{if(JIRA.IssueNavigator&&JIRA.IssueNavigator.Shortcuts&&JIRA.IssueNavigator.Shortcuts.flashIssueRow){JIRA.IssueNavigator.Shortcuts.flashIssueRow()}}}};a.handleRankSuccess=function(c,e,d){a.storeSuccessMessage(c.issueId,c.issueKey,"thanks_issue_updated");a.closeDialogAndPopMessage()};a.storeSuccessMessage=function(e,c,d){var f=JIRA.SessionStorage;f.setItem("selectedIssueId",e);f.setItem("selectedIssueKey",c);f.setItem("selectedIssueMsg",d)};AJS.$(function(){AJS.$(document).delegate(".issueaction-greenhopper-rank-top-operation","click",function(c){c.preventDefault();var d=AJS.$(this).attr("data-issueid");a.sendToTop("Action",d)});AJS.$(document).delegate(".issueaction-greenhopper-rank-bottom-operation","click",function(c){c.preventDefault();var d=AJS.$(this).attr("data-issueid");a.sendToBottom("Action",d)})})})(AJS.$);;
